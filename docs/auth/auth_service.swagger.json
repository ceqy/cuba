{
  "swagger": "2.0",
  "info": {
    "title": "Cuba Auth Service API",
    "version": "1.0.0",
    "description": "认证服务 - 用户身份验证与授权管理"
  },
  "tags": [
    {
      "name": "AuthService"
    }
  ],
  "consumes": [
    "application/json"
  ],
  "produces": [
    "application/json"
  ],
  "paths": {
    "/api/v1/admin/audit-logs": {
      "get": {
        "summary": "获取用户操作审计日志（管理员用）",
        "operationId": "AuthService_GetAuditLogs",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/authGetAuditLogsResponse"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/rpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "userId",
            "description": "可选过滤",
            "in": "query",
            "required": false,
            "type": "string"
          },
          {
            "name": "tenantId",
            "in": "query",
            "required": false,
            "type": "string"
          },
          {
            "name": "startTime",
            "in": "query",
            "required": false,
            "type": "string",
            "format": "date-time"
          },
          {
            "name": "endTime",
            "in": "query",
            "required": false,
            "type": "string",
            "format": "date-time"
          },
          {
            "name": "pagination.page",
            "in": "query",
            "required": false,
            "type": "integer",
            "format": "int32"
          },
          {
            "name": "pagination.pageSize",
            "in": "query",
            "required": false,
            "type": "integer",
            "format": "int32"
          },
          {
            "name": "pagination.sortBy",
            "description": "如 \"created_at\"",
            "in": "query",
            "required": false,
            "type": "string"
          },
          {
            "name": "pagination.desc",
            "description": "是否降序",
            "in": "query",
            "required": false,
            "type": "boolean"
          }
        ],
        "tags": [
          "AuthService"
        ]
      }
    },
    "/api/v1/admin/users": {
      "get": {
        "summary": "获取用户列表（管理员分页查询）",
        "operationId": "AuthService_ListUsers",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/authListUsersResponse"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/rpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "tenantId",
            "in": "query",
            "required": false,
            "type": "string"
          },
          {
            "name": "roleId",
            "description": "可选过滤角色",
            "in": "query",
            "required": false,
            "type": "string"
          },
          {
            "name": "search",
            "description": "模糊搜索 username/email/display_name",
            "in": "query",
            "required": false,
            "type": "string"
          },
          {
            "name": "pagination.page",
            "in": "query",
            "required": false,
            "type": "integer",
            "format": "int32"
          },
          {
            "name": "pagination.pageSize",
            "in": "query",
            "required": false,
            "type": "integer",
            "format": "int32"
          },
          {
            "name": "pagination.sortBy",
            "description": "如 \"created_at\"",
            "in": "query",
            "required": false,
            "type": "string"
          },
          {
            "name": "pagination.desc",
            "description": "是否降序",
            "in": "query",
            "required": false,
            "type": "boolean"
          }
        ],
        "tags": [
          "AuthService"
        ]
      }
    },
    "/api/v1/admin/users/bulk": {
      "post": {
        "summary": "批量导入用户（企业常见）",
        "operationId": "AuthService_BulkCreateUsers",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/authBulkCreateUsersResponse"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/rpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "$ref": "#/definitions/authBulkCreateUsersRequest"
            }
          }
        ],
        "tags": [
          "AuthService"
        ]
      }
    },
    "/api/v1/admin/users/{userId}/status": {
      "put": {
        "summary": "禁用/启用用户账号",
        "operationId": "AuthService_UpdateUserStatus",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/authUpdateUserStatusResponse"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/rpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "userId",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "$ref": "#/definitions/AuthServiceUpdateUserStatusBody"
            }
          }
        ],
        "tags": [
          "AuthService"
        ]
      }
    },
    "/api/v1/api-keys": {
      "get": {
        "operationId": "AuthService_ListAPIKeys",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/authListAPIKeysResponse"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/rpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "pagination.page",
            "in": "query",
            "required": false,
            "type": "integer",
            "format": "int32"
          },
          {
            "name": "pagination.pageSize",
            "in": "query",
            "required": false,
            "type": "integer",
            "format": "int32"
          },
          {
            "name": "pagination.sortBy",
            "description": "如 \"created_at\"",
            "in": "query",
            "required": false,
            "type": "string"
          },
          {
            "name": "pagination.desc",
            "description": "是否降序",
            "in": "query",
            "required": false,
            "type": "boolean"
          }
        ],
        "tags": [
          "AuthService"
        ]
      },
      "post": {
        "summary": "创建API Key",
        "operationId": "AuthService_CreateAPIKey",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/authCreateAPIKeyResponse"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/rpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "$ref": "#/definitions/authCreateAPIKeyRequest"
            }
          }
        ],
        "tags": [
          "AuthService"
        ]
      }
    },
    "/api/v1/api-keys/{keyId}": {
      "delete": {
        "operationId": "AuthService_RevokeAPIKey",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/authRevokeAPIKeyResponse"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/rpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "keyId",
            "in": "path",
            "required": true,
            "type": "string"
          }
        ],
        "tags": [
          "AuthService"
        ]
      }
    },
    "/api/v1/auth/2fa/enable": {
      "post": {
        "summary": "启用2FA（生成密钥和二维码）",
        "operationId": "AuthService_Enable2FA",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/authEnable2FAResponse"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/rpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "$ref": "#/definitions/authEnable2FARequest"
            }
          }
        ],
        "tags": [
          "AuthService"
        ]
      }
    },
    "/api/v1/auth/2fa/login": {
      "post": {
        "summary": "登录时验证2FA代码",
        "operationId": "AuthService_Verify2FACode",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/authVerify2FACodeResponse"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/rpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "$ref": "#/definitions/authVerify2FACodeRequest"
            }
          }
        ],
        "tags": [
          "AuthService"
        ]
      }
    },
    "/api/v1/auth/2fa/verify": {
      "post": {
        "summary": "验证2FA并完成启用",
        "operationId": "AuthService_Verify2FASetup",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/authVerify2FAResponse"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/rpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "$ref": "#/definitions/authVerify2FARequest"
            }
          }
        ],
        "tags": [
          "AuthService"
        ]
      }
    },
    "/api/v1/auth/change-password": {
      "post": {
        "summary": "修改密码",
        "operationId": "AuthService_ChangePassword",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/authChangePasswordResponse"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/rpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "$ref": "#/definitions/authChangePasswordRequest"
            }
          }
        ],
        "tags": [
          "AuthService"
        ]
      }
    },
    "/api/v1/auth/forgot-password": {
      "post": {
        "summary": "发送重置密码邮件/验证码（忘记密码第一步）",
        "operationId": "AuthService_SendPasswordResetToken",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/authSendPasswordResetTokenResponse"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/rpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "$ref": "#/definitions/authSendPasswordResetTokenRequest"
            }
          }
        ],
        "tags": [
          "AuthService"
        ]
      }
    },
    "/api/v1/auth/login": {
      "post": {
        "summary": "用户登录",
        "operationId": "AuthService_Login",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/authLoginResponse"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/rpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "$ref": "#/definitions/authLoginRequest"
            }
          }
        ],
        "tags": [
          "AuthService"
        ]
      }
    },
    "/api/v1/auth/logout": {
      "post": {
        "summary": "用户登出",
        "operationId": "AuthService_Logout",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/authLogoutResponse"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/rpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "$ref": "#/definitions/authLogoutRequest"
            }
          }
        ],
        "tags": [
          "AuthService"
        ]
      }
    },
    "/api/v1/auth/me": {
      "get": {
        "summary": "获取用户信息",
        "operationId": "AuthService_GetUserInfo",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/authGetUserInfoResponse"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/rpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "userId",
            "description": "用户ID",
            "in": "query",
            "required": false,
            "type": "string"
          }
        ],
        "tags": [
          "AuthService"
        ]
      }
    },
    "/api/v1/auth/refresh": {
      "post": {
        "summary": "刷新令牌",
        "operationId": "AuthService_RefreshToken",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/authRefreshTokenResponse"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/rpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "$ref": "#/definitions/authRefreshTokenRequest"
            }
          }
        ],
        "tags": [
          "AuthService"
        ]
      }
    },
    "/api/v1/auth/register": {
      "post": {
        "summary": "用户注册",
        "operationId": "AuthService_Register",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/authRegisterResponse"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/rpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "$ref": "#/definitions/authRegisterRequest"
            }
          }
        ],
        "tags": [
          "AuthService"
        ]
      }
    },
    "/api/v1/auth/reset-password": {
      "post": {
        "summary": "重置密码（忘记密码流程）",
        "operationId": "AuthService_ResetPassword",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/authResetPasswordResponse"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/rpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "$ref": "#/definitions/authResetPasswordRequest"
            }
          }
        ],
        "tags": [
          "AuthService"
        ]
      }
    },
    "/api/v1/auth/sessions": {
      "get": {
        "summary": "获取当前用户的所有活跃会话",
        "operationId": "AuthService_ListUserSessions",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/authListUserSessionsResponse"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/rpcStatus"
            }
          }
        },
        "tags": [
          "AuthService"
        ]
      }
    },
    "/api/v1/auth/sessions/{sessionId}": {
      "delete": {
        "summary": "撤销指定会话（登出其他设备）",
        "operationId": "AuthService_RevokeSession",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/authRevokeSessionResponse"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/rpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "sessionId",
            "description": "\"all\" 表示全部撤销除当前",
            "in": "path",
            "required": true,
            "type": "string"
          }
        ],
        "tags": [
          "AuthService"
        ]
      }
    },
    "/api/v1/auth/social/login": {
      "post": {
        "summary": "第三方登录（OAuth2/Social Login）",
        "operationId": "AuthService_SocialLogin",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/authLoginResponse"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/rpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "$ref": "#/definitions/authSocialLoginRequest"
            }
          }
        ],
        "tags": [
          "AuthService"
        ]
      }
    },
    "/api/v1/auth/sso/login": {
      "post": {
        "summary": "SSO 登录发起（IdP Initiated）",
        "operationId": "AuthService_SSOLogin",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/authSSOLoginResponse"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/rpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "$ref": "#/definitions/authSSOLoginRequest"
            }
          }
        ],
        "tags": [
          "AuthService"
        ]
      }
    },
    "/api/v1/auth/sso/logout": {
      "post": {
        "summary": "SSO 登出（全局登出）",
        "operationId": "AuthService_GlobalLogout",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/authGlobalLogoutResponse"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/rpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "$ref": "#/definitions/authGlobalLogoutRequest"
            }
          }
        ],
        "tags": [
          "AuthService"
        ]
      }
    },
    "/api/v1/auth/validate": {
      "post": {
        "summary": "验证令牌（供其他服务内部调用）",
        "operationId": "AuthService_ValidateToken",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/authValidateTokenResponse"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/rpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "$ref": "#/definitions/authValidateTokenRequest"
            }
          }
        ],
        "tags": [
          "AuthService"
        ]
      }
    },
    "/api/v1/auth/verify-email": {
      "post": {
        "summary": "邮箱验证",
        "operationId": "AuthService_VerifyEmail",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/authVerifyEmailResponse"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/rpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "$ref": "#/definitions/authVerifyEmailRequest"
            }
          }
        ],
        "tags": [
          "AuthService"
        ]
      }
    },
    "/api/v1/oauth2/authorize": {
      "get": {
        "summary": "OAuth2 授权码模式 - 生成授权码（前端跳转用）",
        "operationId": "AuthService_Authorize",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/authAuthorizeResponse"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/rpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "responseType",
            "description": "\"code\"",
            "in": "query",
            "required": false,
            "type": "string"
          },
          {
            "name": "clientId",
            "in": "query",
            "required": false,
            "type": "string"
          },
          {
            "name": "redirectUri",
            "in": "query",
            "required": false,
            "type": "string"
          },
          {
            "name": "scope",
            "in": "query",
            "required": false,
            "type": "string"
          },
          {
            "name": "state",
            "in": "query",
            "required": false,
            "type": "string"
          },
          {
            "name": "userId",
            "description": "内部已登录用户",
            "in": "query",
            "required": false,
            "type": "string"
          }
        ],
        "tags": [
          "AuthService"
        ]
      }
    },
    "/api/v1/oauth2/clients": {
      "get": {
        "operationId": "AuthService_ListClients",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/authListClientsResponse"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/rpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "pagination.page",
            "in": "query",
            "required": false,
            "type": "integer",
            "format": "int32"
          },
          {
            "name": "pagination.pageSize",
            "in": "query",
            "required": false,
            "type": "integer",
            "format": "int32"
          },
          {
            "name": "pagination.sortBy",
            "description": "如 \"created_at\"",
            "in": "query",
            "required": false,
            "type": "string"
          },
          {
            "name": "pagination.desc",
            "description": "是否降序",
            "in": "query",
            "required": false,
            "type": "boolean"
          }
        ],
        "tags": [
          "AuthService"
        ]
      },
      "post": {
        "summary": "客户端管理（应用注册）",
        "operationId": "AuthService_CreateClient",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/authCreateClientResponse"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/rpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "$ref": "#/definitions/authCreateClientRequest"
            }
          }
        ],
        "tags": [
          "AuthService"
        ]
      }
    },
    "/api/v1/oauth2/token": {
      "post": {
        "summary": "OAuth2 Token Endpoint - 换取 access_token",
        "operationId": "AuthService_Token",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/authTokenResponse"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/rpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "$ref": "#/definitions/authTokenRequest"
            }
          }
        ],
        "tags": [
          "AuthService"
        ]
      }
    },
    "/api/v1/oauth2/userinfo": {
      "get": {
        "summary": "OpenID Connect UserInfo Endpoint",
        "operationId": "AuthService_UserInfo",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/authUserInfoResponse"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/rpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "accessToken",
            "in": "query",
            "required": false,
            "type": "string"
          }
        ],
        "tags": [
          "AuthService"
        ]
      }
    },
    "/api/v1/permissions": {
      "get": {
        "summary": "列出所有权限（管理员用）",
        "operationId": "AuthService_ListPermissions",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/authListPermissionsResponse"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/rpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "pagination.page",
            "in": "query",
            "required": false,
            "type": "integer",
            "format": "int32"
          },
          {
            "name": "pagination.pageSize",
            "in": "query",
            "required": false,
            "type": "integer",
            "format": "int32"
          },
          {
            "name": "pagination.sortBy",
            "description": "如 \"created_at\"",
            "in": "query",
            "required": false,
            "type": "string"
          },
          {
            "name": "pagination.desc",
            "description": "是否降序",
            "in": "query",
            "required": false,
            "type": "boolean"
          }
        ],
        "tags": [
          "AuthService"
        ]
      }
    },
    "/api/v1/policies": {
      "get": {
        "operationId": "AuthService_ListPolicies",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/authListPoliciesResponse"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/rpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "pagination.page",
            "in": "query",
            "required": false,
            "type": "integer",
            "format": "int32"
          },
          {
            "name": "pagination.pageSize",
            "in": "query",
            "required": false,
            "type": "integer",
            "format": "int32"
          },
          {
            "name": "pagination.sortBy",
            "description": "如 \"created_at\"",
            "in": "query",
            "required": false,
            "type": "string"
          },
          {
            "name": "pagination.desc",
            "description": "是否降序",
            "in": "query",
            "required": false,
            "type": "boolean"
          }
        ],
        "tags": [
          "AuthService"
        ]
      },
      "post": {
        "summary": "新增 Policy 相关",
        "operationId": "AuthService_CreatePolicy",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/authCreatePolicyResponse"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/rpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "$ref": "#/definitions/authCreatePolicyRequest"
            }
          }
        ],
        "tags": [
          "AuthService"
        ]
      }
    },
    "/api/v1/policies/{policyId}": {
      "get": {
        "operationId": "AuthService_GetPolicy",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/authGetPolicyResponse"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/rpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "policyId",
            "in": "path",
            "required": true,
            "type": "string"
          }
        ],
        "tags": [
          "AuthService"
        ]
      },
      "delete": {
        "operationId": "AuthService_DeletePolicy",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/authDeletePolicyResponse"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/rpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "policyId",
            "in": "path",
            "required": true,
            "type": "string"
          }
        ],
        "tags": [
          "AuthService"
        ]
      }
    },
    "/api/v1/roles": {
      "get": {
        "summary": "列出角色（管理员用）",
        "operationId": "AuthService_ListRoles",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/authListRolesResponse"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/rpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "pagination.page",
            "in": "query",
            "required": false,
            "type": "integer",
            "format": "int32"
          },
          {
            "name": "pagination.pageSize",
            "in": "query",
            "required": false,
            "type": "integer",
            "format": "int32"
          },
          {
            "name": "pagination.sortBy",
            "description": "如 \"created_at\"",
            "in": "query",
            "required": false,
            "type": "string"
          },
          {
            "name": "pagination.desc",
            "description": "是否降序",
            "in": "query",
            "required": false,
            "type": "boolean"
          }
        ],
        "tags": [
          "AuthService"
        ]
      },
      "post": {
        "summary": "--- RBAC 权限管理 ---\n创建角色",
        "operationId": "AuthService_CreateRole",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/authCreateRoleResponse"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/rpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "$ref": "#/definitions/authCreateRoleRequest"
            }
          }
        ],
        "tags": [
          "AuthService"
        ]
      }
    },
    "/api/v1/roles/{roleId}": {
      "delete": {
        "summary": "删除角色",
        "operationId": "AuthService_DeleteRole",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/authDeleteRoleResponse"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/rpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "roleId",
            "in": "path",
            "required": true,
            "type": "string"
          }
        ],
        "tags": [
          "AuthService"
        ]
      }
    },
    "/api/v1/roles/{roleId}/permissions": {
      "post": {
        "summary": "添加权限到角色",
        "operationId": "AuthService_AddPermissionToRole",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/authAddPermissionToRoleResponse"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/rpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "roleId",
            "description": "角色ID",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "$ref": "#/definitions/AuthServiceAddPermissionToRoleBody"
            }
          }
        ],
        "tags": [
          "AuthService"
        ]
      }
    },
    "/api/v1/roles/{roleId}/permissions/{permissionId}": {
      "delete": {
        "summary": "移除角色权限",
        "operationId": "AuthService_RemovePermissionFromRole",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/authRemovePermissionFromRoleResponse"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/rpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "roleId",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "permissionId",
            "in": "path",
            "required": true,
            "type": "string"
          }
        ],
        "tags": [
          "AuthService"
        ]
      }
    },
    "/api/v1/roles/{roleId}/policies": {
      "post": {
        "operationId": "AuthService_AttachPolicyToRole",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/authAttachPolicyToRoleResponse"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/rpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "roleId",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "$ref": "#/definitions/AuthServiceAttachPolicyToRoleBody"
            }
          }
        ],
        "tags": [
          "AuthService"
        ]
      }
    },
    "/api/v1/users/profile": {
      "put": {
        "summary": "更新用户信息（昵称、头像等）",
        "operationId": "AuthService_UpdateUserProfile",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/authUpdateUserProfileResponse"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/rpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "$ref": "#/definitions/authUpdateUserProfileRequest"
            }
          }
        ],
        "tags": [
          "AuthService"
        ]
      }
    },
    "/api/v1/users/{userId}/permissions": {
      "get": {
        "summary": "获取用户权限列表",
        "operationId": "AuthService_GetUserPermissions",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/authGetUserPermissionsResponse"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/rpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "userId",
            "description": "用户ID",
            "in": "path",
            "required": true,
            "type": "string"
          }
        ],
        "tags": [
          "AuthService"
        ]
      }
    },
    "/api/v1/users/{userId}/policies": {
      "post": {
        "operationId": "AuthService_AttachPolicyToUser",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/authAttachPolicyToUserResponse"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/rpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "userId",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "$ref": "#/definitions/AuthServiceAttachPolicyToUserBody"
            }
          }
        ],
        "tags": [
          "AuthService"
        ]
      }
    },
    "/api/v1/users/{userId}/roles": {
      "post": {
        "summary": "分配角色给用户",
        "operationId": "AuthService_AssignRoleToUser",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/authAssignRoleToUserResponse"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/rpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "userId",
            "description": "用户ID",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "$ref": "#/definitions/AuthServiceAssignRoleToUserBody"
            }
          }
        ],
        "tags": [
          "AuthService"
        ]
      }
    },
    "/api/v1/users/{userId}/roles/{roleId}": {
      "delete": {
        "summary": "移除用户角色",
        "operationId": "AuthService_RemoveRoleFromUser",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/authRemoveRoleFromUserResponse"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/rpcStatus"
            }
          }
        },
        "parameters": [
          {
            "name": "userId",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "roleId",
            "in": "path",
            "required": true,
            "type": "string"
          }
        ],
        "tags": [
          "AuthService"
        ]
      }
    },
    "/health": {
      "get": {
        "summary": "服务健康检查",
        "operationId": "AuthService_HealthCheck",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/authHealthCheckResponse"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/rpcStatus"
            }
          }
        },
        "tags": [
          "AuthService"
        ]
      }
    },
    "/metrics": {
      "get": {
        "summary": "获取服务统计指标（用于 Prometheus）",
        "operationId": "AuthService_GetMetrics",
        "responses": {
          "200": {
            "description": "A successful response.",
            "schema": {
              "$ref": "#/definitions/authGetMetricsResponse"
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "schema": {
              "$ref": "#/definitions/rpcStatus"
            }
          }
        },
        "tags": [
          "AuthService"
        ]
      }
    }
  },
  "definitions": {
    "AuthServiceAddPermissionToRoleBody": {
      "type": "object",
      "properties": {
        "permissionId": {
          "type": "string",
          "title": "权限ID"
        }
      },
      "title": "添加权限到角色请求"
    },
    "AuthServiceAssignRoleToUserBody": {
      "type": "object",
      "properties": {
        "roleId": {
          "type": "string",
          "title": "角色ID"
        }
      },
      "title": "分配角色给用户请求"
    },
    "AuthServiceAttachPolicyToRoleBody": {
      "type": "object",
      "properties": {
        "policyId": {
          "type": "string"
        }
      }
    },
    "AuthServiceAttachPolicyToUserBody": {
      "type": "object",
      "properties": {
        "policyId": {
          "type": "string"
        }
      }
    },
    "AuthServiceUpdateUserStatusBody": {
      "type": "object",
      "properties": {
        "isActive": {
          "type": "boolean"
        }
      },
      "title": "禁用/启用用户"
    },
    "authAPIKey": {
      "type": "object",
      "properties": {
        "keyId": {
          "type": "string"
        },
        "name": {
          "type": "string"
        },
        "prefix": {
          "type": "string",
          "title": "如 \"ak_1a2b3c\""
        },
        "hashedKey": {
          "type": "string",
          "title": "服务端存储"
        },
        "scopes": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "title": "权限范围"
        },
        "expiresAt": {
          "type": "string",
          "format": "date-time"
        },
        "createdAt": {
          "type": "string",
          "format": "date-time"
        },
        "createdByUserId": {
          "type": "string"
        }
      },
      "title": "API Key"
    },
    "authAddPermissionToRoleResponse": {
      "type": "object",
      "properties": {
        "success": {
          "type": "boolean",
          "title": "是否成功"
        }
      },
      "title": "添加权限到角色响应"
    },
    "authAssignRoleToUserResponse": {
      "type": "object",
      "properties": {
        "success": {
          "type": "boolean",
          "title": "是否成功"
        }
      },
      "title": "分配角色给用户响应"
    },
    "authAttachPolicyToRoleResponse": {
      "type": "object",
      "properties": {
        "success": {
          "type": "boolean"
        }
      }
    },
    "authAttachPolicyToUserResponse": {
      "type": "object",
      "properties": {
        "success": {
          "type": "boolean"
        }
      }
    },
    "authAuditLog": {
      "type": "object",
      "properties": {
        "logId": {
          "type": "string"
        },
        "userId": {
          "type": "string"
        },
        "tenantId": {
          "type": "string"
        },
        "action": {
          "type": "string",
          "title": "如 \"login\", \"change_password\", \"assign_role\""
        },
        "resource": {
          "type": "string",
          "title": "操作资源"
        },
        "ipAddress": {
          "type": "string"
        },
        "userAgent": {
          "type": "string"
        },
        "timestamp": {
          "type": "string",
          "format": "date-time"
        },
        "details": {
          "type": "object",
          "additionalProperties": {
            "type": "string"
          },
          "title": "额外信息"
        }
      },
      "title": "审计日志条目"
    },
    "authAuthorizeResponse": {
      "type": "object",
      "properties": {
        "code": {
          "type": "string",
          "title": "授权码"
        },
        "state": {
          "type": "string"
        }
      }
    },
    "authBulkCreateUsersRequest": {
      "type": "object",
      "properties": {
        "users": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/authRegisterRequest"
          }
        },
        "tenantId": {
          "type": "string"
        }
      },
      "title": "批量创建用户"
    },
    "authBulkCreateUsersResponse": {
      "type": "object",
      "properties": {
        "createdUsers": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/authUserInfo"
          }
        },
        "errors": {
          "type": "array",
          "items": {
            "type": "string"
          }
        }
      }
    },
    "authChangePasswordRequest": {
      "type": "object",
      "properties": {
        "oldPassword": {
          "type": "string"
        },
        "newPassword": {
          "type": "string"
        }
      },
      "title": "修改密码"
    },
    "authChangePasswordResponse": {
      "type": "object",
      "properties": {
        "success": {
          "type": "boolean"
        },
        "message": {
          "type": "string"
        }
      }
    },
    "authClient": {
      "type": "object",
      "properties": {
        "clientId": {
          "type": "string"
        },
        "clientSecret": {
          "type": "string",
          "title": "只在创建时返回"
        },
        "name": {
          "type": "string"
        },
        "redirectUris": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "title": "回调地址"
        },
        "grantTypes": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "title": "authorization_code, refresh_token, client_credentials 等"
        },
        "scopes": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "title": "openid profile email 等"
        },
        "createdAt": {
          "type": "string",
          "format": "date-time"
        }
      },
      "title": "客户端（OAuth2）"
    },
    "authCreateAPIKeyRequest": {
      "type": "object",
      "properties": {
        "name": {
          "type": "string"
        },
        "scopes": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "expiresAt": {
          "type": "string",
          "format": "date-time",
          "title": "可选"
        }
      }
    },
    "authCreateAPIKeyResponse": {
      "type": "object",
      "properties": {
        "apiKey": {
          "type": "string",
          "title": "明文，只返回一次！"
        },
        "info": {
          "$ref": "#/definitions/authAPIKey"
        }
      }
    },
    "authCreateClientRequest": {
      "type": "object",
      "properties": {
        "name": {
          "type": "string"
        },
        "redirectUris": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "grantTypes": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "scopes": {
          "type": "array",
          "items": {
            "type": "string"
          }
        }
      }
    },
    "authCreateClientResponse": {
      "type": "object",
      "properties": {
        "client": {
          "$ref": "#/definitions/authClient"
        }
      }
    },
    "authCreatePolicyRequest": {
      "type": "object",
      "properties": {
        "name": {
          "type": "string"
        },
        "version": {
          "type": "string"
        },
        "statements": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/authStatement"
          }
        }
      }
    },
    "authCreatePolicyResponse": {
      "type": "object",
      "properties": {
        "policy": {
          "$ref": "#/definitions/authPolicy"
        }
      }
    },
    "authCreateRoleRequest": {
      "type": "object",
      "properties": {
        "name": {
          "type": "string",
          "title": "角色名称"
        },
        "description": {
          "type": "string",
          "title": "角色描述"
        }
      },
      "title": "创建角色请求"
    },
    "authCreateRoleResponse": {
      "type": "object",
      "properties": {
        "role": {
          "$ref": "#/definitions/authRole",
          "title": "创建的角色"
        }
      },
      "title": "创建角色响应"
    },
    "authDeletePolicyResponse": {
      "type": "object",
      "properties": {
        "success": {
          "type": "boolean"
        }
      }
    },
    "authDeleteRoleResponse": {
      "type": "object",
      "properties": {
        "success": {
          "type": "boolean"
        }
      }
    },
    "authEnable2FARequest": {
      "type": "object",
      "title": "启用2FA"
    },
    "authEnable2FAResponse": {
      "type": "object",
      "properties": {
        "secretKey": {
          "type": "string",
          "title": "TOTP 密钥"
        },
        "qrCodeUrl": {
          "type": "string",
          "title": "二维码图片URL（供前端显示）"
        }
      }
    },
    "authGetAuditLogsResponse": {
      "type": "object",
      "properties": {
        "logs": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/authAuditLog"
          }
        },
        "pagination": {
          "$ref": "#/definitions/authPageResponse"
        }
      }
    },
    "authGetMetricsResponse": {
      "type": "object",
      "properties": {
        "metrics": {
          "$ref": "#/definitions/authMetrics"
        }
      }
    },
    "authGetPolicyResponse": {
      "type": "object",
      "properties": {
        "policy": {
          "$ref": "#/definitions/authPolicy"
        }
      }
    },
    "authGetUserInfoResponse": {
      "type": "object",
      "properties": {
        "user": {
          "$ref": "#/definitions/authUserInfo",
          "title": "用户信息"
        }
      },
      "title": "获取用户信息响应"
    },
    "authGetUserPermissionsResponse": {
      "type": "object",
      "properties": {
        "permissions": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/authPermission"
          },
          "title": "权限列表"
        }
      },
      "title": "获取用户权限列表响应"
    },
    "authGlobalLogoutRequest": {
      "type": "object",
      "properties": {
        "accessToken": {
          "type": "string"
        }
      }
    },
    "authGlobalLogoutResponse": {
      "type": "object",
      "properties": {
        "success": {
          "type": "boolean"
        }
      }
    },
    "authHealthCheckResponse": {
      "type": "object",
      "properties": {
        "status": {
          "type": "string",
          "title": "\"SERVING\" \"NOT_SERVING\""
        }
      }
    },
    "authListAPIKeysResponse": {
      "type": "object",
      "properties": {
        "keys": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/authAPIKey"
          }
        },
        "pagination": {
          "$ref": "#/definitions/authPageResponse"
        }
      }
    },
    "authListClientsResponse": {
      "type": "object",
      "properties": {
        "clients": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/authClient"
          }
        },
        "pagination": {
          "$ref": "#/definitions/authPageResponse"
        }
      }
    },
    "authListPermissionsResponse": {
      "type": "object",
      "properties": {
        "permissions": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/authPermission"
          }
        },
        "pagination": {
          "$ref": "#/definitions/authPageResponse"
        }
      }
    },
    "authListPoliciesResponse": {
      "type": "object",
      "properties": {
        "policies": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/authPolicy"
          }
        },
        "pagination": {
          "$ref": "#/definitions/authPageResponse"
        }
      }
    },
    "authListRolesResponse": {
      "type": "object",
      "properties": {
        "roles": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/authRole"
          }
        },
        "pagination": {
          "$ref": "#/definitions/authPageResponse"
        }
      }
    },
    "authListUserSessionsResponse": {
      "type": "object",
      "properties": {
        "sessions": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/authUserSession"
          }
        }
      }
    },
    "authListUsersResponse": {
      "type": "object",
      "properties": {
        "users": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/authUserInfo"
          }
        },
        "pagination": {
          "$ref": "#/definitions/authPageResponse"
        }
      }
    },
    "authLoginRequest": {
      "type": "object",
      "properties": {
        "tenantId": {
          "type": "string",
          "title": "可选，支持多租户登录"
        },
        "username": {
          "type": "string",
          "title": "用户名"
        },
        "password": {
          "type": "string",
          "title": "密码"
        }
      },
      "title": "登录请求"
    },
    "authLoginResponse": {
      "type": "object",
      "properties": {
        "accessToken": {
          "type": "string",
          "title": "访问令牌"
        },
        "refreshToken": {
          "type": "string",
          "title": "刷新令牌"
        },
        "expiresIn": {
          "type": "string",
          "format": "int64",
          "title": "过期时间（秒）"
        },
        "user": {
          "$ref": "#/definitions/authUserInfo",
          "title": "用户信息"
        },
        "requires2fa": {
          "type": "boolean",
          "title": "是否需要二次验证"
        },
        "accountLocked": {
          "type": "boolean",
          "title": "账号是否被锁定"
        },
        "lockUntil": {
          "type": "string",
          "format": "date-time",
          "title": "锁定到期时间"
        },
        "tempToken": {
          "type": "string",
          "title": "2FA 临时 token"
        }
      },
      "title": "登录响应"
    },
    "authLogoutRequest": {
      "type": "object",
      "properties": {
        "accessToken": {
          "type": "string",
          "title": "访问令牌（用于撤销）"
        },
        "refreshToken": {
          "type": "string",
          "title": "刷新令牌（用于撤销）"
        }
      },
      "title": "登出请求"
    },
    "authLogoutResponse": {
      "type": "object",
      "properties": {
        "success": {
          "type": "boolean",
          "title": "是否成功"
        }
      },
      "title": "登出响应"
    },
    "authMetrics": {
      "type": "object",
      "properties": {
        "totalUsers": {
          "type": "string",
          "format": "int64"
        },
        "activeSessions": {
          "type": "string",
          "format": "int64"
        },
        "loginAttemptsLastHour": {
          "type": "string",
          "format": "int64"
        },
        "failedLoginsLastHour": {
          "type": "string",
          "format": "int64"
        }
      },
      "title": "指标"
    },
    "authPageRequest": {
      "type": "object",
      "properties": {
        "page": {
          "type": "integer",
          "format": "int32"
        },
        "pageSize": {
          "type": "integer",
          "format": "int32"
        },
        "sortBy": {
          "type": "string",
          "title": "如 \"created_at\""
        },
        "desc": {
          "type": "boolean",
          "title": "是否降序"
        }
      },
      "title": "列表查询通用分页"
    },
    "authPageResponse": {
      "type": "object",
      "properties": {
        "total": {
          "type": "string",
          "format": "int64"
        },
        "page": {
          "type": "integer",
          "format": "int32"
        },
        "pageSize": {
          "type": "integer",
          "format": "int32"
        }
      }
    },
    "authPermission": {
      "type": "object",
      "properties": {
        "permissionId": {
          "type": "string",
          "title": "权限ID"
        },
        "resource": {
          "type": "string",
          "title": "资源名称（如：sales_order）"
        },
        "actions": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "title": "操作类型（如：create, read, update, delete）"
        },
        "scope": {
          "type": "string",
          "title": "如 \"own\"（仅自己数据）或 \"all\""
        },
        "attributes": {
          "type": "object",
          "additionalProperties": {
            "type": "string"
          },
          "title": "条件权限，如 {\"department_id\": \"{user.department_id}\"}"
        },
        "description": {
          "type": "string",
          "title": "权限描述"
        }
      },
      "title": "权限"
    },
    "authPolicy": {
      "type": "object",
      "properties": {
        "policyId": {
          "type": "string"
        },
        "name": {
          "type": "string"
        },
        "version": {
          "type": "string",
          "title": "\"v1\""
        },
        "statements": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/authStatement"
          }
        },
        "createdAt": {
          "type": "string",
          "format": "date-time"
        }
      },
      "title": "权限策略"
    },
    "authRefreshTokenRequest": {
      "type": "object",
      "properties": {
        "refreshToken": {
          "type": "string",
          "title": "刷新令牌"
        }
      },
      "title": "刷新令牌请求"
    },
    "authRefreshTokenResponse": {
      "type": "object",
      "properties": {
        "accessToken": {
          "type": "string",
          "title": "新访问令牌"
        },
        "refreshToken": {
          "type": "string",
          "title": "新刷新令牌"
        },
        "expiresIn": {
          "type": "string",
          "format": "int64",
          "title": "过期时间（秒）"
        }
      },
      "title": "刷新令牌响应"
    },
    "authRegisterRequest": {
      "type": "object",
      "properties": {
        "tenantId": {
          "type": "string",
          "title": "指定租户（管理员创建用户时用）"
        },
        "username": {
          "type": "string",
          "title": "用户名"
        },
        "email": {
          "type": "string",
          "title": "邮箱"
        },
        "password": {
          "type": "string",
          "title": "密码"
        }
      },
      "title": "用户注册请求"
    },
    "authRegisterResponse": {
      "type": "object",
      "properties": {
        "user": {
          "$ref": "#/definitions/authUserInfo",
          "title": "用户信息"
        }
      },
      "title": "用户注册响应"
    },
    "authRemovePermissionFromRoleResponse": {
      "type": "object",
      "properties": {
        "success": {
          "type": "boolean"
        }
      }
    },
    "authRemoveRoleFromUserResponse": {
      "type": "object",
      "properties": {
        "success": {
          "type": "boolean"
        }
      }
    },
    "authResetPasswordRequest": {
      "type": "object",
      "properties": {
        "token": {
          "type": "string",
          "title": "重置令牌"
        },
        "newPassword": {
          "type": "string"
        }
      },
      "title": "重置密码"
    },
    "authResetPasswordResponse": {
      "type": "object",
      "properties": {
        "success": {
          "type": "boolean"
        },
        "message": {
          "type": "string"
        }
      }
    },
    "authRevokeAPIKeyResponse": {
      "type": "object",
      "properties": {
        "success": {
          "type": "boolean"
        }
      }
    },
    "authRevokeSessionResponse": {
      "type": "object",
      "properties": {
        "success": {
          "type": "boolean"
        }
      }
    },
    "authRole": {
      "type": "object",
      "properties": {
        "roleId": {
          "type": "string",
          "title": "角色ID"
        },
        "name": {
          "type": "string",
          "title": "角色名称"
        },
        "description": {
          "type": "string",
          "title": "角色描述"
        },
        "createdAt": {
          "type": "string",
          "format": "date-time",
          "title": "创建时间"
        }
      },
      "title": "角色"
    },
    "authSSOLoginRequest": {
      "type": "object",
      "properties": {
        "provider": {
          "type": "string",
          "title": "SSO 特定参数，如 SAML Assertion 等"
        },
        "assertion": {
          "type": "string"
        }
      }
    },
    "authSSOLoginResponse": {
      "type": "object",
      "properties": {
        "accessToken": {
          "type": "string"
        },
        "refreshToken": {
          "type": "string"
        },
        "expiresIn": {
          "type": "string",
          "format": "int64"
        },
        "user": {
          "$ref": "#/definitions/authUserInfo"
        }
      }
    },
    "authSendPasswordResetTokenRequest": {
      "type": "object",
      "properties": {
        "email": {
          "type": "string",
          "title": "或 username/phone"
        }
      },
      "title": "发送重置密码令牌（邮箱或手机号）"
    },
    "authSendPasswordResetTokenResponse": {
      "type": "object",
      "properties": {
        "success": {
          "type": "boolean"
        },
        "message": {
          "type": "string"
        }
      }
    },
    "authSocialLoginRequest": {
      "type": "object",
      "properties": {
        "provider": {
          "type": "string",
          "title": "\"google\", \"github\", \"wechat\" 等"
        },
        "code": {
          "type": "string",
          "title": "授权码"
        },
        "redirectUri": {
          "type": "string"
        }
      }
    },
    "authStatement": {
      "type": "object",
      "properties": {
        "effect": {
          "type": "string",
          "title": "\"Allow\" or \"Deny\""
        },
        "actions": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "title": "\"sales_order:create\""
        },
        "resources": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "title": "\"arn:tenant:123:order:*\""
        },
        "conditions": {
          "type": "object",
          "additionalProperties": {
            "type": "string"
          },
          "title": "复杂条件"
        }
      }
    },
    "authTokenRequest": {
      "type": "object",
      "properties": {
        "grantType": {
          "type": "string",
          "title": "authorization_code, refresh_token, client_credentials"
        },
        "code": {
          "type": "string"
        },
        "redirectUri": {
          "type": "string"
        },
        "clientId": {
          "type": "string"
        },
        "clientSecret": {
          "type": "string"
        },
        "refreshToken": {
          "type": "string"
        }
      }
    },
    "authTokenResponse": {
      "type": "object",
      "properties": {
        "accessToken": {
          "type": "string"
        },
        "tokenType": {
          "type": "string",
          "title": "\"Bearer\""
        },
        "refreshToken": {
          "type": "string"
        },
        "expiresIn": {
          "type": "string",
          "format": "int64"
        },
        "scope": {
          "type": "string"
        },
        "idToken": {
          "type": "string",
          "title": "OpenID Connect ID Token (JWT)"
        }
      }
    },
    "authUpdateUserProfileRequest": {
      "type": "object",
      "properties": {
        "userId": {
          "type": "string"
        },
        "displayName": {
          "type": "string"
        },
        "avatarUrl": {
          "type": "string",
          "title": "新增字段建议"
        }
      },
      "title": "更新用户资料"
    },
    "authUpdateUserProfileResponse": {
      "type": "object",
      "properties": {
        "user": {
          "$ref": "#/definitions/authUserInfo"
        }
      }
    },
    "authUpdateUserStatusResponse": {
      "type": "object",
      "properties": {
        "success": {
          "type": "boolean"
        }
      }
    },
    "authUserInfo": {
      "type": "object",
      "properties": {
        "tenantId": {
          "type": "string",
          "title": "用户所属租户"
        },
        "userId": {
          "type": "string",
          "title": "用户ID"
        },
        "username": {
          "type": "string",
          "title": "用户名"
        },
        "email": {
          "type": "string",
          "title": "邮箱"
        },
        "displayName": {
          "type": "string",
          "title": "显示名称"
        },
        "avatarUrl": {
          "type": "string",
          "title": "头像"
        },
        "emailVerified": {
          "type": "boolean",
          "title": "邮箱是否验证"
        },
        "isActive": {
          "type": "boolean",
          "title": "账号是否启用"
        },
        "roles": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "title": "角色列表"
        },
        "createdAt": {
          "type": "string",
          "format": "date-time",
          "title": "创建时间"
        },
        "updatedAt": {
          "type": "string",
          "format": "date-time",
          "title": "更新时间"
        },
        "lastLoginAt": {
          "type": "string",
          "format": "date-time",
          "title": "最后登录时间"
        }
      },
      "title": "用户信息"
    },
    "authUserInfoResponse": {
      "type": "object",
      "properties": {
        "sub": {
          "type": "string",
          "title": "user_id"
        },
        "name": {
          "type": "string"
        },
        "email": {
          "type": "string"
        },
        "emailVerified": {
          "type": "boolean"
        },
        "picture": {
          "type": "string",
          "title": "可扩展其他 claims"
        }
      }
    },
    "authUserSession": {
      "type": "object",
      "properties": {
        "sessionId": {
          "type": "string"
        },
        "deviceName": {
          "type": "string",
          "title": "如 \"Chrome on Windows\""
        },
        "ipAddress": {
          "type": "string"
        },
        "location": {
          "type": "string",
          "title": "approximate location"
        },
        "lastActive": {
          "type": "string",
          "format": "date-time"
        },
        "createdAt": {
          "type": "string",
          "format": "date-time"
        },
        "isCurrent": {
          "type": "boolean",
          "title": "是否是当前会话"
        }
      },
      "title": "当前会话信息"
    },
    "authValidateTokenRequest": {
      "type": "object",
      "properties": {
        "accessToken": {
          "type": "string",
          "title": "访问令牌"
        }
      },
      "title": "验证令牌请求"
    },
    "authValidateTokenResponse": {
      "type": "object",
      "properties": {
        "valid": {
          "type": "boolean",
          "title": "是否有效"
        },
        "userId": {
          "type": "string",
          "title": "用户ID"
        },
        "tenantId": {
          "type": "string",
          "title": "租户ID"
        },
        "roles": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "title": "用户角色列表"
        },
        "permissions": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "title": "用户权限列表"
        }
      },
      "title": "验证令牌响应"
    },
    "authVerify2FACodeRequest": {
      "type": "object",
      "properties": {
        "tempToken": {
          "type": "string",
          "title": "Login 返回的临时 token"
        },
        "code": {
          "type": "string"
        }
      },
      "title": "验证2FA代码"
    },
    "authVerify2FACodeResponse": {
      "type": "object",
      "properties": {
        "accessToken": {
          "type": "string"
        },
        "refreshToken": {
          "type": "string"
        },
        "expiresIn": {
          "type": "string",
          "format": "int64"
        }
      }
    },
    "authVerify2FARequest": {
      "type": "object",
      "properties": {
        "code": {
          "type": "string",
          "title": "用户输入的6位代码"
        }
      },
      "title": "验证2FA设置"
    },
    "authVerify2FAResponse": {
      "type": "object",
      "properties": {
        "success": {
          "type": "boolean"
        }
      }
    },
    "authVerifyEmailRequest": {
      "type": "object",
      "properties": {
        "token": {
          "type": "string"
        }
      },
      "title": "邮箱验证"
    },
    "authVerifyEmailResponse": {
      "type": "object",
      "properties": {
        "success": {
          "type": "boolean"
        },
        "message": {
          "type": "string"
        }
      }
    },
    "protobufAny": {
      "type": "object",
      "properties": {
        "@type": {
          "type": "string"
        }
      },
      "additionalProperties": {}
    },
    "rpcStatus": {
      "type": "object",
      "properties": {
        "code": {
          "type": "integer",
          "format": "int32"
        },
        "message": {
          "type": "string"
        },
        "details": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/protobufAny"
          }
        }
      }
    }
  },
  "securityDefinitions": {
    "bearer_auth": {
      "type": "apiKey",
      "name": "Authorization",
      "in": "header",
      "description": "Bearer Token 认证 (格式: Bearer <token>)"
    }
  },
  "security": [
    {
      "bearer_auth": []
    }
  ],
  "host": "localhost:8080",
  "basePath": "/",
  "schemes": [
    "http"
  ]
}