{
  "openapi": "3.1.0",
  "info": {
    "title": "Pricing Engine Service API",
    "version": "version not set",
    "description": "定价引擎服务 - 价格计算、折扣规则、条件逻辑",
    "contact": {
      "name": "Pricing Team",
      "email": "pricing@enterprise.com"
    }
  },
  "tags": [
    {
      "name": "PricingEngineService",
      "description": "PricingEngineService"
    }
  ],
  "paths": {
    "/api/v1/sales/price/calculate": {
      "post": {
        "summary": "模拟并计算一组项目的定价",
        "operationId": "PricingEngineService_CalculatePrice",
        "responses": {
          "200": {
            "description": "A successful response.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/pricingCalculatePriceResponse"
                }
              }
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/rpcStatus"
                }
              }
            }
          }
        },
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/pricingCalculatePriceRequest"
              }
            }
          },
          "required": true
        },
        "tags": [
          "PricingEngineService"
        ]
      }
    },
    "/api/v1/sales/pricing-condition": {
      "put": {
        "summary": "更新定价条件记录 (New)",
        "operationId": "PricingEngineService_UpdatePricingCondition",
        "responses": {
          "200": {
            "description": "A successful response.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/pricingUpdatePricingConditionResponse"
                }
              }
            }
          },
          "default": {
            "description": "An unexpected error response.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/rpcStatus"
                }
              }
            }
          }
        },
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/pricingUpdatePricingConditionRequest"
              }
            }
          },
          "required": true
        },
        "tags": [
          "PricingEngineService"
        ]
      }
    }
  },
  "components": {
    "schemas": {
      "commonApiMessage": {
        "type": "object",
        "properties": {
          "type": {
            "type": "string"
          },
          "code": {
            "type": "string"
          },
          "message": {
            "type": "string"
          },
          "target": {
            "type": "string"
          }
        }
      },
      "commonDateRange": {
        "type": "object",
        "properties": {
          "start_date": {
            "type": "string",
            "format": "date-time"
          },
          "end_date": {
            "type": "string",
            "format": "date-time"
          }
        }
      },
      "commonMonetaryValue": {
        "type": "object",
        "properties": {
          "currency_code": {
            "type": "string"
          },
          "value": {
            "type": "string"
          }
        }
      },
      "commonPricingConditionType": {
        "type": "string",
        "enum": [
          "PRICING_CONDITION_TYPE_UNSPECIFIED",
          "PRICING_CONDITION_TYPE_PRICE",
          "PRICING_CONDITION_TYPE_DISCOUNT_PERCENT",
          "PRICING_CONDITION_TYPE_DISCOUNT_FIXED",
          "PRICING_CONDITION_TYPE_SURCHARGE",
          "PRICING_CONDITION_TYPE_FREIGHT",
          "PRICING_CONDITION_TYPE_TAX",
          "PRICING_CONDITION_TYPE_COST"
        ],
        "default": "PRICING_CONDITION_TYPE_UNSPECIFIED",
        "description": "- PRICING_CONDITION_TYPE_PRICE: PR00\n - PRICING_CONDITION_TYPE_DISCOUNT_PERCENT: K007\n - PRICING_CONDITION_TYPE_DISCOUNT_FIXED: K005\n - PRICING_CONDITION_TYPE_SURCHARGE: KF00\n - PRICING_CONDITION_TYPE_FREIGHT: KF00\n - PRICING_CONDITION_TYPE_TAX: MWST\n - PRICING_CONDITION_TYPE_COST: VPRS",
        "title": "定价条件类型"
      },
      "commonRequestContext": {
        "type": "object",
        "properties": {
          "request_id": {
            "type": "string"
          },
          "tenant_id": {
            "type": "string"
          },
          "user_id": {
            "type": "string"
          },
          "roles": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "idempotency_key": {
            "type": "string"
          },
          "locale": {
            "type": "string"
          },
          "timestamp": {
            "type": "string",
            "format": "date-time"
          },
          "source_system": {
            "type": "string"
          },
          "correlation_id": {
            "type": "string"
          }
        }
      },
      "pricingCalculatePriceRequest": {
        "type": "object",
        "properties": {
          "context": {
            "$ref": "#/components/schemas/pricingPricingContext"
          },
          "items": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/pricingPricingItem"
            }
          },
          "request_context": {
            "$ref": "#/components/schemas/commonRequestContext"
          }
        },
        "title": "计算价格请求"
      },
      "pricingCalculatePriceResponse": {
        "type": "object",
        "properties": {
          "results": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/pricingPricingResult"
            }
          },
          "messages": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/commonApiMessage"
            }
          }
        },
        "title": "计算价格响应"
      },
      "pricingPricingCondition": {
        "type": "object",
        "properties": {
          "condition_type": {
            "$ref": "#/components/schemas/commonPricingConditionType"
          },
          "condition_value": {
            "type": "string"
          },
          "currency_or_unit": {
            "type": "string"
          },
          "description": {
            "type": "string"
          }
        },
        "title": "定价条件"
      },
      "pricingPricingContext": {
        "type": "object",
        "properties": {
          "sales_org": {
            "type": "string"
          },
          "distribution_channel": {
            "type": "string"
          },
          "division": {
            "type": "string"
          },
          "customer": {
            "type": "string"
          },
          "pricing_date": {
            "type": "string",
            "format": "date-time"
          },
          "currency": {
            "type": "string"
          }
        },
        "title": "定价上下文"
      },
      "pricingPricingItem": {
        "type": "object",
        "properties": {
          "item_id": {
            "type": "string"
          },
          "material": {
            "type": "string"
          },
          "quantity": {
            "type": "string"
          },
          "unit": {
            "type": "string"
          }
        },
        "title": "待定价的项目"
      },
      "pricingPricingResult": {
        "type": "object",
        "properties": {
          "item_id": {
            "type": "string"
          },
          "net_price": {
            "$ref": "#/components/schemas/commonMonetaryValue"
          },
          "tax_amount": {
            "$ref": "#/components/schemas/commonMonetaryValue"
          },
          "gross_price": {
            "$ref": "#/components/schemas/commonMonetaryValue"
          },
          "conditions": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/pricingPricingCondition"
            }
          }
        },
        "title": "定价结果"
      },
      "pricingUpdatePricingConditionRequest": {
        "type": "object",
        "properties": {
          "condition_type": {
            "$ref": "#/components/schemas/commonPricingConditionType"
          },
          "material": {
            "type": "string"
          },
          "customer": {
            "type": "string",
            "title": "Optional"
          },
          "sales_org": {
            "type": "string"
          },
          "amount": {
            "type": "string"
          },
          "currency": {
            "type": "string"
          },
          "validity_period": {
            "$ref": "#/components/schemas/commonDateRange"
          },
          "context": {
            "$ref": "#/components/schemas/commonRequestContext"
          }
        }
      },
      "pricingUpdatePricingConditionResponse": {
        "type": "object",
        "properties": {
          "success": {
            "type": "boolean"
          },
          "condition_record_id": {
            "type": "string"
          },
          "messages": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/commonApiMessage"
            }
          }
        }
      },
      "protobufAny": {
        "type": "object",
        "properties": {
          "@type": {
            "type": "string"
          }
        },
        "additionalProperties": {}
      },
      "rpcStatus": {
        "type": "object",
        "properties": {
          "code": {
            "type": "integer",
            "format": "int32"
          },
          "message": {
            "type": "string"
          },
          "details": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/protobufAny"
            }
          }
        }
      }
    },
    "securitySchemes": {
      "BearerAuth": {
        "type": "http",
        "scheme": "bearer",
        "bearerFormat": "JWT",
        "description": "Enter your JWT token (e.g. from Login API)"
      }
    }
  },
  "security": [
    {
      "BearerAuth": []
    }
  ]
}