# 微服务 Helm Chart 默认配置
replicaCount: 2

image:
  repository: cuba-erp/service
  pullPolicy: IfNotPresent
  tag: "latest"

nameOverride: ""
fullnameOverride: ""

service:
  type: ClusterIP
  grpcPort: 50051
  metricsPort: 9090
  protocol: TCP

env:
  RUST_LOG: "info"
  # 注意: DATABASE_URL 在 deployment.yaml 中从 secrets 构建
  # 不要在此处设置 DATABASE_URL 以避免凭据泄露

resources:
  limits:
    cpu: 500m
    memory: 512Mi
  requests:
    cpu: 100m
    memory: 128Mi

# 存活探针
livenessProbe:
  grpc:
    port: 50051
  initialDelaySeconds: 10
  periodSeconds: 10

# 就绪探针
readinessProbe:
  grpc:
    port: 50051
  initialDelaySeconds: 5
  periodSeconds: 5

nodeSelector: {}
tolerations: []
affinity: {}

# Istio sidecar 注入
podAnnotations:
  sidecar.istio.io/inject: "true"

# 数据库配置 (凭据来自 Secret)
database:
  name: ""
  secretName: cuba-postgres-credentials
