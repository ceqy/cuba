// ============================================================================
// 通用消息定义
// 描述: 此文件定义了所有微服务共享的通用数据类型。
// ============================================================================

syntax = "proto3";

package enterprise.common;
option go_package = "github.com/yourproject/common";


import "google/protobuf/timestamp.proto";

// ============================================================================
// 枚举定义 (Enumerations)
// ============================================================================

// 银行对账单格式
enum BankStatementFormat {
  BANK_STATEMENT_FORMAT_UNSPECIFIED = 0;
  BANK_STATEMENT_FORMAT_MT940 = 1;
  BANK_STATEMENT_FORMAT_CAMT053 = 2;
  BANK_STATEMENT_FORMAT_BAI2 = 3;
  BANK_STATEMENT_FORMAT_OFX = 4;
  BANK_STATEMENT_FORMAT_CSV_CUSTOM = 5;
  BANK_STATEMENT_FORMAT_MULTI_CASH = 6;
}

// 账户类型
enum AccountType {
  ACCOUNT_TYPE_UNSPECIFIED = 0;
  ACCOUNT_TYPE_CUSTOMER = 1;
  ACCOUNT_TYPE_SUPPLIER = 2;
  ACCOUNT_TYPE_GL = 3;
  ACCOUNT_TYPE_ASSET = 4;
  ACCOUNT_TYPE_MATERIAL = 5;
}

// 支付方式
enum PaymentMethodType {
  PAYMENT_METHOD_TYPE_UNSPECIFIED = 0;
  PAYMENT_METHOD_TYPE_SEPA = 1;
  PAYMENT_METHOD_TYPE_WIRE = 2;
  PAYMENT_METHOD_TYPE_CHECK = 3;
  PAYMENT_METHOD_TYPE_ACH = 4;
  PAYMENT_METHOD_TYPE_CREDIT_CARD = 5;
  PAYMENT_METHOD_TYPE_CASH = 6;
  PAYMENT_METHOD_TYPE_BILL_OF_EXCHANGE = 7;
  PAYMENT_METHOD_TYPE_DIRECT_DEBIT = 8;
}

// 报表类型
enum ReportType {
  REPORT_TYPE_UNSPECIFIED = 0;
  REPORT_TYPE_AGING_ANALYSIS = 1;
  REPORT_TYPE_OPEN_ITEMS = 2;
  REPORT_TYPE_STATEMENT = 3;
  REPORT_TYPE_TRIAL_BALANCE = 4;
  REPORT_TYPE_JOURNAL = 5;
}

// 导入格式
enum ImportFormat {
  IMPORT_FORMAT_UNSPECIFIED = 0;
  IMPORT_FORMAT_CSV = 1;
  IMPORT_FORMAT_EXCEL = 2;
  IMPORT_FORMAT_JSON = 3;
  IMPORT_FORMAT_XML = 4;
}

// 异步作业状态
enum JobStatus {
  JOB_STATUS_UNSPECIFIED = 0;
  JOB_STATUS_PENDING = 1;
  JOB_STATUS_RUNNING = 2;
  JOB_STATUS_COMPLETED = 3;
  JOB_STATUS_FAILED = 4;
  JOB_STATUS_CANCELLED = 5;
  JOB_STATUS_PARTIALLY_COMPLETED = 6;
}

// 凭证类型 (Procurement)
enum DocumentType {
  DOCUMENT_TYPE_UNSPECIFIED = 0;
  DOCUMENT_TYPE_STANDARD_PO = 1;
  DOCUMENT_TYPE_CONTRACT = 2;
  DOCUMENT_TYPE_RFQ = 3;
  DOCUMENT_TYPE_SCHEDULING_AGREEMENT = 4;
  DOCUMENT_TYPE_FRAMEWORK_ORDER = 5;
  DOCUMENT_TYPE_CONSIGNMENT = 6;
  DOCUMENT_TYPE_STOCK_TRANSPORT = 7;
  DOCUMENT_TYPE_SALES_ORDER = 8;
  DOCUMENT_TYPE_PURCHASE_ORDER = 9; // Added for generic PO reference
  DOCUMENT_TYPE_DELIVERY = 10;
  DOCUMENT_TYPE_INVOICE = 11;
  DOCUMENT_TYPE_PAYMENT = 12;
  DOCUMENT_TYPE_RESERVATION = 13;
  DOCUMENT_TYPE_TRANSFER_ORDER = 14;
  DOCUMENT_TYPE_SHIPMENT = 15;
}

// 项目类别 (Procurement)
enum ItemCategory {
  ITEM_CATEGORY_UNSPECIFIED = 0;
  ITEM_CATEGORY_STANDARD = 1;
  ITEM_CATEGORY_LIMIT = 2;
  ITEM_CATEGORY_CONSIGNMENT = 3;
  ITEM_CATEGORY_SUBCONTRACTING = 4;
  ITEM_CATEGORY_THIRD_PARTY = 5;
  ITEM_CATEGORY_SERVICE = 6;
}

// 审批状态 (Procurement)
enum ReleaseStatus {
  RELEASE_STATUS_UNSPECIFIED = 0;
  RELEASE_STATUS_NOT_RELEASED = 1;
  RELEASE_STATUS_PARTIALLY_RELEASED = 2;
  RELEASE_STATUS_RELEASED = 3;
  RELEASE_STATUS_BLOCKED = 4;
  RELEASE_STATUS_REJECTED = 5;
}

// 时间粒度 (Analytics)
enum TimeGranularity {
  TIME_GRANULARITY_UNSPECIFIED = 0;
  TIME_GRANULARITY_DAILY = 1;
  TIME_GRANULARITY_MONTHLY = 2;
  TIME_GRANULARITY_QUARTERLY = 3;
  TIME_GRANULARITY_YEARLY = 4;
}

// 看板状态 (Kanban)
enum KanbanStatus {
  KANBAN_STATUS_UNSPECIFIED = 0;
  // 空 (需要补货)
  KANBAN_STATUS_EMPTY = 1;
  // 满 (已补货)
  KANBAN_STATUS_FULL = 2;
  // 运输中
  KANBAN_STATUS_IN_TRANSIT = 3;
  // 等待中
  KANBAN_STATUS_WAIT = 4;
  // 错误
  KANBAN_STATUS_ERROR = 5;
  // 使用中
  KANBAN_STATUS_IN_USE = 6;
}

// 工序/订单状态 (Production)
enum OperationStatus {
  OPERATION_STATUS_UNSPECIFIED = 0;
  // 已创建
  OPERATION_STATUS_CRTD = 1;
  // 已下达
  OPERATION_STATUS_REL = 2;
  // 部分确认
  OPERATION_STATUS_PCNF = 3;
  // 已确认
  OPERATION_STATUS_CNF = 4;
  // 已交货
  OPERATION_STATUS_DLV = 5;
  // 技术性完成
  OPERATION_STATUS_TECO = 6;
  // 已关闭
  OPERATION_STATUS_CLSD = 7;
}

// 订单状态 (Production)
enum OrderStatus {
  ORDER_STATUS_UNSPECIFIED = 0;
  ORDER_STATUS_CREATED = 1;
  ORDER_STATUS_RELEASED = 2;
  ORDER_STATUS_CONFIRMED = 3;
  ORDER_STATUS_PARTIALLY_CONFIRMED = 4;
  ORDER_STATUS_DELIVERED = 5;
  ORDER_STATUS_TECO = 6; // Technically Completed
  ORDER_STATUS_CLOSED = 7;
  ORDER_STATUS_LOCKED = 8;
  ORDER_STATUS_DELETED = 9;
}

// 补货策略 (Kanban/Production)
enum ReplenishmentStrategy {
  REPLENISHMENT_STRATEGY_UNSPECIFIED = 0;
  // 内部生产
  REPLENISHMENT_STRATEGY_IN_HOUSE = 1;
  // 外部采购
  REPLENISHMENT_STRATEGY_EXTERNAL = 2;
  // 库存转储
  REPLENISHMENT_STRATEGY_STOCK_TRANSFER = 3;
  // 寄售
  REPLENISHMENT_STRATEGY_CONSIGNMENT = 4;
}

// MRP 运行类型
enum MRPRunType {
  MRP_RUN_TYPE_UNSPECIFIED = 0;
  // 净改变计划 (Net Change)
  MRP_RUN_TYPE_NETCH = 1;
  // 计划范围内净改变 (Net Change in Planning Horizon)
  MRP_RUN_TYPE_NETPL = 2;
  // 重新计划 (Regenerative Planning)
  MRP_RUN_TYPE_NEUPL = 3;
}

// 检验批来源
enum InspectionLotOrigin {
  INSPECTION_LOT_ORIGIN_UNSPECIFIED = 0;
  // 收货
  INSPECTION_LOT_ORIGIN_GOODS_RECEIPT = 1;
  // 生产
  INSPECTION_LOT_ORIGIN_PRODUCTION = 2;
  // 外协
  INSPECTION_LOT_ORIGIN_SUB_CONTRACTING = 3;
  // 库存转移
  INSPECTION_LOT_ORIGIN_STOCK_TRANSFER = 4;
  // 客户退货
  INSPECTION_LOT_ORIGIN_CUSTOMER_RETURN = 5;
}

// 使用决策代码
enum UsageDecision {
  USAGE_DECISION_UNSPECIFIED = 0;
  // 接受
  USAGE_DECISION_ACCEPT = 1;
  // 拒绝
  USAGE_DECISION_REJECT = 2;
  // 让步接收/有条件接受
  USAGE_DECISION_CONDITIONAL = 3;
  // 报废
  USAGE_DECISION_SCRAP = 4;
  // 返工
  USAGE_DECISION_REWORK = 5;
}

// --- Supply Chain Specific Enums ---

// 节点类型 (Traceability)
enum NodeType {
  NODE_TYPE_UNSPECIFIED = 0;
  NODE_TYPE_RAW_MATERIAL = 1;
  NODE_TYPE_WIP = 2;
  NODE_TYPE_FINISHED_GOOD = 3;
  NODE_TYPE_BATCH = 4;
  NODE_TYPE_ORDER = 5;
  NODE_TYPE_SUPPLIER = 6;
  NODE_TYPE_CUSTOMER = 7;
}

// 预测模型 (Forecasting)
enum ForecastModel {
  FORECAST_MODEL_UNSPECIFIED = 0;
  FORECAST_MODEL_MOVING_AVERAGE = 1;
  FORECAST_MODEL_EXPONENTIAL_SMOOTHING = 2;
  FORECAST_MODEL_ARIMA = 3;
  FORECAST_MODEL_LINEAR_REGRESSION = 4;
  FORECAST_MODEL_HOLT_WINTERS = 5;
  FORECAST_MODEL_CROSTON = 6; // For intermittent demand
  FORECAST_MODEL_MACHINE_LEARNING_ENSEMBLE = 7;
}

// 移动类型 (Inventory)
enum MovementType {
  MOVEMENT_TYPE_UNSPECIFIED = 0;
  MOVEMENT_TYPE_GOODS_RECEIPT = 1; // 101
  MOVEMENT_TYPE_GOODS_ISSUE = 2;   // 201, 261
  MOVEMENT_TYPE_TRANSFER_POSTING = 3; // 301, 311
  MOVEMENT_TYPE_STOCK_TRANSFER = 4; // 351, 641
  MOVEMENT_TYPE_RETURN_DELIVERY = 5; // 122
  MOVEMENT_TYPE_CANCELLATION = 6; // 102, 202
}

// 货运类型 (Transportation)
enum ShipmentType {
  SHIPMENT_TYPE_UNSPECIFIED = 0;
  SHIPMENT_TYPE_ROAD = 1;
  SHIPMENT_TYPE_RAIL = 2;
  SHIPMENT_TYPE_AIR = 3;
  SHIPMENT_TYPE_OCEAN = 4;
  SHIPMENT_TYPE_MULTIMODAL = 5;
  SHIPMENT_TYPE_PARCEL = 6;
}

// 货运状态 (Transportation)
enum ShipmentStatus {
  SHIPMENT_STATUS_UNSPECIFIED = 0;
  SHIPMENT_STATUS_PLANNED = 1;
  SHIPMENT_STATUS_CHECKED_IN = 2;
  SHIPMENT_STATUS_LOADED = 3;
  SHIPMENT_STATUS_DISPATCHED = 4;
  SHIPMENT_STATUS_IN_TRANSIT = 5;
  SHIPMENT_STATUS_ARRIVED = 6;
  SHIPMENT_STATUS_DELIVERED = 7;
  SHIPMENT_STATUS_COMPLETED = 8;
  SHIPMENT_STATUS_CANCELLED = 9;
}

// 流程状态 (Visibility/Flow)
enum FlowStatus {
  FLOW_STATUS_UNSPECIFIED = 0;
  FLOW_STATUS_CREATED = 1;
  FLOW_STATUS_RELEASED = 2;
  FLOW_STATUS_PROCESSED = 3;
  FLOW_STATUS_PARTIALLY_FULFILLED = 4;
  FLOW_STATUS_COMPLETED = 5;
  FLOW_STATUS_CANCELLED = 6;
  FLOW_STATUS_DELAYED = 7;
  FLOW_STATUS_ON_HOLD = 8;
}

// ============================================================================
// 基础数据类型
// ============================================================================

message MonetaryValue {
  string currency_code = 1; 
  string value = 2;
}

message QuantityValue {
  string unit_code = 1;
  string value = 2;
}

message DateRange {
  google.protobuf.Timestamp start_date = 1;
  google.protobuf.Timestamp end_date = 2;
}

message TimestampRange {
  google.protobuf.Timestamp start_time = 1;
  google.protobuf.Timestamp end_time = 2;
}

// ============================================================================
// 集合与分页
// ============================================================================

message PaginationRequest {
  int32 page = 1;
  int32 page_size = 2;
  string sort_by = 3;
  bool descending = 4;
}

message PaginationResponse {
  int32 current_page = 1;
  int32 page_size = 2;
  int64 total_items = 3;
  int32 total_pages = 4;
}

// ============================================================================
// 通用过滤器
// ============================================================================

message StatusFilter {
  repeated string include_statuses = 1;
  repeated string exclude_statuses = 2;
}

message AmountRangeFilter {
  MonetaryValue min_amount = 1;
  MonetaryValue max_amount = 2;
}

// ============================================================================
// 系统交互
// ============================================================================

message SystemDocumentReference {
  string document_number = 1;
  int32 fiscal_year = 2;
  string company_code = 3;
  string document_type = 4;
  string document_category = 5;
}

message ApiMessage {
  string type = 1;
  string code = 2;
  string message = 3;
  string target = 4;
}

message AuditData {
  string created_by = 1;
  google.protobuf.Timestamp created_at = 2;
  string changed_by = 3;
  google.protobuf.Timestamp changed_at = 4;
}

message ErrorDetail {
  string item_id = 1;
  string error_message = 2;
  string error_code = 3;
}

message BatchOperationResult {
  int32 success_count = 1;
  int32 failure_count = 2;
  repeated ErrorDetail errors = 3;
}

// ============================================================================
// 异步作业
// ============================================================================

message JobInfo {
  string job_id = 1;
  string job_type = 2;
  JobStatus status = 3;
  google.protobuf.Timestamp created_at = 4;
  google.protobuf.Timestamp started_at = 5;
  google.protobuf.Timestamp completed_at = 6;
  int32 progress_percentage = 7;
  repeated ApiMessage messages = 8;
  string error_detail = 9;
}

// ============================================================================
// 库存移动 (Manufacturing Shared)
// ============================================================================

message StockMovementHeader {
  string document_date = 1;
  string posting_date = 2;
  string header_text = 3;
}

message StockMovementItem {
  string material = 1;
  string plant = 2;
  string storage_location = 3;
  string batch = 4;
  MovementType move_type = 5;
  QuantityValue quantity = 6;
  string cost_center = 7;
  string order_number = 8;
  string order_item = 9;
}

message StockMovementResponse {
  bool success = 1;
  string material_document_number = 2;
  int32 material_document_year = 3;
  repeated ApiMessage messages = 4;
}

// ============================================================================
// 主数据片段
// ============================================================================

message Address {
  string country = 1;
  string region = 2;
  string city = 3;
  string postal_code = 4;
  string street = 5;
  string house_number = 6;
}

// ============================================================================
// 请求上下文 (Request Context)
// ============================================================================

message RequestContext {
  string request_id = 1;
  string tenant_id = 2;
  string user_id = 3;
  repeated string roles = 4;
  string idempotency_key = 5;
  string locale = 6;
  google.protobuf.Timestamp timestamp = 7;
  string source_system = 8;
  string correlation_id = 9;
}
