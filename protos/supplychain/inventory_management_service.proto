// ============================================================================
// /supplychain/inventory-management-service
// 描述: 提供完整的库存管理功能，包括库存查询、库存移动、批次管理、序列号管理、
//       物理盘点、库存预留、库存评估等。
//       字段设计深度参考核心ERP的：
//       MKPF (物料凭证抬头), MSEG (物料凭证段), MARD (工厂/存储地点库存),
//       MCHB (批次库存), MCHA (批次主数据), MARC (工厂物料数据),
//       MSKA (销售订单库存), MBEW (物料评估), NSDM_V_MSEG (扩展物料凭证)
// ============================================================================

syntax = "proto3";

package enterprise.supplychain.inventory;

option java_package = "com.enterprise.supplychain.inventory.v2";
option java_multiple_files = true;
option go_package = "github.com/enterprise-extensions/supplychain/inventory/v2;inventory";

import "google/protobuf/timestamp.proto";
import "common/common.proto";

// ============================================================================
// 服务定义: InventoryManagementService
// ============================================================================

service InventoryManagementService {
  // --------------------------------------------------------------------------
  // 库存查询 (Stock Query)
  // --------------------------------------------------------------------------

  // 获取物料在不同存储地点的库存概览
  rpc GetStockOverview(GetStockOverviewRequest) returns (GetStockOverviewResponse);

  // 获取详细库存信息（包括批次、特殊库存等）
  rpc GetDetailedStock(GetDetailedStockRequest) returns (GetDetailedStockResponse);

  // 批次库存查询
  rpc GetBatchStock(GetBatchStockRequest) returns (GetBatchStockResponse);

  // 查询特殊库存（寄售、项目库存、销售订单库存等）
  rpc GetSpecialStock(GetSpecialStockRequest) returns (GetSpecialStockResponse);

  // 库存可用性检查 (ATP - Available to Promise)
  rpc CheckStockAvailability(CheckStockAvailabilityRequest) returns (StockAvailabilityResponse);

  // 物料凭证查询
  rpc GetMaterialDocument(GetMaterialDocumentRequest) returns (MaterialDocumentDetail);

  // 查询物料凭证列表
  rpc ListMaterialDocuments(ListMaterialDocumentsRequest) returns (ListMaterialDocumentsResponse);

  // 查询物料移动历史
  rpc GetMaterialMovementHistory(GetMaterialMovementHistoryRequest) returns (MaterialMovementHistoryResponse);

  // --------------------------------------------------------------------------
  // 库存移动 (Stock Movement)
  // --------------------------------------------------------------------------

  // 执行库存移动（如库存转移、杂项收发货）
  rpc PostStockMovement(PostStockMovementRequest) returns (StockMovementResponse);

  // 批量过账库存移动
  rpc BatchPostStockMovements(BatchPostStockMovementsRequest) returns (BatchStockMovementResponse);

  // 冲销物料凭证
  rpc ReverseMaterialDocument(ReverseMaterialDocumentRequest) returns (StockMovementResponse);

  // 取消物料凭证
  rpc CancelMaterialDocument(CancelMaterialDocumentRequest) returns (CancelMaterialDocumentResponse);

  // --------------------------------------------------------------------------
  // 批次管理 (Batch Management)
  // --------------------------------------------------------------------------

  // 创建批次
  rpc CreateBatch(CreateBatchRequest) returns (CreateBatchResponse);

  // 获取批次详情
  rpc GetBatchDetails(GetBatchDetailsRequest) returns (BatchDetails);

  // 查询批次列表
  rpc ListBatches(ListBatchesRequest) returns (ListBatchesResponse);

  // 批次特性修改
  rpc UpdateBatchCharacteristics(UpdateBatchCharacteristicsRequest) returns (UpdateBatchCharacteristicsResponse);

  // 批次状态修改（冻结/解冻）
  rpc ChangeBatchStatus(ChangeBatchStatusRequest) returns (ChangeBatchStatusResponse);

  // 批次确定（自动选择批次）
  rpc DetermineBatch(DetermineBatchRequest) returns (DetermineBatchResponse);

  // 批次追溯（Where-Used）
  rpc TraceBatchUsage(TraceBatchUsageRequest) returns (BatchUsageTraceResponse);

  // --------------------------------------------------------------------------
  // 序列号管理 (Serial Number Management)
  // --------------------------------------------------------------------------

  // 创建序列号
  rpc CreateSerialNumbers(CreateSerialNumbersRequest) returns (CreateSerialNumbersResponse);

  // 获取序列号详情
  rpc GetSerialNumberDetails(GetSerialNumberDetailsRequest) returns (SerialNumberDetails);

  // 查询序列号列表
  rpc ListSerialNumbers(ListSerialNumbersRequest) returns (ListSerialNumbersResponse);

  // 序列号状态修改
  rpc ChangeSerialNumberStatus(ChangeSerialNumberStatusRequest) returns (ChangeSerialNumberStatusResponse);

  // 序列号追溯
  rpc TraceSerialNumber(TraceSerialNumberRequest) returns (SerialNumberTraceResponse);

  // --------------------------------------------------------------------------
  // 物理盘点 (Physical Inventory)
  // --------------------------------------------------------------------------

  // 创建物理盘点凭证
  rpc CreatePhysicalInventoryDocument(CreatePIDocumentRequest) returns (PIDocumentResponse);

  // 输入盘点数量
  rpc EnterInventoryCount(EnterInventoryCountRequest) returns (EnterInventoryCountResponse);

  // 重新盘点
  rpc ReCountInventory(ReCountInventoryRequest) returns (ReCountInventoryResponse);

  // 过账盘点差异
  rpc PostInventoryDifference(PostInventoryDifferenceRequest) returns (StockMovementResponse);

  // 查询盘点凭证列表
  rpc ListPhysicalInventoryDocuments(ListPIDocumentsRequest) returns (ListPIDocumentsResponse);

  // 获取盘点差异报表
  rpc GetInventoryDifferenceReport(GetInventoryDifferenceReportRequest) returns (InventoryDifferenceReportResponse);

  // 循环盘点管理
  rpc ManageCycleCounting(ManageCycleCountingRequest) returns (ManageCycleCountingResponse);

  // --------------------------------------------------------------------------
  // 库存预留 (Stock Reservation)
  // --------------------------------------------------------------------------

  // 创建库存预留
  rpc CreateReservation(CreateReservationRequest) returns (ReservationResponse);

  // 修改库存预留
  rpc UpdateReservation(UpdateReservationRequest) returns (ReservationResponse);

  // 删除库存预留
  rpc DeleteReservation(DeleteReservationRequest) returns (DeleteReservationResponse);

  // 查询预留列表
  rpc ListReservations(ListReservationsRequest) returns (ListReservationsResponse);

  // 预留发货
  rpc IssueReservation(IssueReservationRequest) returns (StockMovementResponse);

  // --------------------------------------------------------------------------
  // 库存转储 (Stock Transfer)
  // --------------------------------------------------------------------------

  // 创建转储订单
  rpc CreateStockTransferOrder(CreateStockTransferOrderRequest) returns (StockTransferOrderResponse);

  // 过账转储
  rpc PostStockTransfer(PostStockTransferRequest) returns (StockMovementResponse);

  // 跨工厂转储
  rpc PostInterPlantTransfer(PostInterPlantTransferRequest) returns (InterPlantTransferResponse);

  // --------------------------------------------------------------------------
  // 库存评估 (Stock Valuation)
  // --------------------------------------------------------------------------

  // 获取库存价值
  rpc GetStockValuation(GetStockValuationRequest) returns (StockValuationResponse);

  // 库存价格修改
  rpc ChangeStockPrice(ChangeStockPriceRequest) returns (ChangeStockPriceResponse);

  // 物料分割评估
  rpc SplitValuation(SplitValuationRequest) returns (SplitValuationResponse);

  // --------------------------------------------------------------------------
  // 高级功能 (Advanced Features)
  // --------------------------------------------------------------------------

  // 库存老化分析
  rpc AnalyzeStockAging(AnalyzeStockAgingRequest) returns (StockAgingAnalysisResponse);

  // 呆滞库存分析
  rpc AnalyzeSlowMovingStock(AnalyzeSlowMovingStockRequest) returns (SlowMovingStockAnalysisResponse);

  // 库存周转率分析
  rpc AnalyzeStockTurnover(AnalyzeStockTurnoverRequest) returns (StockTurnoverAnalysisResponse);

  // 安全库存检查
  rpc CheckSafetyStock(CheckSafetyStockRequest) returns (SafetyStockCheckResponse);

  // ABC分析
  rpc PerformABCAnalysis(PerformABCAnalysisRequest) returns (ABCAnalysisResponse);

  // 库存快照
  rpc CreateStockSnapshot(CreateStockSnapshotRequest) returns (StockSnapshotResponse);

  // 库存对账
  rpc ReconcileStock(ReconcileStockRequest) returns (StockReconciliationResponse);

  // --------------------------------------------------------------------------
  // 库存锁定与解冻 (Stock Blocking & Unblocking)
  // --------------------------------------------------------------------------

  // 冻结库存
  rpc BlockStock(BlockStockRequest) returns (BlockStockResponse);

  // 解冻库存
  rpc UnblockStock(UnblockStockRequest) returns (UnblockStockResponse);

  // 查询冻结库存列表
  rpc ListBlockedStock(ListBlockedStockRequest) returns (ListBlockedStockResponse);

  // --------------------------------------------------------------------------
  // 库存调整 (Stock Adjustment)
  // --------------------------------------------------------------------------

  // 创建库存调整
  rpc CreateStockAdjustment(CreateStockAdjustmentRequest) returns (StockAdjustmentResponse);

  // 审批库存调整
  rpc ApproveStockAdjustment(ApproveStockAdjustmentRequest) returns (StockAdjustmentResponse);

  // 查询库存调整列表
  rpc ListStockAdjustments(ListStockAdjustmentsRequest) returns (ListStockAdjustmentsResponse);

  // --------------------------------------------------------------------------
  // 物料主数据查询 (Material Master Data Query)
  // --------------------------------------------------------------------------

  // 获取物料主数据
  rpc GetMaterialMasterData(GetMaterialMasterDataRequest) returns (MaterialMasterData);

  // 查询物料列表
  rpc ListMaterials(ListMaterialsRequest) returns (ListMaterialsResponse);

  // 获取物料工厂数据
  rpc GetMaterialPlantData(GetMaterialPlantDataRequest) returns (MaterialPlantData);

  // 获取物料存储地点数据
  rpc GetMaterialStorageLocationData(GetMaterialStorageLocationDataRequest) returns (MaterialStorageLocationData);

  // --------------------------------------------------------------------------
  // 库存预警 (Stock Alert)
  // --------------------------------------------------------------------------

  // 创建库存预警规则
  rpc CreateStockAlertRule(CreateStockAlertRuleRequest) returns (StockAlertRuleResponse);

  // 查询库存预警
  rpc ListStockAlerts(ListStockAlertsRequest) returns (ListStockAlertsResponse);

  // 确认库存预警
  rpc AcknowledgeStockAlert(AcknowledgeStockAlertRequest) returns (AcknowledgeStockAlertResponse);

  // --------------------------------------------------------------------------
  // 库存成本计算 (Stock Cost Calculation)
  // --------------------------------------------------------------------------

  // 计算库存成本
  rpc CalculateStockCost(CalculateStockCostRequest) returns (StockCostCalculationResponse);

  // 获取物料成本明细
  rpc GetMaterialCostBreakdown(GetMaterialCostBreakdownRequest) returns (MaterialCostBreakdownResponse);

  // --------------------------------------------------------------------------
  // 库存报表与导出 (Stock Reports & Export)
  // --------------------------------------------------------------------------

  // 生成库存报表
  rpc GenerateStockReport(GenerateStockReportRequest) returns (StockReportResponse);

  // 导出库存数据
  rpc ExportStockData(ExportStockDataRequest) returns (ExportStockDataResponse);

  // 生成库存汇总表
  rpc GenerateStockSummaryReport(GenerateStockSummaryReportRequest) returns (StockSummaryReportResponse);

  // --------------------------------------------------------------------------
  // 多工厂库存管理 (Multi-Plant Stock Management)
  // --------------------------------------------------------------------------

  // 跨工厂库存查询
  rpc GetCrossPlantStock(GetCrossPlantStockRequest) returns (CrossPlantStockResponse);

  // 工厂间库存平衡分析
  rpc AnalyzeInterPlantBalance(AnalyzeInterPlantBalanceRequest) returns (InterPlantBalanceAnalysisResponse);

  // --------------------------------------------------------------------------
  // 库存质量管理 (Stock Quality Management)
  // --------------------------------------------------------------------------

  // 转入质检库存
  rpc TransferToQualityInspection(TransferToQualityInspectionRequest) returns (QualityTransferResponse);

  // 质检后库存处理（放行/拒收）
  rpc ProcessQualityInspectionResult(ProcessQualityInspectionResultRequest) returns (QualityProcessingResponse);

  // 查询质检库存
  rpc ListQualityInspectionStock(ListQualityInspectionStockRequest) returns (QualityInspectionStockResponse);

  // --------------------------------------------------------------------------
  // 库存差异处理 (Stock Variance Management)
  // --------------------------------------------------------------------------

  // 创建库存差异报告
  rpc CreateStockVarianceReport(CreateStockVarianceReportRequest) returns (StockVarianceReportResponse);

  // 审批库存差异
  rpc ApproveStockVariance(ApproveStockVarianceRequest) returns (StockVarianceApprovalResponse);

  // 调整库存差异
  rpc AdjustStockVariance(AdjustStockVarianceRequest) returns (StockVarianceAdjustmentResponse);

  // --------------------------------------------------------------------------
  // 库存运输管理 (Stock Transportation Management)
  // --------------------------------------------------------------------------

  // 创建库存运输单
  rpc CreateStockTransportation(CreateStockTransportationRequest) returns (StockTransportationResponse);

  // 确认库存装运
  rpc ConfirmStockShipment(ConfirmStockShipmentRequest) returns (ShipmentConfirmationResponse);

  // 确认库存收货
  rpc ConfirmStockReceipt(ConfirmStockReceiptRequest) returns (ReceiptConfirmationResponse);

  // 查询在途库存
  rpc ListStockInTransit(ListStockInTransitRequest) returns (StockInTransitResponse);

  // --------------------------------------------------------------------------
  // 库存容器管理 (Stock Container Management)
  // --------------------------------------------------------------------------

  // 创建库存容器
  rpc CreateStockContainer(CreateStockContainerRequest) returns (StockContainerResponse);

  // 容器装载
  rpc LoadContainer(LoadContainerRequest) returns (ContainerLoadingResponse);

  // 容器卸载
  rpc UnloadContainer(UnloadContainerRequest) returns (ContainerUnloadingResponse);

  // 查询容器库存
  rpc ListContainerStock(ListContainerStockRequest) returns (ContainerStockResponse);

  // --------------------------------------------------------------------------
  // 库存看板 (Stock Dashboard)
  // --------------------------------------------------------------------------

  // 获取库存仪表板数据
  rpc GetStockDashboard(GetStockDashboardRequest) returns (StockDashboardResponse);

  // 获取库存KPI指标
  rpc GetStockKPIs(GetStockKPIsRequest) returns (StockKPIsResponse);

  // --------------------------------------------------------------------------
  // 库存追溯 (Stock Traceability)
  // --------------------------------------------------------------------------

  // 端到端库存追溯
  rpc TraceStockEndToEnd(TraceStockEndToEndRequest) returns (StockTraceabilityResponse);

  // 获取物料来源追溯
  rpc TraceMaterialOrigin(TraceMaterialOriginRequest) returns (MaterialOriginTraceResponse);

  // 获取物料去向追溯
  rpc TraceMaterialDestination(TraceMaterialDestinationRequest) returns (MaterialDestinationTraceResponse);

  // --------------------------------------------------------------------------
  // 库存预测 (Stock Forecasting)
  // --------------------------------------------------------------------------

  // 预测库存需求
  rpc ForecastStockRequirement(ForecastStockRequirementRequest) returns (StockForecastResponse);

  // 分析库存趋势
  rpc AnalyzeStockTrend(AnalyzeStockTrendRequest) returns (StockTrendAnalysisResponse);

  // --------------------------------------------------------------------------
  // 库存优化建议 (Stock Optimization)
  // --------------------------------------------------------------------------

  // 获取库存优化建议
  rpc GetStockOptimizationRecommendations(GetStockOptimizationRequest) returns (StockOptimizationResponse);

  // 分析超储库存
  rpc AnalyzeOverstock(AnalyzeOverstockRequest) returns (OverstockAnalysisResponse);

  // 分析缺货风险
  rpc AnalyzeStockoutRisk(AnalyzeStockoutRiskRequest) returns (StockoutRiskAnalysisResponse);

  // --------------------------------------------------------------------------
  // 仓库管理 - 拣货与上架 (Warehouse Management - Picking & Putaway)
  // --------------------------------------------------------------------------

  // 创建拣货任务
  rpc CreatePickingTask(CreatePickingTaskRequest) returns (PickingTaskResponse);

  // 确认拣货
  rpc ConfirmPicking(ConfirmPickingRequest) returns (ConfirmPickingResponse);

  // 创建上架任务
  rpc CreatePutawayTask(CreatePutawayTaskRequest) returns (PutawayTaskResponse);

  // 确认上架
  rpc ConfirmPutaway(ConfirmPutawayRequest) returns (ConfirmPutawayResponse);

  // 查询仓库任务列表
  rpc ListWarehouseTasks(ListWarehouseTasksRequest) returns (ListWarehouseTasksResponse);

  // 优化拣货路径
  rpc OptimizePickingPath(OptimizePickingPathRequest) returns (OptimizePickingPathResponse);

  // 查询储位建议
  rpc GetStorageBinRecommendation(GetStorageBinRecommendationRequest) returns (StorageBinRecommendationResponse);

  // 执行库位盘点
  rpc PerformBinCount(PerformBinCountRequest) returns (BinCountResponse);

  // --------------------------------------------------------------------------
  // 波次管理 (Wave Management)
  // --------------------------------------------------------------------------

  // 创建波次
  rpc CreateWave(CreateWaveRequest) returns (WaveResponse);

  // 释放波次
  rpc ReleaseWave(ReleaseWaveRequest) returns (WaveResponse);

  // 查询波次列表
  rpc ListWaves(ListWavesRequest) returns (ListWavesResponse);

  // 合并波次
  rpc MergeWaves(MergeWavesRequest) returns (WaveResponse);

  // --------------------------------------------------------------------------
  // 补货管理 (Replenishment)
  // --------------------------------------------------------------------------

  // 创建补货任务
  rpc CreateReplenishmentTask(CreateReplenishmentTaskRequest) returns (ReplenishmentTaskResponse);

  // 执行自动补货
  rpc ExecuteAutoReplenishment(ExecuteAutoReplenishmentRequest) returns (AutoReplenishmentResponse);

  // 查询补货需求
  rpc ListReplenishmentNeeds(ListReplenishmentNeedsRequest) returns (ReplenishmentNeedsResponse);

  // --------------------------------------------------------------------------
  // 槽位优化 (Slotting Optimization)
  // --------------------------------------------------------------------------

  // 执行槽位分析
  rpc PerformSlottingAnalysis(PerformSlottingAnalysisRequest) returns (SlottingAnalysisResponse);

  // 应用槽位建议
  rpc ApplySlottingRecommendations(ApplySlottingRecommendationsRequest) returns (ApplySlottingRecommendationsResponse);

  // --------------------------------------------------------------------------
  // 越库作业 (Cross-Docking)
  // --------------------------------------------------------------------------

  // 创建越库订单
  rpc CreateCrossDockingOrder(CreateCrossDockingOrderRequest) returns (CrossDockingOrderResponse);

  // 执行越库操作
  rpc ExecuteCrossDocking(ExecuteCrossDockingRequest) returns (CrossDockingResponse);

  // 查询越库候选项
  rpc ListCrossDockingCandidates(ListCrossDockingCandidatesRequest) returns (CrossDockingCandidatesResponse);

  // --------------------------------------------------------------------------
  // 寄售库存管理 (Consignment Inventory)
  // --------------------------------------------------------------------------

  // 接收寄售库存
  rpc ReceiveConsignmentStock(ReceiveConsignmentStockRequest) returns (ConsignmentStockResponse);

  // 消耗寄售库存
  rpc ConsumeConsignmentStock(ConsumeConsignmentStockRequest) returns (ConsignmentStockResponse);

  // 退回寄售库存
  rpc ReturnConsignmentStock(ReturnConsignmentStockRequest) returns (ConsignmentStockResponse);

  // 查询寄售库存明细
  rpc ListConsignmentStock(ListConsignmentStockRequest) returns (ConsignmentStockListResponse);

  // 生成寄售结算单
  rpc GenerateConsignmentSettlement(GenerateConsignmentSettlementRequest) returns (ConsignmentSettlementResponse);

  // --------------------------------------------------------------------------
  // 委外加工库存 (Subcontracting Inventory)
  // --------------------------------------------------------------------------

  // 发送委外物料
  rpc SendSubcontractingMaterial(SendSubcontractingMaterialRequest) returns (SubcontractingMaterialResponse);

  // 接收委外成品
  rpc ReceiveSubcontractingProduct(ReceiveSubcontractingProductRequest) returns (SubcontractingProductResponse);

  // 查询委外库存
  rpc ListSubcontractingStock(ListSubcontractingStockRequest) returns (SubcontractingStockResponse);

  // --------------------------------------------------------------------------
  // 可回收包装管理 (Returnable Packaging)
  // --------------------------------------------------------------------------

  // 发出可回收包装
  rpc IssueReturnablePackaging(IssueReturnablePackagingRequest) returns (ReturnablePackagingResponse);

  // 接收可回收包装
  rpc ReceiveReturnablePackaging(ReceiveReturnablePackagingRequest) returns (ReturnablePackagingResponse);

  // 查询包装库存
  rpc ListPackagingInventory(ListPackagingInventoryRequest) returns (PackagingInventoryResponse);

  // --------------------------------------------------------------------------
  // 危险品管理 (Hazardous Material Management)
  // --------------------------------------------------------------------------

  // 登记危险品入库
  rpc RegisterHazmatReceipt(RegisterHazmatReceiptRequest) returns (HazmatResponse);

  // 危险品合规检查
  rpc CheckHazmatCompliance(CheckHazmatComplianceRequest) returns (HazmatComplianceResponse);

  // 查询危险品库存
  rpc ListHazmatInventory(ListHazmatInventoryRequest) returns (HazmatInventoryResponse);

  // 生成危险品报告
  rpc GenerateHazmatReport(GenerateHazmatReportRequest) returns (HazmatReportResponse);

  // --------------------------------------------------------------------------
  // 生产集成 (Production Integration)
  // --------------------------------------------------------------------------

  // 执行倒冲
  rpc ExecuteBackflushing(ExecuteBackflushingRequest) returns (BackflushingResponse);

  // 接收副产品
  rpc ReceiveByProduct(ReceiveByProductRequest) returns (ByProductResponse);

  // 查询在制品库存
  rpc ListWorkInProcessInventory(ListWorkInProcessInventoryRequest) returns (WorkInProcessInventoryResponse);

  // 预留生产组件
  rpc StageProductionComponents(StageProductionComponentsRequest) returns (StagingResponse);

  // --------------------------------------------------------------------------
  // 合规与审计 (Compliance & Audit)
  // --------------------------------------------------------------------------

  // 查询审计追踪
  rpc GetAuditTrail(GetAuditTrailRequest) returns (AuditTrailResponse);

  // 执行合规检查
  rpc ExecuteComplianceCheck(ExecuteComplianceCheckRequest) returns (ComplianceCheckResponse);

  // 生成SOX合规报告
  rpc GenerateSOXComplianceReport(GenerateSOXComplianceReportRequest) returns (SOXComplianceReportResponse);

  // 查询GMP批次记录
  rpc GetGMPBatchRecord(GetGMPBatchRecordRequest) returns (GMPBatchRecordResponse);

  // --------------------------------------------------------------------------
  // 集成与事件 (Integration & Events)
  // --------------------------------------------------------------------------

  // 发布库存变更事件
  rpc PublishInventoryEvent(PublishInventoryEventRequest) returns (PublishEventResponse);

  // 同步外部系统库存
  rpc SyncExternalSystemInventory(SyncExternalSystemInventoryRequest) returns (SyncInventoryResponse);

  // 处理IDoc消息
  rpc ProcessIDocMessage(ProcessIDocMessageRequest) returns (ProcessIDocMessageResponse);

  // 注册Webhook
  rpc RegisterWebhook(RegisterWebhookRequest) returns (RegisterWebhookResponse);

  // --------------------------------------------------------------------------
  // 高级分析 (Advanced Analytics)
  // --------------------------------------------------------------------------

  // 预测库存需求 (ML增强)
  rpc PredictInventoryDemandML(PredictInventoryDemandMLRequest) returns (MLPredictionResponse);

  // 分析供应链风险
  rpc AnalyzeSupplyChainRisk(AnalyzeSupplyChainRiskRequest) returns (SupplyChainRiskResponse);

  // 计算库存健康分数
  rpc CalculateInventoryHealthScore(CalculateInventoryHealthScoreRequest) returns (InventoryHealthScoreResponse);

  // 根因分析
  rpc PerformRootCauseAnalysis(PerformRootCauseAnalysisRequest) returns (RootCauseAnalysisResponse);

  // 库存异常检测
  rpc DetectInventoryAnomalies(DetectInventoryAnomaliesRequest) returns (AnomalyDetectionResponse);

  // --------------------------------------------------------------------------
  // 批次族谱 (Batch Genealogy)
  // --------------------------------------------------------------------------

  // 查询批次族谱
  rpc GetBatchGenealogy(GetBatchGenealogyRequest) returns (BatchGenealogyResponse);

  // 批次召回模拟
  rpc SimulateBatchRecall(SimulateBatchRecallRequest) returns (BatchRecallSimulationResponse);

  // --------------------------------------------------------------------------
  // 库存策略 (Inventory Strategies)
  // --------------------------------------------------------------------------

  // 配置库存策略
  rpc ConfigureInventoryStrategy(ConfigureInventoryStrategyRequest) returns (InventoryStrategyResponse);

  // 执行动态再订货点计算
  rpc CalculateDynamicReorderPoint(CalculateDynamicReorderPointRequest) returns (DynamicReorderPointResponse);

  // 优化服务水平
  rpc OptimizeServiceLevel(OptimizeServiceLevelRequest) returns (ServiceLevelOptimizationResponse);
}

// ============================================================================
// 数据结构: 库存与物料移动
// ============================================================================

// --------------------------------------------------------------------------
// 枚举定义 (Enumerations)
// --------------------------------------------------------------------------

// 库存类型枚举
enum StockType {
  // 未指定
  STOCK_TYPE_UNSPECIFIED = 0;
  // 非限制使用库存
  STOCK_TYPE_UNRESTRICTED = 1;
  // 质检库存
  STOCK_TYPE_QUALITY_INSPECTION = 2;
  // 冻结库存
  STOCK_TYPE_BLOCKED = 3;
  // 在途库存
  STOCK_TYPE_IN_TRANSIT = 4;
  // 退货库存
  STOCK_TYPE_RETURNS = 5;
}

// 特殊库存类型枚举 (原: SOBKZ)
enum SpecialStockType {
  // 未指定
  SPECIAL_STOCK_TYPE_UNSPECIFIED = 0;
  // 无特殊库存
  SPECIAL_STOCK_TYPE_NONE = 1;
  // E - 销售订单库存
  SPECIAL_STOCK_TYPE_SALES_ORDER = 2;
  // Q - 项目库存
  SPECIAL_STOCK_TYPE_PROJECT = 3;
  // K - 寄售库存（客户）
  SPECIAL_STOCK_TYPE_CONSIGNMENT = 4;
  // M - 管道库存
  SPECIAL_STOCK_TYPE_PIPELINE = 5;
  // O - 订单库存
  SPECIAL_STOCK_TYPE_ORDER = 6;
  // V - 分销链库存
  SPECIAL_STOCK_TYPE_DISTRIBUTION = 7;
  // W - 寄售库存（供应商）
  SPECIAL_STOCK_TYPE_VENDOR_CONSIGNMENT = 8;
}

// 移动类型类别枚举
enum MovementTypeCategory {
  // 未指定
  MOVEMENT_TYPE_CATEGORY_UNSPECIFIED = 0;
  // 收货
  MOVEMENT_TYPE_CATEGORY_GOODS_RECEIPT = 1;
  // 发货
  MOVEMENT_TYPE_CATEGORY_GOODS_ISSUE = 2;
  // 转储
  MOVEMENT_TYPE_CATEGORY_TRANSFER = 3;
  // 盘点差异
  MOVEMENT_TYPE_CATEGORY_INVENTORY_DIFFERENCE = 4;
  // 冲销
  MOVEMENT_TYPE_CATEGORY_REVERSAL = 5;
  // 其他
  MOVEMENT_TYPE_CATEGORY_OTHER = 6;
}

// 批次状态枚举
enum BatchStatus {
  // 未指定
  BATCH_STATUS_UNSPECIFIED = 0;
  // 非限制使用
  BATCH_STATUS_UNRESTRICTED = 1;
  // 质检中
  BATCH_STATUS_QUALITY_INSPECTION = 2;
  // 冻结
  BATCH_STATUS_BLOCKED = 3;
  // 已过期
  BATCH_STATUS_EXPIRED = 4;
  // 待销毁
  BATCH_STATUS_TO_BE_DESTROYED = 5;
}

// 序列号状态枚举
enum SerialNumberStatus {
  // 未指定
  SERIAL_NUMBER_STATUS_UNSPECIFIED = 0;
  // 可用
  SERIAL_NUMBER_STATUS_AVAILABLE = 1;
  // 已使用
  SERIAL_NUMBER_STATUS_IN_USE = 2;
  // 已安装
  SERIAL_NUMBER_STATUS_INSTALLED = 3;
  // 维修中
  SERIAL_NUMBER_STATUS_IN_REPAIR = 4;
  // 已报废
  SERIAL_NUMBER_STATUS_SCRAPPED = 5;
  // 已退回
  SERIAL_NUMBER_STATUS_RETURNED = 6;
}

// 盘点状态枚举
enum PhysicalInventoryStatus {
  // 未指定
  PI_STATUS_UNSPECIFIED = 0;
  // 已创建
  PI_STATUS_CREATED = 1;
  // 已输入数量
  PI_STATUS_COUNTED = 2;
  // 已过账
  PI_STATUS_POSTED = 3;
  // 已取消
  PI_STATUS_CANCELLED = 4;
  // 重新盘点
  PI_STATUS_RECOUNTED = 5;
}

// 预留状态枚举
enum ReservationStatus {
  // 未指定
  RESERVATION_STATUS_UNSPECIFIED = 0;
  // 已创建
  RESERVATION_STATUS_CREATED = 1;
  // 部分发货
  RESERVATION_STATUS_PARTIALLY_ISSUED = 2;
  // 已完成
  RESERVATION_STATUS_COMPLETED = 3;
  // 已取消
  RESERVATION_STATUS_CANCELLED = 4;
  // 已删除
  RESERVATION_STATUS_DELETED = 5;
}

// ABC分类枚举
enum ABCIndicator {
  // 未指定
  ABC_INDICATOR_UNSPECIFIED = 0;
  // A类（高价值）
  ABC_INDICATOR_A = 1;
  // B类（中等价值）
  ABC_INDICATOR_B = 2;
  // C类（低价值）
  ABC_INDICATOR_C = 3;
}

// 评估类型枚举 (原: BWTAR)
enum ValuationType {
  // 未指定
  VALUATION_TYPE_UNSPECIFIED = 0;
  // 标准评估
  VALUATION_TYPE_STANDARD = 1;
  // 分割评估
  VALUATION_TYPE_SPLIT = 2;
}

// 物料凭证状态枚举
enum MaterialDocumentStatus {
  // 未指定
  MATERIAL_DOCUMENT_STATUS_UNSPECIFIED = 0;
  // 已创建
  MATERIAL_DOCUMENT_STATUS_CREATED = 1;
  // 已过账
  MATERIAL_DOCUMENT_STATUS_POSTED = 2;
  // 已冲销
  MATERIAL_DOCUMENT_STATUS_REVERSED = 3;
  // 已取消
  MATERIAL_DOCUMENT_STATUS_CANCELLED = 4;
}


// 库存级别 (参考: MARD, MARC)
message StockLevel {
  // 工厂 (原: WERKS)
  string plant = 1;
  // 存储地点 (原: LGORT)
  string storage_location = 2;
  // 非限制使用库存 (原: LABST)
  string unrestricted_use_stock = 3;
  // 质检库存 (原: INSME)
  string quality_inspection_stock = 4;
  // 冻结库存 (原: SPEME)
  string blocked_stock = 5;
  // 单位 (原: MEINS)
  string unit = 6;
  // 在途库存 (原: UMLME)
  string stock_in_transit = 7;
  // 退货库存 (原: RETME)
  string returns_stock = 8;
  // 在转储订单中的库存
  string stock_in_transfer = 9;
  // 总库存
  string total_stock = 10;
  // 可用库存 (减去预留)
  string available_stock = 11;
  // 批次管理标识 (原: XCHAR from MARC)
  bool batch_managed = 12;
  // 序列号管理标识 (原: SERNR from MARC)
  bool serial_number_managed = 13;
  // 安全库存 (原: EISBE)
  string safety_stock = 14;
  // 最小库存
  string minimum_stock = 15;
  // 最大库存
  string maximum_stock = 16;
  // 再订货点 (原: MINBE)
  string reorder_point = 17;
  // ABC指示符
  ABCIndicator abc_indicator = 18;
  // 上次盘点日期 (原: IDATE)
  google.protobuf.Timestamp last_inventory_date = 19;
  // 上次移动日期
  google.protobuf.Timestamp last_movement_date = 20;
}

// 物料移动抬头 (参考: MKPF)
message StockMovementHeader {
  // 凭证日期 (原: BLDAT)
  google.protobuf.Timestamp document_date = 1;
  // 过账日期 (原: BUDAT)
  google.protobuf.Timestamp posting_date = 2;
  // 凭证抬头文本 (原: BKTXT)
  string header_text = 3;
  // 参考凭证号 (原: XBLNR)
  string reference_document = 4;
  // 交货单号 (原: LFBNR)
  string delivery_note = 5;
  // 采购订单号 (原: EBELN)
  string purchase_order = 6;
  // 销售订单号 (原: VBELN_IM)
  string sales_order = 7;
  // 发货人代码 (原: FRBNR)
  string shipper_number = 8;
  // 提单号 (原: BOLNR)
  string bill_of_lading = 9;
  // 版本号 (原: VERS)
  string version = 10;
  // 打印标识 (原: XBLNR_LONG)
  string print_indicator = 11;
  // 创建人 (原: USNAM)
  string created_by = 12;
  // 创建时间 (原: CPUDT/CPUTM)
  google.protobuf.Timestamp created_at = 13;
}

// 物料移动行项目 (参考: MSEG, NSDM_V_MSEG)
message StockMovementItem {
  // 移动类型 (原: BWART)
  string movement_type = 1;
  // 移动类型类别
  MovementTypeCategory movement_category = 2;
  // 物料编号 (原: MATNR)
  string material = 3;
  // 物料描述
  string material_description = 4;
  // 工厂 (原: WERKS)
  string plant = 5;
  // 存储地点 (原: LGORT)
  string storage_location = 6;
  // 数量 (原: MENGE)
  string quantity = 7;
  // 单位 (原: MEINS)
  string unit = 8;
  // 接收方/发出方工厂 (原: UMWRK)
  string receiving_issuing_plant = 9;
  // 接收方/发出方存储地点 (原: UMLGO)
  string receiving_issuing_location = 10;
  // 批次号 (原: CHARG)
  string batch = 11;
  // 库存类型 (原: INSMK)
  StockType stock_type = 12;
  // 特殊库存类型 (原: SOBKZ)
  SpecialStockType special_stock_type = 13;
  // 特殊库存编号 (原: SONUM) - 如销售订单号、项目号
  string special_stock_number = 14;
  // 成本中心 (原: KOSTL)
  string cost_center = 15;
  // 订单号 (原: AUFNR)
  string order_number = 16;
  // WBS元素 (原: PS_PSP_PNR)
  string wbs_element = 17;
  // 总账科目 (原: SAKTO)
  string gl_account = 18;
  // 借贷标识 (原: SHKZG)
  string debit_credit_indicator = 19;
  // 行项目文本 (原: SGTXT)
  string item_text = 20;
  // 金额 (原: DMBTR)
  string amount = 21;
  // 货币 (原: WAERS)
  string currency = 22;
  // 采购订单号 (原: EBELN)
  string purchase_order = 23;
  // 采购订单行项目 (原: EBELP)
  string purchase_order_item = 24;
  // 销售订单号 (原: VBELN_IM)
  string sales_order = 25;
  // 销售订单行项目 (原: VBELP_IM)
  string sales_order_item = 26;
  // 交货单号 (原: VBELN)
  string delivery_number = 27;
  // 交货单行项目 (原: VBELP)
  string delivery_item = 28;
  // 移动指示符 (原: KZBEW)
  string movement_indicator = 29;
  // 冲销指示符 (原: XSTOB)
  bool reversal_indicator = 30;
  // 原物料凭证号 (用于冲销) (原: SMBLN)
  string original_material_document = 31;
  // 原物料凭证年度 (原: SJAHR)
  int32 original_material_document_year = 32;
  // 原物料凭证行项目 (原: SMBLP)
  string original_material_document_item = 33;
  // 供应商 (原: LIFNR)
  string vendor = 34;
  // 客户 (原: KUNNR)
  string customer = 35;
  // 利润中心 (原: PRCTR)
  string profit_center = 36;
  // 评估类型 (原: BWTAR)
  string valuation_type = 37;
  // 物料凭证年度 (原: MJAHR)
  int32 material_document_year = 38;
  // 物料凭证行项目号 (原: ZEILE)
  string line_item_number = 39;
  // 收货/发货标识 (原: KZZUG)
  string receipt_issue_indicator = 40;
  // 序列号列表
  repeated string serial_numbers = 41;
  // 原因代码 (原: GRUND)
  string reason_code = 42;
  // 收货人 (原: WEMPF)
  string goods_recipient = 43;
  // 卸货点 (原: ABLAD)
  string unloading_point = 44;
  // 资产编号 (原: ANLN1)
  string asset_number = 45;
  // 资产子编号 (原: ANLN2)
  string asset_sub_number = 46;
  // 评估价格 (原: VPRSV)
  string valuation_price = 47;
  // 价格单位 (原: PEINH)
  string price_unit = 48;
}

// --------------------------------------------------------------------------
// 批次管理 (Batch Management) - 参考 MCHA, MCHB
// --------------------------------------------------------------------------

// 批次详情
message BatchDetails {
  // 物料编号
  string material = 1;
  // 批次号 (原: CHARG)
  string batch = 2;
  // 工厂
  string plant = 3;
  // 批次状态
  BatchStatus status = 4;
  // 生产日期 (原: HSDAT)
  google.protobuf.Timestamp production_date = 5;
  // 保质期开始日期 (原: VFDAT)
  google.protobuf.Timestamp shelf_life_expiration_date = 6;
  // 供应商批次号 (原: LICHA)
  string vendor_batch = 7;
  // 供应商
  string vendor = 8;
  // 批次可用数量
  string available_quantity = 9;
  // 批次特性列表
  repeated BatchCharacteristic characteristics = 10;
  // 库存类型分布
  repeated BatchStockDistribution stock_distribution = 11;
  // 最后货物移动日期 (原: LWEDT)
  google.protobuf.Timestamp last_goods_movement_date = 12;
  // 下次检验日期 (原: VPERS)
  google.protobuf.Timestamp next_inspection_date = 13;
  // 批次创建日期
  google.protobuf.Timestamp created_date = 14;
  // 批次创建人
  string created_by = 15;
}

// 批次特性
message BatchCharacteristic {
  // 特性名称
  string characteristic_name = 1;
  // 特性值
  string characteristic_value = 2;
  // 特性单位
  string unit = 3;
  // 特性描述
  string description = 4;
}

// 批次库存分布
message BatchStockDistribution {
  // 存储地点
  string storage_location = 1;
  // 库存类型
  StockType stock_type = 2;
  // 数量
  string quantity = 3;
  // 单位
  string unit = 4;
}

// --------------------------------------------------------------------------
// 序列号管理 (Serial Number Management) - 参考 SERIAL, OBJK
// --------------------------------------------------------------------------

// 序列号详情
message SerialNumberDetails {
  // 物料编号
  string material = 1;
  // 序列号
  string serial_number = 2;
  // 序列号状态
  SerialNumberStatus status = 3;
  // 工厂
  string plant = 4;
  // 存储地点
  string storage_location = 5;
  // 设备号 (如果已安装)
  string equipment_number = 6;
  // 客户
  string customer = 7;
  // 供应商
  string vendor = 8;
  // 生产日期
  google.protobuf.Timestamp production_date = 9;
  // 销售日期
  google.protobuf.Timestamp sales_date = 10;
  // 安装日期
  google.protobuf.Timestamp installation_date = 11;
  // 保修到期日期
  google.protobuf.Timestamp warranty_expiration_date = 12;
  // 序列号历史记录
  repeated SerialNumberHistory history = 13;
  // 备注
  string notes = 14;
}

// 序列号历史
message SerialNumberHistory {
  // 移动日期
  google.protobuf.Timestamp movement_date = 1;
  // 移动类型
  string movement_type = 2;
  // 物料凭证号
  string material_document = 3;
  // 从位置
  string from_location = 4;
  // 到位置
  string to_location = 5;
  // 描述
  string description = 6;
}

// --------------------------------------------------------------------------
// 物料凭证 (Material Document) - 完整凭证详情
// --------------------------------------------------------------------------

// 物料凭证详情
message MaterialDocumentDetail {
  // 物料凭证号 (原: MBLNR)
  string document_number = 1;
  // 物料凭证年度 (原: MJAHR)
  int32 document_year = 2;
  // 凭证状态
  MaterialDocumentStatus status = 3;
  // 凭证抬头
  StockMovementHeader header = 4;
  // 行项目列表
  repeated StockMovementItem items = 5;
  // 相关会计凭证
  string accounting_document = 6;
  // 会计凭证年度
  int32 accounting_document_year = 7;
  // 冲销凭证号 (如果已冲销)
  string reversal_document = 8;
  // 审计信息
  enterprise.common.AuditData audit_data = 9;
}

// --------------------------------------------------------------------------
// 物理盘点 (Physical Inventory)
// --------------------------------------------------------------------------

// 盘点凭证详情
message PhysicalInventoryDocumentDetail {
  // 盘点凭证号
  string document_number = 1;
  // 会计年度
  int32 fiscal_year = 2;
  // 工厂
  string plant = 3;
  // 存储地点
  string storage_location = 4;
  // 盘点状态
  PhysicalInventoryStatus status = 5;
  // 计划盘点日期
  google.protobuf.Timestamp planned_count_date = 6;
  // 实际盘点日期
  google.protobuf.Timestamp actual_count_date = 7;
  // 盘点行项目
  repeated PhysicalInventoryItem items = 8;
  // 创建人
  string created_by = 9;
  // 盘点人
  string counted_by = 10;
}

// 盘点行项目 (参考: ISEG)
message PhysicalInventoryItem {
  // 行项目号
  int32 item_number = 1;
  // 物料编号
  string material = 2;
  // 批次号
  string batch = 3;
  // 账面库存数量 (原: MENGE)
  string book_quantity = 4;
  // 盘点数量 (原: ZAEHL)
  string counted_quantity = 5;
  // 差异数量
  string difference_quantity = 6;
  // 单位
  string unit = 7;
  // 库存类型
  StockType stock_type = 8;
  // 特殊库存类型
  SpecialStockType special_stock_type = 9;
  // 特殊库存编号
  string special_stock_number = 10;
  // 已盘点标识
  bool is_counted = 11;
  // 已过账标识
  bool is_posted = 12;
  // 零盘点标识 (原: XSKZ)
  bool zero_count = 13;
}

// --------------------------------------------------------------------------
// 库存预留 (Stock Reservation) - 参考 RESB
// --------------------------------------------------------------------------

// 预留详情
message ReservationDetails {
  // 预留号 (原: RSNUM)
  string reservation_number = 1;
  // 预留行项目 (原: RSPOS)
  string reservation_item = 2;
  // 预留状态
  ReservationStatus status = 3;
  // 物料编号
  string material = 4;
  // 工厂
  string plant = 5;
  // 存储地点
  string storage_location = 6;
  // 需求数量 (原: BDMNG)
  string requirement_quantity = 7;
  // 已提取数量 (原: ENMNG)
  string withdrawn_quantity = 8;
  // 未清数量
  string open_quantity = 9;
  // 单位
  string unit = 10;
  // 需求日期 (原: BDTER)
  google.protobuf.Timestamp requirement_date = 11;
  // 移动类型 (原: BWART)
  string movement_type = 12;
  // 成本中心
  string cost_center = 13;
  // 订单号
  string order_number = 14;
  // WBS元素
  string wbs_element = 15;
  // 批次
  string batch = 16;
  // 创建日期
  google.protobuf.Timestamp created_date = 17;
  // 创建人
  string created_by = 18;
}

// --------------------------------------------------------------------------
// 库存评估 (Stock Valuation) - 参考 MBEW
// --------------------------------------------------------------------------

// 库存评估数据
message StockValuationData {
  // 物料编号
  string material = 1;
  // 评估范围/工厂 (原: BWKEY)
  string valuation_area = 2;
  // 评估类型 (原: BWTAR)
  string valuation_type = 3;
  // 价格控制 (原: VPRSV) - S=标准价格, V=移动平均价
  string price_control = 4;
  // 标准价格 (原: STPRS)
  string standard_price = 5;
  // 移动平均价 (原: VERPR)
  string moving_average_price = 6;
  // 价格单位 (原: PEINH)
  string price_unit = 7;
  // 总库存价值 (原: SALK3)
  string total_value = 8;
  // 货币
  string currency = 9;
  // 总库存数量 (原: LBKUM)
  string total_quantity = 10;
  // 单位
  string base_unit = 11;
  // 上次价格修改日期 (原: ZKDAT)
  google.protobuf.Timestamp last_price_change_date = 12;
  // 价格确定日期 (原: PEINH)
  google.protobuf.Timestamp price_determination_date = 13;
}

// ============================================================================
// RPC 消息定义
// ============================================================================

// 获取库存概览请求
message GetStockOverviewRequest {
  // 物料编号
  string material = 1;
  // 工厂
  string plant = 2;
}

// 获取库存概览响应
message GetStockOverviewResponse {
  // 物料编号
  string material = 1;
  // 库存级别列表
  repeated StockLevel stock_levels = 2;
}

// 过账库存移动请求
message PostStockMovementRequest {
  // 移动抬头
  StockMovementHeader header = 1;
  // 移动行项目
  repeated StockMovementItem items = 2;
}

// 库存移动响应
message StockMovementResponse {
  // 操作是否成功
  bool success = 1;
  // 生成的物料凭证引用
  enterprise.common.SystemDocumentReference material_document = 2;
  // 从核心ERP返回的消息列表
  repeated enterprise.common.ApiMessage messages = 3;
}

// 创建物理盘点凭证请求
message CreatePIDocumentRequest {
  // 工厂
  string plant = 1;
  // 存储地点
  string storage_location = 2;
  // 计划盘点日期
  google.protobuf.Timestamp planned_count_date = 3;
  // 要盘点的物料列表 (如果为空，则盘点整个存储地点)
  repeated string materials = 4;
}

// 物理盘点凭证响应
message PIDocumentResponse {
  // 操作是否成功
  bool success = 1;
  // 生成的盘点凭证号
  string document_number = 2;
  // 会计年度
  int32 fiscal_year = 3;
}

// 输入盘点数量请求 (参考: ISEG)
message EnterInventoryCountRequest {
  // 盘点凭证号
  string document_number = 1;
  // 会计年度
  int32 fiscal_year = 2;
  // 盘点数量列表
  repeated InventoryCountItem items = 3;
}

message InventoryCountItem {
  // 物料编号
  string material = 1;
  // 盘点数量 (原: MENGE)
  string counted_quantity = 2;
  // 单位 (原: MEINS)
  string unit = 3;
}

// 输入盘点数量响应
message EnterInventoryCountResponse {
  // 操作是否成功
  bool success = 1;
  // 从核心ERP返回的消息列表
  repeated enterprise.common.ApiMessage messages = 2;
}

// 过账盘点差异请求
message PostInventoryDifferenceRequest {
  // 盘点凭证号
  string document_number = 1;
  // 会计年度
  int32 fiscal_year = 2;
  // 过账日期
  google.protobuf.Timestamp posting_date = 3;
}

// --------------------------------------------------------------------------
// 库存查询消息 (Stock Query Messages)
// --------------------------------------------------------------------------

// 获取详细库存请求
message GetDetailedStockRequest {
  // 物料编号
  string material = 1;
  // 工厂
  string plant = 2;
  // 存储地点 (可选)
  string storage_location = 3;
  // 批次号 (可选)
  string batch = 4;
  // 特殊库存类型 (可选)
  SpecialStockType special_stock_type = 5;
  // 特殊库存编号 (可选)
  string special_stock_number = 6;
}

// 获取详细库存响应
message GetDetailedStockResponse {
  // 物料编号
  string material = 1;
  // 详细库存记录列表
  repeated DetailedStockRecord stock_records = 2;
}

// 详细库存记录
message DetailedStockRecord {
  // 工厂
  string plant = 1;
  // 存储地点
  string storage_location = 2;
  // 批次号
  string batch = 3;
  // 库存类型
  StockType stock_type = 4;
  // 特殊库存类型
  SpecialStockType special_stock_type = 5;
  // 特殊库存编号
  string special_stock_number = 6;
  // 数量
  string quantity = 7;
  // 单位
  string unit = 8;
  // 评估类型
  string valuation_type = 9;
  // 上次移动日期
  google.protobuf.Timestamp last_movement_date = 10;
}

// 获取批次库存请求
message GetBatchStockRequest {
  // 物料编号
  string material = 1;
  // 工厂
  string plant = 2;
  // 批次号 (可选，为空则返回所有批次)
  string batch = 3;
  // 存储地点 (可选)
  string storage_location = 4;
}

// 获取批次库存响应
message GetBatchStockResponse {
  // 物料编号
  string material = 1;
  // 批次库存列表
  repeated BatchStockRecord batch_stocks = 2;
}

// 批次库存记录
message BatchStockRecord {
  // 批次号
  string batch = 1;
  // 工厂
  string plant = 2;
  // 存储地点
  string storage_location = 3;
  // 批次状态
  BatchStatus status = 4;
  // 非限制使用库存
  string unrestricted_stock = 5;
  // 质检库存
  string quality_inspection_stock = 6;
  // 冻结库存
  string blocked_stock = 7;
  // 单位
  string unit = 8;
  // 生产日期
  google.protobuf.Timestamp production_date = 9;
  // 保质期到期日期
  google.protobuf.Timestamp expiration_date = 10;
  // 供应商批次号
  string vendor_batch = 11;
}

// 获取特殊库存请求
message GetSpecialStockRequest {
  // 物料编号
  string material = 1;
  // 工厂
  string plant = 2;
  // 特殊库存类型
  SpecialStockType special_stock_type = 3;
  // 特殊库存编号 (如销售订单号、项目号)
  string special_stock_number = 4;
}

// 获取特殊库存响应
message GetSpecialStockResponse {
  // 物料编号
  string material = 1;
  // 特殊库存记录列表
  repeated SpecialStockRecord special_stocks = 2;
}

// 特殊库存记录
message SpecialStockRecord {
  // 特殊库存类型
  SpecialStockType special_stock_type = 1;
  // 特殊库存编号
  string special_stock_number = 2;
  // 工厂
  string plant = 3;
  // 存储地点
  string storage_location = 4;
  // 非限制使用库存
  string unrestricted_stock = 5;
  // 质检库存
  string quality_inspection_stock = 6;
  // 单位
  string unit = 7;
  // 客户/供应商编号
  string partner = 8;
}

// 库存可用性检查请求 (ATP)
message CheckStockAvailabilityRequest {
  // 物料编号
  string material = 1;
  // 工厂
  string plant = 2;
  // 需求数量
  string required_quantity = 3;
  // 需求日期
  google.protobuf.Timestamp requirement_date = 4;
  // 检查范围 (例如: 001=当前工厂, 002=所有工厂)
  string checking_rule = 5;
}

// 库存可用性响应
message StockAvailabilityResponse {
  // 是否可用
  bool is_available = 1;
  // 可用数量
  string available_quantity = 2;
  // 单位
  string unit = 3;
  // 最早可用日期
  google.protobuf.Timestamp earliest_availability_date = 4;
  // ATP明细列表
  repeated ATPDetail atp_details = 5;
  // 消息列表
  repeated enterprise.common.ApiMessage messages = 6;
}

// ATP明细
message ATPDetail {
  // 日期
  google.protobuf.Timestamp date = 1;
  // 收货数量
  string receipt_quantity = 2;
  // 发货数量
  string issue_quantity = 3;
  // 累计可用数量
  string cumulative_quantity = 4;
}

// 获取物料凭证请求
message GetMaterialDocumentRequest {
  // 物料凭证号
  string document_number = 1;
  // 物料凭证年度
  int32 document_year = 2;
}

// 查询物料凭证列表请求
message ListMaterialDocumentsRequest {
  // 工厂
  string plant = 1;
  // 过账日期范围
  enterprise.common.DateRange posting_date_range = 2;
  // 物料编号 (可选)
  string material = 3;
  // 移动类型 (可选)
  string movement_type = 4;
  // 创建人 (可选)
  string created_by = 5;
  // 分页请求
  enterprise.common.PaginationRequest pagination = 6;
}

// 查询物料凭证列表响应
message ListMaterialDocumentsResponse {
  // 物料凭证摘要列表
  repeated MaterialDocumentSummary documents = 1;
  // 分页响应
  enterprise.common.PaginationResponse pagination = 2;
}

// 物料凭证摘要
message MaterialDocumentSummary {
  // 物料凭证号
  string document_number = 1;
  // 物料凭证年度
  int32 document_year = 2;
  // 过账日期
  google.protobuf.Timestamp posting_date = 3;
  // 凭证日期
  google.protobuf.Timestamp document_date = 4;
  // 抬头文本
  string header_text = 5;
  // 创建人
  string created_by = 6;
  // 凭证状态
  MaterialDocumentStatus status = 7;
  // 行项目数量
  int32 item_count = 8;
}

// 获取物料移动历史请求
message GetMaterialMovementHistoryRequest {
  // 物料编号
  string material = 1;
  // 工厂
  string plant = 2;
  // 存储地点 (可选)
  string storage_location = 3;
  // 批次 (可选)
  string batch = 4;
  // 日期范围
  enterprise.common.DateRange date_range = 5;
  // 移动类型类别 (可选)
  MovementTypeCategory movement_category = 6;
  // 分页请求
  enterprise.common.PaginationRequest pagination = 7;
}

// 物料移动历史响应
message MaterialMovementHistoryResponse {
  // 物料编号
  string material = 1;
  // 移动历史列表
  repeated MaterialMovementHistoryEntry movements = 2;
  // 分页响应
  enterprise.common.PaginationResponse pagination = 3;
}

// 物料移动历史条目
message MaterialMovementHistoryEntry {
  // 物料凭证号
  string document_number = 1;
  // 物料凭证年度
  int32 document_year = 2;
  // 行项目号
  string line_item_number = 3;
  // 过账日期
  google.protobuf.Timestamp posting_date = 4;
  // 移动类型
  string movement_type = 5;
  // 移动类型类别
  MovementTypeCategory movement_category = 6;
  // 数量
  string quantity = 7;
  // 单位
  string unit = 8;
  // 收货/发货标识
  string receipt_issue_indicator = 9;
  // 工厂
  string plant = 10;
  // 存储地点
  string storage_location = 11;
  // 批次
  string batch = 12;
  // 行项目文本
  string item_text = 13;
  // 参考凭证
  string reference_document = 14;
}

// --------------------------------------------------------------------------
// 库存移动消息 (Stock Movement Messages)
// --------------------------------------------------------------------------

// 批量过账库存移动请求
message BatchPostStockMovementsRequest {
  // 移动列表
  repeated PostStockMovementRequest movements = 1;
  // 是否为测试运行
  bool test_run = 2;
}

// 批量库存移动响应
message BatchStockMovementResponse {
  // 批量操作结果统计
  enterprise.common.BatchOperationResult result = 1;
  // 各个移动的响应详情
  repeated StockMovementResponse responses = 2;
}

// 冲销物料凭证请求
message ReverseMaterialDocumentRequest {
  // 要冲销的物料凭证号
  string document_number = 1;
  // 物料凭证年度
  int32 document_year = 2;
  // 冲销过账日期
  google.protobuf.Timestamp posting_date = 3;
  // 冲销原因代码
  string reason_code = 4;
}

// 取消物料凭证请求
message CancelMaterialDocumentRequest {
  // 要取消的物料凭证号
  string document_number = 1;
  // 物料凭证年度
  int32 document_year = 2;
}

// 取消物料凭证响应
message CancelMaterialDocumentResponse {
  // 操作是否成功
  bool success = 1;
  // 消息列表
  repeated enterprise.common.ApiMessage messages = 2;
}

// --------------------------------------------------------------------------
// 批次管理消息 (Batch Management Messages)
// --------------------------------------------------------------------------

// 创建批次请求
message CreateBatchRequest {
  // 物料编号
  string material = 1;
  // 批次号 (如果为空，系统自动生成)
  string batch = 2;
  // 工厂
  string plant = 3;
  // 生产日期
  google.protobuf.Timestamp production_date = 4;
  // 保质期到期日期
  google.protobuf.Timestamp shelf_life_expiration_date = 5;
  // 供应商批次号 (可选)
  string vendor_batch = 6;
  // 供应商 (可选)
  string vendor = 7;
  // 批次特性列表
  repeated BatchCharacteristic characteristics = 8;
}

// 创建批次响应
message CreateBatchResponse {
  // 操作是否成功
  bool success = 1;
  // 生成的批次号
  string batch = 2;
  // 消息列表
  repeated enterprise.common.ApiMessage messages = 3;
}

// 获取批次详情请求
message GetBatchDetailsRequest {
  // 物料编号
  string material = 1;
  // 批次号
  string batch = 2;
  // 工厂
  string plant = 3;
}

// 查询批次列表请求
message ListBatchesRequest {
  // 物料编号
  string material = 1;
  // 工厂
  string plant = 2;
  // 批次状态 (可选)
  BatchStatus status = 3;
  // 生产日期范围 (可选)
  enterprise.common.DateRange production_date_range = 4;
  // 到期日期范围 (可选)
  enterprise.common.DateRange expiration_date_range = 5;
  // 分页请求
  enterprise.common.PaginationRequest pagination = 6;
}

// 查询批次列表响应
message ListBatchesResponse {
  // 批次摘要列表
  repeated BatchSummary batches = 1;
  // 分页响应
  enterprise.common.PaginationResponse pagination = 2;
}

// 批次摘要
message BatchSummary {
  // 物料编号
  string material = 1;
  // 批次号
  string batch = 2;
  // 工厂
  string plant = 3;
  // 批次状态
  BatchStatus status = 4;
  // 可用数量
  string available_quantity = 5;
  // 单位
  string unit = 6;
  // 生产日期
  google.protobuf.Timestamp production_date = 7;
  // 保质期到期日期
  google.protobuf.Timestamp expiration_date = 8;
  // 供应商批次号
  string vendor_batch = 9;
}

// 更新批次特性请求
message UpdateBatchCharacteristicsRequest {
  // 物料编号
  string material = 1;
  // 批次号
  string batch = 2;
  // 工厂
  string plant = 3;
  // 要更新的批次特性列表
  repeated BatchCharacteristic characteristics = 4;
}

// 更新批次特性响应
message UpdateBatchCharacteristicsResponse {
  // 操作是否成功
  bool success = 1;
  // 消息列表
  repeated enterprise.common.ApiMessage messages = 2;
}

// 修改批次状态请求
message ChangeBatchStatusRequest {
  // 物料编号
  string material = 1;
  // 批次号
  string batch = 2;
  // 工厂
  string plant = 3;
  // 新状态
  BatchStatus new_status = 4;
  // 状态修改原因
  string reason = 5;
}

// 修改批次状态响应
message ChangeBatchStatusResponse {
  // 操作是否成功
  bool success = 1;
  // 消息列表
  repeated enterprise.common.ApiMessage messages = 2;
}

// 批次确定请求
message DetermineBatchRequest {
  // 物料编号
  string material = 1;
  // 工厂
  string plant = 2;
  // 存储地点
  string storage_location = 3;
  // 需求数量
  string required_quantity = 4;
  // 需求日期
  google.protobuf.Timestamp requirement_date = 5;
  // 批次选择策略 (例如: FIFO, FEFO, LIFO)
  string selection_strategy = 6;
}

// 批次确定响应
message DetermineBatchResponse {
  // 操作是否成功
  bool success = 1;
  // 建议的批次列表
  repeated BatchProposal batch_proposals = 2;
  // 消息列表
  repeated enterprise.common.ApiMessage messages = 3;
}

// 批次建议
message BatchProposal {
  // 批次号
  string batch = 1;
  // 建议数量
  string proposed_quantity = 2;
  // 可用数量
  string available_quantity = 3;
  // 存储地点
  string storage_location = 4;
  // 生产日期
  google.protobuf.Timestamp production_date = 5;
  // 保质期到期日期
  google.protobuf.Timestamp expiration_date = 6;
}

// 批次追溯请求
message TraceBatchUsageRequest {
  // 物料编号
  string material = 1;
  // 批次号
  string batch = 2;
  // 工厂
  string plant = 3;
  // 追溯方向 (FORWARD: 去向追溯, BACKWARD: 来源追溯)
  string trace_direction = 4;
  // 追溯层级深度
  int32 trace_depth = 5;
}

// 批次使用追溯响应
message BatchUsageTraceResponse {
  // 操作是否成功
  bool success = 1;
  // 追溯树根节点
  BatchTraceNode root_node = 2;
  // 消息列表
  repeated enterprise.common.ApiMessage messages = 3;
}

// 批次追溯节点
message BatchTraceNode {
  // 物料编号
  string material = 1;
  // 批次号
  string batch = 2;
  // 工厂
  string plant = 3;
  // 数量
  string quantity = 4;
  // 单位
  string unit = 5;
  // 凭证号
  string document_number = 6;
  // 过账日期
  google.protobuf.Timestamp posting_date = 7;
  // 子节点列表
  repeated BatchTraceNode child_nodes = 8;
}

// --------------------------------------------------------------------------
// 序列号管理消息 (Serial Number Management Messages)
// --------------------------------------------------------------------------

// 创建序列号请求
message CreateSerialNumbersRequest {
  // 物料编号
  string material = 1;
  // 序列号列表 (如果为空，系统自动生成)
  repeated string serial_numbers = 2;
  // 工厂
  string plant = 3;
  // 生产日期
  google.protobuf.Timestamp production_date = 4;
  // 供应商 (可选)
  string vendor = 5;
}

// 创建序列号响应
message CreateSerialNumbersResponse {
  // 操作是否成功
  bool success = 1;
  // 生成的序列号列表
  repeated string serial_numbers = 2;
  // 消息列表
  repeated enterprise.common.ApiMessage messages = 3;
}

// 获取序列号详情请求
message GetSerialNumberDetailsRequest {
  // 物料编号
  string material = 1;
  // 序列号
  string serial_number = 2;
}

// 查询序列号列表请求
message ListSerialNumbersRequest {
  // 物料编号
  string material = 1;
  // 工厂 (可选)
  string plant = 2;
  // 序列号状态 (可选)
  SerialNumberStatus status = 3;
  // 客户 (可选)
  string customer = 4;
  // 设备号 (可选)
  string equipment_number = 5;
  // 分页请求
  enterprise.common.PaginationRequest pagination = 6;
}

// 查询序列号列表响应
message ListSerialNumbersResponse {
  // 序列号摘要列表
  repeated SerialNumberSummary serial_numbers = 1;
  // 分页响应
  enterprise.common.PaginationResponse pagination = 2;
}

// 序列号摘要
message SerialNumberSummary {
  // 物料编号
  string material = 1;
  // 序列号
  string serial_number = 2;
  // 序列号状态
  SerialNumberStatus status = 3;
  // 工厂
  string plant = 4;
  // 存储地点
  string storage_location = 5;
  // 客户
  string customer = 6;
  // 设备号
  string equipment_number = 7;
  // 生产日期
  google.protobuf.Timestamp production_date = 8;
}

// 修改序列号状态请求
message ChangeSerialNumberStatusRequest {
  // 物料编号
  string material = 1;
  // 序列号
  string serial_number = 2;
  // 新状态
  SerialNumberStatus new_status = 3;
  // 状态修改原因
  string reason = 4;
}

// 修改序列号状态响应
message ChangeSerialNumberStatusResponse {
  // 操作是否成功
  bool success = 1;
  // 消息列表
  repeated enterprise.common.ApiMessage messages = 2;
}

// 序列号追溯请求
message TraceSerialNumberRequest {
  // 物料编号
  string material = 1;
  // 序列号
  string serial_number = 2;
  // 追溯方向 (FORWARD: 去向追溯, BACKWARD: 来源追溯)
  string trace_direction = 3;
}

// 序列号追溯响应
message SerialNumberTraceResponse {
  // 操作是否成功
  bool success = 1;
  // 序列号历史轨迹
  repeated SerialNumberHistory history = 2;
  // 消息列表
  repeated enterprise.common.ApiMessage messages = 3;
}

// --------------------------------------------------------------------------
// 物理盘点消息 (Physical Inventory Messages)
// --------------------------------------------------------------------------

// 重新盘点请求
message ReCountInventoryRequest {
  // 盘点凭证号
  string document_number = 1;
  // 会计年度
  int32 fiscal_year = 2;
  // 要重新盘点的物料列表 (如果为空，则重新盘点全部)
  repeated string materials = 3;
}

// 重新盘点响应
message ReCountInventoryResponse {
  // 操作是否成功
  bool success = 1;
  // 消息列表
  repeated enterprise.common.ApiMessage messages = 2;
}

// 查询盘点凭证列表请求
message ListPIDocumentsRequest {
  // 工厂
  string plant = 1;
  // 存储地点 (可选)
  string storage_location = 2;
  // 盘点状态 (可选)
  PhysicalInventoryStatus status = 3;
  // 计划盘点日期范围 (可选)
  enterprise.common.DateRange planned_date_range = 4;
  // 创建人 (可选)
  string created_by = 5;
  // 分页请求
  enterprise.common.PaginationRequest pagination = 6;
}

// 查询盘点凭证列表响应
message ListPIDocumentsResponse {
  // 盘点凭证摘要列表
  repeated PIDocumentSummary documents = 1;
  // 分页响应
  enterprise.common.PaginationResponse pagination = 2;
}

// 盘点凭证摘要
message PIDocumentSummary {
  // 盘点凭证号
  string document_number = 1;
  // 会计年度
  int32 fiscal_year = 2;
  // 工厂
  string plant = 3;
  // 存储地点
  string storage_location = 4;
  // 盘点状态
  PhysicalInventoryStatus status = 5;
  // 计划盘点日期
  google.protobuf.Timestamp planned_count_date = 6;
  // 实际盘点日期
  google.protobuf.Timestamp actual_count_date = 7;
  // 创建人
  string created_by = 8;
  // 盘点人
  string counted_by = 9;
  // 物料数量
  int32 item_count = 10;
}

// 获取盘点差异报表请求
message GetInventoryDifferenceReportRequest {
  // 盘点凭证号
  string document_number = 1;
  // 会计年度
  int32 fiscal_year = 2;
  // 差异阈值 (可选，只显示差异大于此值的项目)
  string difference_threshold = 3;
}

// 盘点差异报表响应
message InventoryDifferenceReportResponse {
  // 盘点凭证号
  string document_number = 1;
  // 会计年度
  int32 fiscal_year = 2;
  // 差异明细列表
  repeated InventoryDifferenceItem difference_items = 3;
  // 差异汇总
  InventoryDifferenceSummary summary = 4;
}

// 盘点差异项目
message InventoryDifferenceItem {
  // 物料编号
  string material = 1;
  // 物料描述
  string material_description = 2;
  // 批次号
  string batch = 3;
  // 账面数量
  string book_quantity = 4;
  // 盘点数量
  string counted_quantity = 5;
  // 差异数量
  string difference_quantity = 6;
  // 差异百分比
  string difference_percentage = 7;
  // 单位
  string unit = 8;
  // 差异金额
  string difference_value = 9;
  // 货币
  string currency = 10;
}

// 盘点差异汇总
message InventoryDifferenceSummary {
  // 总盘点项目数
  int32 total_items = 1;
  // 有差异的项目数
  int32 items_with_difference = 2;
  // 盈余项目数
  int32 surplus_items = 3;
  // 亏损项目数
  int32 deficit_items = 4;
  // 总差异金额
  string total_difference_value = 5;
  // 货币
  string currency = 6;
}

// 循环盘点管理请求
message ManageCycleCountingRequest {
  // 操作类型 (CREATE: 创建计划, EXECUTE: 执行计划, UPDATE: 更新计划)
  string operation = 1;
  // 工厂
  string plant = 2;
  // 存储地点
  string storage_location = 3;
  // 循环盘点计划ID (更新或执行时需要)
  string cycle_count_plan_id = 4;
  // ABC指示符 (可选，用于创建计划)
  ABCIndicator abc_indicator = 5;
  // 盘点频率 (可选，用于创建计划) - 例如: 每月、每季度
  string counting_frequency = 6;
}

// 循环盘点管理响应
message ManageCycleCountingResponse {
  // 操作是否成功
  bool success = 1;
  // 循环盘点计划ID
  string cycle_count_plan_id = 2;
  // 生成的盘点凭证号 (执行时)
  string pi_document_number = 3;
  // 消息列表
  repeated enterprise.common.ApiMessage messages = 4;
}

// --------------------------------------------------------------------------
// 库存预留消息 (Stock Reservation Messages)
// --------------------------------------------------------------------------

// 创建库存预留请求
message CreateReservationRequest {
  // 预留类型
  string reservation_type = 1;
  // 工厂
  string plant = 2;
  // 移动类型
  string movement_type = 3;
  // 需求日期
  google.protobuf.Timestamp requirement_date = 4;
  // 成本中心 (可选)
  string cost_center = 5;
  // 订单号 (可选)
  string order_number = 6;
  // WBS元素 (可选)
  string wbs_element = 7;
  // 预留项目列表
  repeated ReservationItem items = 8;
}

// 预留项目
message ReservationItem {
  // 物料编号
  string material = 1;
  // 需求数量
  string requirement_quantity = 2;
  // 单位
  string unit = 3;
  // 存储地点
  string storage_location = 4;
  // 批次 (可选)
  string batch = 5;
}

// 预留响应
message ReservationResponse {
  // 操作是否成功
  bool success = 1;
  // 预留号
  string reservation_number = 2;
  // 消息列表
  repeated enterprise.common.ApiMessage messages = 3;
}

// 修改库存预留请求
message UpdateReservationRequest {
  // 预留号
  string reservation_number = 1;
  // 要更新的项目列表
  repeated ReservationItemUpdate items = 2;
}

// 预留项目更新
message ReservationItemUpdate {
  // 预留行项目号
  string reservation_item = 1;
  // 新的需求数量
  string requirement_quantity = 2;
  // 新的需求日期
  google.protobuf.Timestamp requirement_date = 3;
}

// 删除库存预留请求
message DeleteReservationRequest {
  // 预留号
  string reservation_number = 1;
  // 删除原因
  string deletion_reason = 2;
}

// 删除库存预留响应
message DeleteReservationResponse {
  // 操作是否成功
  bool success = 1;
  // 消息列表
  repeated enterprise.common.ApiMessage messages = 2;
}

// 查询预留列表请求
message ListReservationsRequest {
  // 工厂
  string plant = 1;
  // 物料编号 (可选)
  string material = 2;
  // 预留状态 (可选)
  ReservationStatus status = 3;
  // 需求日期范围 (可选)
  enterprise.common.DateRange requirement_date_range = 4;
  // 成本中心 (可选)
  string cost_center = 5;
  // 订单号 (可选)
  string order_number = 6;
  // 分页请求
  enterprise.common.PaginationRequest pagination = 7;
}

// 查询预留列表响应
message ListReservationsResponse {
  // 预留摘要列表
  repeated ReservationSummary reservations = 1;
  // 分页响应
  enterprise.common.PaginationResponse pagination = 2;
}

// 预留摘要
message ReservationSummary {
  // 预留号
  string reservation_number = 1;
  // 预留状态
  ReservationStatus status = 2;
  // 工厂
  string plant = 3;
  // 需求日期
  google.protobuf.Timestamp requirement_date = 4;
  // 成本中心
  string cost_center = 5;
  // 订单号
  string order_number = 6;
  // 创建日期
  google.protobuf.Timestamp created_date = 7;
  // 创建人
  string created_by = 8;
  // 项目数量
  int32 item_count = 9;
}

// 预留发货请求
message IssueReservationRequest {
  // 预留号
  string reservation_number = 1;
  // 预留行项目号
  string reservation_item = 2;
  // 发货数量
  string issue_quantity = 3;
  // 过账日期
  google.protobuf.Timestamp posting_date = 4;
  // 批次 (可选)
  string batch = 5;
}

// --------------------------------------------------------------------------
// 库存转储消息 (Stock Transfer Messages)
// --------------------------------------------------------------------------

// 创建转储订单请求
message CreateStockTransferOrderRequest {
  // 发出工厂
  string issuing_plant = 1;
  // 发出存储地点
  string issuing_storage_location = 2;
  // 接收工厂
  string receiving_plant = 3;
  // 接收存储地点
  string receiving_storage_location = 4;
  // 转储类型 (例如: 同工厂转储, 跨工厂转储)
  string transfer_type = 5;
  // 交货日期
  google.protobuf.Timestamp delivery_date = 6;
  // 转储项目列表
  repeated StockTransferItem items = 7;
}

// 转储项目
message StockTransferItem {
  // 物料编号
  string material = 1;
  // 转储数量
  string transfer_quantity = 2;
  // 单位
  string unit = 3;
  // 批次 (可选)
  string batch = 4;
}

// 转储订单响应
message StockTransferOrderResponse {
  // 操作是否成功
  bool success = 1;
  // 转储订单号
  string transfer_order_number = 2;
  // 消息列表
  repeated enterprise.common.ApiMessage messages = 3;
}

// 过账转储请求
message PostStockTransferRequest {
  // 转储订单号
  string transfer_order_number = 1;
  // 过账日期
  google.protobuf.Timestamp posting_date = 2;
  // 移动类型 (例如: 311-发货, 312-收货)
  string movement_type = 3;
}

// 跨工厂转储请求
message PostInterPlantTransferRequest {
  // 发出工厂
  string issuing_plant = 1;
  // 发出存储地点
  string issuing_storage_location = 2;
  // 接收工厂
  string receiving_plant = 3;
  // 接收存储地点
  string receiving_storage_location = 4;
  // 物料编号
  string material = 5;
  // 转储数量
  string transfer_quantity = 6;
  // 单位
  string unit = 7;
  // 批次 (可选)
  string batch = 8;
  // 过账日期
  google.protobuf.Timestamp posting_date = 9;
  // 移动类型
  string movement_type = 10;
}

// 跨工厂转储响应
message InterPlantTransferResponse {
  // 操作是否成功
  bool success = 1;
  // 发货物料凭证
  enterprise.common.SystemDocumentReference issue_document = 2;
  // 收货物料凭证
  enterprise.common.SystemDocumentReference receipt_document = 3;
  // 消息列表
  repeated enterprise.common.ApiMessage messages = 4;
}

// --------------------------------------------------------------------------
// 库存评估消息 (Stock Valuation Messages)
// --------------------------------------------------------------------------

// 获取库存价值请求
message GetStockValuationRequest {
  // 物料编号
  string material = 1;
  // 评估范围/工厂
  string valuation_area = 2;
  // 评估类型 (可选)
  string valuation_type = 3;
}

// 库存价值响应
message StockValuationResponse {
  // 库存评估数据
  StockValuationData valuation_data = 1;
  // 消息列表
  repeated enterprise.common.ApiMessage messages = 2;
}

// 库存价格修改请求
message ChangeStockPriceRequest {
  // 物料编号
  string material = 1;
  // 评估范围/工厂
  string valuation_area = 2;
  // 评估类型
  string valuation_type = 3;
  // 新价格
  string new_price = 4;
  // 价格类型 (S: 标准价格, V: 移动平均价)
  string price_type = 5;
  // 价格修改日期
  google.protobuf.Timestamp price_change_date = 6;
}

// 库存价格修改响应
message ChangeStockPriceResponse {
  // 操作是否成功
  bool success = 1;
  // 旧价格
  string old_price = 2;
  // 新价格
  string new_price = 3;
  // 价格差异影响的金额
  string price_difference_amount = 4;
  // 消息列表
  repeated enterprise.common.ApiMessage messages = 5;
}

// 物料分割评估请求
message SplitValuationRequest {
  // 物料编号
  string material = 1;
  // 评估范围/工厂
  string valuation_area = 2;
  // 操作类型 (CREATE: 创建分割, DELETE: 删除分割)
  string operation = 3;
  // 评估类型
  string valuation_type = 4;
  // 分割后的价格 (创建时需要)
  string price = 5;
}

// 物料分割评估响应
message SplitValuationResponse {
  // 操作是否成功
  bool success = 1;
  // 消息列表
  repeated enterprise.common.ApiMessage messages = 2;
}

// --------------------------------------------------------------------------
// 高级功能消息 (Advanced Features Messages)
// --------------------------------------------------------------------------

// 库存老化分析请求
message AnalyzeStockAgingRequest {
  // 工厂
  string plant = 1;
  // 存储地点 (可选)
  string storage_location = 2;
  // 物料编号 (可选)
  string material = 3;
  // 截止日期
  google.protobuf.Timestamp cutoff_date = 4;
  // 老化区间 (天数列表，例如: [30, 60, 90, 180])
  repeated int32 aging_buckets = 5;
}

// 库存老化分析响应
message StockAgingAnalysisResponse {
  // 操作是否成功
  bool success = 1;
  // 老化分析结果列表
  repeated StockAgingResult aging_results = 2;
  // 汇总信息
  StockAgingSummary summary = 3;
  // 消息列表
  repeated enterprise.common.ApiMessage messages = 4;
}

// 库存老化结果
message StockAgingResult {
  // 物料编号
  string material = 1;
  // 物料描述
  string material_description = 2;
  // 批次号
  string batch = 3;
  // 工厂
  string plant = 4;
  // 存储地点
  string storage_location = 5;
  // 库存数量
  string quantity = 6;
  // 单位
  string unit = 7;
  // 上次移动日期
  google.protobuf.Timestamp last_movement_date = 8;
  // 老化天数
  int32 aging_days = 9;
  // 老化区间
  string aging_bucket = 10;
  // 库存价值
  string stock_value = 11;
  // 货币
  string currency = 12;
}

// 库存老化汇总
message StockAgingSummary {
  // 总库存价值
  string total_stock_value = 1;
  // 货币
  string currency = 2;
  // 按老化区间汇总
  repeated AgingBucketSummary aging_bucket_summaries = 3;
}

// 老化区间汇总
message AgingBucketSummary {
  // 老化区间描述 (例如: "0-30天", "31-60天")
  string bucket_description = 1;
  // 该区间的库存数量
  string quantity = 2;
  // 该区间的库存价值
  string stock_value = 3;
  // 百分比
  string percentage = 4;
}

// 呆滞库存分析请求
message AnalyzeSlowMovingStockRequest {
  // 工厂
  string plant = 1;
  // 存储地点 (可选)
  string storage_location = 2;
  // 物料编号 (可选)
  string material = 3;
  // 分析期间
  enterprise.common.DateRange analysis_period = 4;
  // 呆滞阈值 (天数，例如: 90天内无移动视为呆滞)
  int32 slow_moving_threshold_days = 5;
}

// 呆滞库存分析响应
message SlowMovingStockAnalysisResponse {
  // 操作是否成功
  bool success = 1;
  // 呆滞库存列表
  repeated SlowMovingStockItem slow_moving_items = 2;
  // 汇总信息
  SlowMovingStockSummary summary = 3;
  // 消息列表
  repeated enterprise.common.ApiMessage messages = 4;
}

// 呆滞库存项目
message SlowMovingStockItem {
  // 物料编号
  string material = 1;
  // 物料描述
  string material_description = 2;
  // 工厂
  string plant = 3;
  // 存储地点
  string storage_location = 4;
  // 库存数量
  string quantity = 5;
  // 单位
  string unit = 6;
  // 上次移动日期
  google.protobuf.Timestamp last_movement_date = 7;
  // 无移动天数
  int32 days_without_movement = 8;
  // 库存价值
  string stock_value = 9;
  // 货币
  string currency = 10;
  // ABC指示符
  ABCIndicator abc_indicator = 11;
}

// 呆滞库存汇总
message SlowMovingStockSummary {
  // 呆滞库存总项数
  int32 total_slow_moving_items = 1;
  // 呆滞库存总价值
  string total_slow_moving_value = 2;
  // 货币
  string currency = 3;
  // 呆滞库存占总库存价值百分比
  string percentage_of_total_stock = 4;
}

// 库存周转率分析请求
message AnalyzeStockTurnoverRequest {
  // 工厂
  string plant = 1;
  // 存储地点 (可选)
  string storage_location = 2;
  // 物料编号 (可选)
  string material = 3;
  // 分析期间
  enterprise.common.DateRange analysis_period = 4;
}

// 库存周转率分析响应
message StockTurnoverAnalysisResponse {
  // 操作是否成功
  bool success = 1;
  // 周转率分析结果列表
  repeated StockTurnoverResult turnover_results = 2;
  // 汇总信息
  StockTurnoverSummary summary = 3;
  // 消息列表
  repeated enterprise.common.ApiMessage messages = 4;
}

// 库存周转率结果
message StockTurnoverResult {
  // 物料编号
  string material = 1;
  // 物料描述
  string material_description = 2;
  // 工厂
  string plant = 3;
  // 期初库存
  string opening_stock = 4;
  // 期末库存
  string closing_stock = 5;
  // 平均库存
  string average_stock = 6;
  // 期间消耗总量
  string total_consumption = 7;
  // 单位
  string unit = 8;
  // 周转率 (次数)
  string turnover_ratio = 9;
  // 周转天数
  string turnover_days = 10;
  // ABC指示符
  ABCIndicator abc_indicator = 11;
}

// 库存周转率汇总
message StockTurnoverSummary {
  // 平均周转率
  string average_turnover_ratio = 1;
  // 平均周转天数
  string average_turnover_days = 2;
  // 总库存价值
  string total_stock_value = 3;
  // 货币
  string currency = 4;
}

// 安全库存检查请求
message CheckSafetyStockRequest {
  // 工厂
  string plant = 1;
  // 存储地点 (可选)
  string storage_location = 2;
  // 物料编号 (可选)
  string material = 3;
}

// 安全库存检查响应
message SafetyStockCheckResponse {
  // 操作是否成功
  bool success = 1;
  // 低于安全库存的项目列表
  repeated SafetyStockViolation violations = 2;
  // 汇总信息
  SafetyStockCheckSummary summary = 3;
  // 消息列表
  repeated enterprise.common.ApiMessage messages = 4;
}

// 安全库存违规
message SafetyStockViolation {
  // 物料编号
  string material = 1;
  // 物料描述
  string material_description = 2;
  // 工厂
  string plant = 3;
  // 存储地点
  string storage_location = 4;
  // 当前库存
  string current_stock = 5;
  // 安全库存
  string safety_stock = 6;
  // 短缺数量
  string shortage_quantity = 7;
  // 单位
  string unit = 8;
  // 再订货点
  string reorder_point = 9;
  // ABC指示符
  ABCIndicator abc_indicator = 10;
}

// 安全库存检查汇总
message SafetyStockCheckSummary {
  // 检查的物料总数
  int32 total_materials_checked = 1;
  // 低于安全库存的物料数
  int32 materials_below_safety_stock = 2;
  // 低于再订货点的物料数
  int32 materials_below_reorder_point = 3;
}

// ABC分析请求
message PerformABCAnalysisRequest {
  // 工厂
  string plant = 1;
  // 存储地点 (可选)
  string storage_location = 2;
  // 分析依据 (VALUE: 按价值, CONSUMPTION: 按消耗)
  string analysis_basis = 3;
  // 分析期间
  enterprise.common.DateRange analysis_period = 4;
  // A类阈值百分比 (默认70%)
  string a_threshold_percentage = 5;
  // B类阈值百分比 (默认20%)
  string b_threshold_percentage = 6;
}

// ABC分析响应
message ABCAnalysisResponse {
  // 操作是否成功
  bool success = 1;
  // ABC分析结果列表
  repeated ABCAnalysisResult analysis_results = 2;
  // 汇总信息
  ABCAnalysisSummary summary = 3;
  // 消息列表
  repeated enterprise.common.ApiMessage messages = 4;
}

// ABC分析结果
message ABCAnalysisResult {
  // 物料编号
  string material = 1;
  // 物料描述
  string material_description = 2;
  // 工厂
  string plant = 3;
  // 存储地点
  string storage_location = 4;
  // 库存数量
  string quantity = 5;
  // 单位
  string unit = 6;
  // 单价
  string unit_price = 7;
  // 总价值
  string total_value = 8;
  // 货币
  string currency = 9;
  // 期间消耗量
  string period_consumption = 10;
  // ABC分类
  ABCIndicator abc_classification = 11;
  // 累计百分比
  string cumulative_percentage = 12;
}

// ABC分析汇总
message ABCAnalysisSummary {
  // A类物料数量
  int32 a_class_count = 1;
  // A类物料价值
  string a_class_value = 2;
  // A类物料价值百分比
  string a_class_percentage = 3;
  // B类物料数量
  int32 b_class_count = 4;
  // B类物料价值
  string b_class_value = 5;
  // B类物料价值百分比
  string b_class_percentage = 6;
  // C类物料数量
  int32 c_class_count = 7;
  // C类物料价值
  string c_class_value = 8;
  // C类物料价值百分比
  string c_class_percentage = 9;
  // 总库存价值
  string total_stock_value = 10;
  // 货币
  string currency = 11;
}

// 库存快照请求
message CreateStockSnapshotRequest {
  // 工厂
  string plant = 1;
  // 存储地点 (可选)
  string storage_location = 2;
  // 快照日期
  google.protobuf.Timestamp snapshot_date = 3;
  // 快照描述
  string description = 4;
}

// 库存快照响应
message StockSnapshotResponse {
  // 操作是否成功
  bool success = 1;
  // 快照ID
  string snapshot_id = 2;
  // 快照的记录数
  int32 record_count = 3;
  // 消息列表
  repeated enterprise.common.ApiMessage messages = 4;
}

// 库存对账请求
message ReconcileStockRequest {
  // 工厂
  string plant = 1;
  // 存储地点 (可选)
  string storage_location = 2;
  // 物料编号 (可选)
  string material = 3;
  // 对账期间
  enterprise.common.DateRange reconciliation_period = 4;
}

// 库存对账响应
message StockReconciliationResponse {
  // 操作是否成功
  bool success = 1;
  // 对账结果列表
  repeated StockReconciliationResult results = 2;
  // 汇总信息
  StockReconciliationSummary summary = 3;
  // 消息列表
  repeated enterprise.common.ApiMessage messages = 4;
}

// 库存对账结果
message StockReconciliationResult {
  // 物料编号
  string material = 1;
  // 物料描述
  string material_description = 2;
  // 工厂
  string plant = 3;
  // 存储地点
  string storage_location = 4;
  // 期初库存
  string opening_stock = 5;
  // 期间收货
  string period_receipts = 6;
  // 期间发货
  string period_issues = 7;
  // 计算期末库存 (期初+收货-发货)
  string calculated_closing_stock = 8;
  // 实际期末库存
  string actual_closing_stock = 9;
  // 差异
  string difference = 10;
  // 单位
  string unit = 11;
  // 是否匹配
  bool is_reconciled = 12;
}

// 库存对账汇总
message StockReconciliationSummary {
  // 对账的物料总数
  int32 total_materials = 1;
  // 匹配的物料数
  int32 reconciled_materials = 2;
  // 有差异的物料数
  int32 materials_with_difference = 3;
  // 总差异金额
  string total_difference_value = 4;
  // 货币
  string currency = 5;
}

// ============================================================================
// 新增枚举类型 (Additional Enumerations)
// ============================================================================

// 库存锁定原因枚举
enum StockBlockingReason {
  // 未指定
  STOCK_BLOCKING_REASON_UNSPECIFIED = 0;
  // 质量问题
  STOCK_BLOCKING_REASON_QUALITY_ISSUE = 1;
  // 审计要求
  STOCK_BLOCKING_REASON_AUDIT = 2;
  // 法律纠纷
  STOCK_BLOCKING_REASON_LEGAL_DISPUTE = 3;
  // 过期
  STOCK_BLOCKING_REASON_EXPIRED = 4;
  // 损坏
  STOCK_BLOCKING_REASON_DAMAGED = 5;
  // 其他
  STOCK_BLOCKING_REASON_OTHER = 6;
}

// 库存调整类型枚举
enum StockAdjustmentType {
  // 未指定
  STOCK_ADJUSTMENT_TYPE_UNSPECIFIED = 0;
  // 盘盈
  STOCK_ADJUSTMENT_TYPE_SURPLUS = 1;
  // 盘亏
  STOCK_ADJUSTMENT_TYPE_DEFICIT = 2;
  // 损耗
  STOCK_ADJUSTMENT_TYPE_LOSS = 3;
  // 报废
  STOCK_ADJUSTMENT_TYPE_SCRAP = 4;
  // 调拨
  STOCK_ADJUSTMENT_TYPE_TRANSFER = 5;
  // 其他调整
  STOCK_ADJUSTMENT_TYPE_OTHER = 6;
}

// 库存调整状态枚举
enum StockAdjustmentStatus {
  // 未指定
  STOCK_ADJUSTMENT_STATUS_UNSPECIFIED = 0;
  // 草稿
  STOCK_ADJUSTMENT_STATUS_DRAFT = 1;
  // 待审批
  STOCK_ADJUSTMENT_STATUS_PENDING_APPROVAL = 2;
  // 已审批
  STOCK_ADJUSTMENT_STATUS_APPROVED = 3;
  // 已拒绝
  STOCK_ADJUSTMENT_STATUS_REJECTED = 4;
  // 已过账
  STOCK_ADJUSTMENT_STATUS_POSTED = 5;
  // 已取消
  STOCK_ADJUSTMENT_STATUS_CANCELLED = 6;
}

// 库存预警类型枚举
enum StockAlertType {
  // 未指定
  STOCK_ALERT_TYPE_UNSPECIFIED = 0;
  // 低于安全库存
  STOCK_ALERT_TYPE_BELOW_SAFETY_STOCK = 1;
  // 超储
  STOCK_ALERT_TYPE_OVERSTOCK = 2;
  // 接近过期
  STOCK_ALERT_TYPE_NEAR_EXPIRY = 3;
  // 呆滞库存
  STOCK_ALERT_TYPE_SLOW_MOVING = 4;
  // 库存差异
  STOCK_ALERT_TYPE_VARIANCE = 5;
  // 负库存
  STOCK_ALERT_TYPE_NEGATIVE_STOCK = 6;
  // 自定义预警
  STOCK_ALERT_TYPE_CUSTOM = 7;
}

// 库存预警严重程度枚举
enum StockAlertSeverity {
  // 未指定
  STOCK_ALERT_SEVERITY_UNSPECIFIED = 0;
  // 信息
  STOCK_ALERT_SEVERITY_INFO = 1;
  // 警告
  STOCK_ALERT_SEVERITY_WARNING = 2;
  // 严重
  STOCK_ALERT_SEVERITY_CRITICAL = 3;
  // 紧急
  STOCK_ALERT_SEVERITY_URGENT = 4;
}

// 质检决策枚举
enum QualityInspectionDecision {
  // 未指定
  QUALITY_INSPECTION_DECISION_UNSPECIFIED = 0;
  // 接受/放行
  QUALITY_INSPECTION_DECISION_ACCEPT = 1;
  // 拒收
  QUALITY_INSPECTION_DECISION_REJECT = 2;
  // 让步接收
  QUALITY_INSPECTION_DECISION_CONDITIONAL_ACCEPT = 3;
  // 退货
  QUALITY_INSPECTION_DECISION_RETURN = 4;
  // 报废
  QUALITY_INSPECTION_DECISION_SCRAP = 5;
  // 返工
  QUALITY_INSPECTION_DECISION_REWORK = 6;
}

// 运输状态枚举
enum TransportationStatus {
  // 未指定
  TRANSPORTATION_STATUS_UNSPECIFIED = 0;
  // 已创建
  TRANSPORTATION_STATUS_CREATED = 1;
  // 待装运
  TRANSPORTATION_STATUS_PENDING_SHIPMENT = 2;
  // 已装运
  TRANSPORTATION_STATUS_SHIPPED = 3;
  // 运输中
  TRANSPORTATION_STATUS_IN_TRANSIT = 4;
  // 已到达
  TRANSPORTATION_STATUS_ARRIVED = 5;
  // 已收货
  TRANSPORTATION_STATUS_RECEIVED = 6;
  // 部分收货
  TRANSPORTATION_STATUS_PARTIALLY_RECEIVED = 7;
  // 已取消
  TRANSPORTATION_STATUS_CANCELLED = 8;
}

// 容器类型枚举
enum ContainerType {
  // 未指定
  CONTAINER_TYPE_UNSPECIFIED = 0;
  // 托盘
  CONTAINER_TYPE_PALLET = 1;
  // 纸箱
  CONTAINER_TYPE_CARTON = 2;
  // 集装箱
  CONTAINER_TYPE_SHIPPING_CONTAINER = 3;
  // 料箱
  CONTAINER_TYPE_BIN = 4;
  // 周转箱
  CONTAINER_TYPE_TOTE = 5;
  // 桶
  CONTAINER_TYPE_DRUM = 6;
  // 其他
  CONTAINER_TYPE_OTHER = 7;
}

// 报表类型枚举
enum StockReportType {
  // 未指定
  STOCK_REPORT_TYPE_UNSPECIFIED = 0;
  // 库存余额报表
  STOCK_REPORT_TYPE_BALANCE = 1;
  // 库存移动报表
  STOCK_REPORT_TYPE_MOVEMENT = 2;
  // 库存老化报表
  STOCK_REPORT_TYPE_AGING = 3;
  // 库存周转报表
  STOCK_REPORT_TYPE_TURNOVER = 4;
  // 库存评估报表
  STOCK_REPORT_TYPE_VALUATION = 5;
  // ABC分析报表
  STOCK_REPORT_TYPE_ABC_ANALYSIS = 6;
  // 自定义报表
  STOCK_REPORT_TYPE_CUSTOM = 7;
}

// 导出格式枚举
enum ExportFormat {
  // 未指定
  EXPORT_FORMAT_UNSPECIFIED = 0;
  // Excel
  EXPORT_FORMAT_EXCEL = 1;
  // CSV
  EXPORT_FORMAT_CSV = 2;
  // PDF
  EXPORT_FORMAT_PDF = 3;
  // JSON
  EXPORT_FORMAT_JSON = 4;
  // XML
  EXPORT_FORMAT_XML = 5;
}

// --------------------------------------------------------------------------
// 库存锁定与解冻消息 (Stock Blocking & Unblocking Messages)
// --------------------------------------------------------------------------

// 冻结库存请求
message BlockStockRequest {
  // 物料编号
  string material = 1;
  // 工厂
  string plant = 2;
  // 存储地点
  string storage_location = 3;
  // 批次 (可选)
  string batch = 4;
  // 要冻结的数量
  string quantity_to_block = 5;
  // 单位
  string unit = 6;
  // 冻结原因
  StockBlockingReason blocking_reason = 7;
  // 冻结原因描述
  string blocking_reason_text = 8;
  // 冻结期限 (可选)
  google.protobuf.Timestamp blocking_until = 9;
}

// 冻结库存响应
message BlockStockResponse {
  // 操作是否成功
  bool success = 1;
  // 冻结库存凭证号
  string blocking_document_number = 2;
  // 冻结的数量
  string blocked_quantity = 3;
  // 消息列表
  repeated enterprise.common.ApiMessage messages = 4;
}

// 解冻库存请求
message UnblockStockRequest {
  // 物料编号
  string material = 1;
  // 工厂
  string plant = 2;
  // 存储地点
  string storage_location = 3;
  // 批次 (可选)
  string batch = 4;
  // 要解冻的数量
  string quantity_to_unblock = 5;
  // 单位
  string unit = 6;
  // 冻结凭证号 (可选)
  string blocking_document_number = 7;
  // 解冻原因
  string unblocking_reason = 8;
}

// 解冻库存响应
message UnblockStockResponse {
  // 操作是否成功
  bool success = 1;
  // 解冻的数量
  string unblocked_quantity = 2;
  // 消息列表
  repeated enterprise.common.ApiMessage messages = 3;
}

// 查询冻结库存列表请求
message ListBlockedStockRequest {
  // 工厂
  string plant = 1;
  // 存储地点 (可选)
  string storage_location = 2;
  // 物料编号 (可选)
  string material = 3;
  // 冻结原因 (可选)
  StockBlockingReason blocking_reason = 4;
  // 分页请求
  enterprise.common.PaginationRequest pagination = 5;
}

// 查询冻结库存列表响应
message ListBlockedStockResponse {
  // 冻结库存列表
  repeated BlockedStockItem blocked_stocks = 1;
  // 分页响应
  enterprise.common.PaginationResponse pagination = 2;
}

// 冻结库存项目
message BlockedStockItem {
  // 物料编号
  string material = 1;
  // 物料描述
  string material_description = 2;
  // 工厂
  string plant = 3;
  // 存储地点
  string storage_location = 4;
  // 批次
  string batch = 5;
  // 冻结数量
  string blocked_quantity = 6;
  // 单位
  string unit = 7;
  // 冻结原因
  StockBlockingReason blocking_reason = 8;
  // 冻结原因描述
  string blocking_reason_text = 9;
  // 冻结日期
  google.protobuf.Timestamp blocking_date = 10;
  // 冻结期限
  google.protobuf.Timestamp blocking_until = 11;
  // 冻结人
  string blocked_by = 12;
  // 冻结凭证号
  string blocking_document_number = 13;
}

// --------------------------------------------------------------------------
// 库存调整消息 (Stock Adjustment Messages)
// --------------------------------------------------------------------------

// 创建库存调整请求
message CreateStockAdjustmentRequest {
  // 调整类型
  StockAdjustmentType adjustment_type = 1;
  // 工厂
  string plant = 2;
  // 存储地点
  string storage_location = 3;
  // 调整日期
  google.protobuf.Timestamp adjustment_date = 4;
  // 调整原因
  string reason = 5;
  // 调整项目列表
  repeated StockAdjustmentItem items = 6;
  // 是否需要审批
  bool requires_approval = 7;
}

// 库存调整项目
message StockAdjustmentItem {
  // 物料编号
  string material = 1;
  // 批次 (可选)
  string batch = 2;
  // 调整数量 (正数为增加，负数为减少)
  string adjustment_quantity = 3;
  // 单位
  string unit = 4;
  // 原因代码
  string reason_code = 5;
  // 说明
  string notes = 6;
}

// 库存调整响应
message StockAdjustmentResponse {
  // 操作是否成功
  bool success = 1;
  // 调整单号
  string adjustment_number = 2;
  // 调整状态
  StockAdjustmentStatus status = 3;
  // 消息列表
  repeated enterprise.common.ApiMessage messages = 4;
}

// 审批库存调整请求
message ApproveStockAdjustmentRequest {
  // 调整单号
  string adjustment_number = 1;
  // 审批决策 (APPROVE/REJECT)
  string approval_decision = 2;
  // 审批意见
  string approval_comments = 3;
}

// 查询库存调整列表请求
message ListStockAdjustmentsRequest {
  // 工厂
  string plant = 1;
  // 存储地点 (可选)
  string storage_location = 2;
  // 调整类型 (可选)
  StockAdjustmentType adjustment_type = 3;
  // 调整状态 (可选)
  StockAdjustmentStatus status = 4;
  // 日期范围
  enterprise.common.DateRange date_range = 5;
  // 分页请求
  enterprise.common.PaginationRequest pagination = 6;
}

// 查询库存调整列表响应
message ListStockAdjustmentsResponse {
  // 调整单摘要列表
  repeated StockAdjustmentSummary adjustments = 1;
  // 分页响应
  enterprise.common.PaginationResponse pagination = 2;
}

// 库存调整摘要
message StockAdjustmentSummary {
  // 调整单号
  string adjustment_number = 1;
  // 调整类型
  StockAdjustmentType adjustment_type = 2;
  // 调整状态
  StockAdjustmentStatus status = 3;
  // 工厂
  string plant = 4;
  // 存储地点
  string storage_location = 5;
  // 调整日期
  google.protobuf.Timestamp adjustment_date = 6;
  // 创建人
  string created_by = 7;
  // 调整原因
  string reason = 8;
  // 项目数量
  int32 item_count = 9;
}

// --------------------------------------------------------------------------
// 物料主数据查询消息 (Material Master Data Query Messages)
// --------------------------------------------------------------------------

// 获取物料主数据请求
message GetMaterialMasterDataRequest {
  // 物料编号
  string material = 1;
}

// 物料主数据 (参考: MARA - 物料主数据)
message MaterialMasterData {
  // 物料编号 (原: MATNR)
  string material = 1;
  // 物料类型 (原: MTART)
  string material_type = 2;
  // 物料组 (原: MATKL)
  string material_group = 3;
  // 基本计量单位 (原: MEINS)
  string base_unit = 4;
  // 物料描述 (原: MAKTX)
  string material_description = 5;
  // 长文本描述
  string long_description = 6;
  // 产品层次 (原: PRDHA)
  string product_hierarchy = 7;
  // 毛重 (原: BRGEW)
  string gross_weight = 8;
  // 净重 (原: NTGEW)
  string net_weight = 9;
  // 重量单位 (原: GEWEI)
  string weight_unit = 10;
  // 体积 (原: VOLUM)
  string volume = 11;
  // 体积单位 (原: VOLEH)
  string volume_unit = 12;
  // 尺寸单位 (原: MEABM)
  string size_dimensions_unit = 13;
  // 长度
  string length = 14;
  // 宽度
  string width = 15;
  // 高度
  string height = 16;
  // 是否批次管理 (原: XCHPF)
  bool batch_management = 17;
  // 是否序列号管理
  bool serial_number_management = 18;
  // 保质期天数 (原: MHDHB)
  int32 shelf_life_days = 19;
  // 最小剩余保质期 (原: MHDRZ)
  int32 minimum_remaining_shelf_life = 20;
  // 创建日期 (原: ERSDA)
  google.protobuf.Timestamp created_date = 21;
  // 创建人 (原: ERNAM)
  string created_by = 22;
  // 最后修改日期 (原: LAEDA)
  google.protobuf.Timestamp last_change_date = 23;
  // 最后修改人 (原: AENAM)
  string changed_by = 24;
}

// 查询物料列表请求
message ListMaterialsRequest {
  // 物料类型 (可选)
  string material_type = 1;
  // 物料组 (可选)
  string material_group = 2;
  // 搜索关键词 (物料编号或描述)
  string search_keyword = 3;
  // 是否只显示批次管理物料
  bool batch_managed_only = 4;
  // 分页请求
  enterprise.common.PaginationRequest pagination = 5;
}

// 查询物料列表响应
message ListMaterialsResponse {
  // 物料摘要列表
  repeated MaterialSummary materials = 1;
  // 分页响应
  enterprise.common.PaginationResponse pagination = 2;
}

// 物料摘要
message MaterialSummary {
  // 物料编号
  string material = 1;
  // 物料描述
  string material_description = 2;
  // 物料类型
  string material_type = 3;
  // 物料组
  string material_group = 4;
  // 基本计量单位
  string base_unit = 5;
  // 是否批次管理
  bool batch_management = 6;
  // 是否序列号管理
  bool serial_number_management = 7;
}

// 获取物料工厂数据请求
message GetMaterialPlantDataRequest {
  // 物料编号
  string material = 1;
  // 工厂
  string plant = 2;
}

// 物料工厂数据 (参考: MARC - 工厂数据)
message MaterialPlantData {
  // 物料编号
  string material = 1;
  // 工厂
  string plant = 2;
  // ABC指示符
  ABCIndicator abc_indicator = 3;
  // 安全库存 (原: EISBE)
  string safety_stock = 4;
  // 最小批量 (原: BSTMI)
  string minimum_lot_size = 5;
  // 最大批量 (原: BSTMA)
  string maximum_lot_size = 6;
  // 再订货点 (原: MINBE)
  string reorder_point = 7;
  // 最大库存水平 (原: MABST)
  string maximum_stock_level = 8;
  // 采购组 (原: EKGRP)
  string purchasing_group = 9;
  // MRP类型 (原: DISMM)
  string mrp_type = 10;
  // MRP控制者 (原: DISPO)
  string mrp_controller = 11;
  // 计划交货时间 (原: PLIFZ)
  int32 planned_delivery_time = 12;
  // 收货处理时间 (原: WEBAZ)
  int32 goods_receipt_processing_time = 13;
  // 是否批次管理
  bool batch_management = 14;
  // 评估类别 (原: BKLAS)
  string valuation_class = 15;
  // 价格控制 (原: VPRSV)
  string price_control = 16;
  // 标准价格 (原: STPRS)
  string standard_price = 17;
  // 移动平均价 (原: VERPR)
  string moving_average_price = 18;
  // 价格单位 (原: PEINH)
  string price_unit = 19;
  // 货币
  string currency = 20;
}

// 获取物料存储地点数据请求
message GetMaterialStorageLocationDataRequest {
  // 物料编号
  string material = 1;
  // 工厂
  string plant = 2;
  // 存储地点
  string storage_location = 3;
}

// 物料存储地点数据 (参考: MARD)
message MaterialStorageLocationData {
  // 物料编号
  string material = 1;
  // 工厂
  string plant = 2;
  // 存储地点
  string storage_location = 3;
  // 非限制使用库存
  string unrestricted_stock = 4;
  // 质检库存
  string quality_inspection_stock = 5;
  // 冻结库存
  string blocked_stock = 6;
  // 在途库存
  string stock_in_transit = 7;
  // 单位
  string unit = 8;
  // 上次盘点日期 (原: IDATE)
  google.protobuf.Timestamp last_inventory_date = 9;
  // 上次移动日期
  google.protobuf.Timestamp last_movement_date = 10;
}

// --------------------------------------------------------------------------
// 库存预警消息 (Stock Alert Messages)
// --------------------------------------------------------------------------

// 创建库存预警规则请求
message CreateStockAlertRuleRequest {
  // 规则名称
  string rule_name = 1;
  // 预警类型
  StockAlertType alert_type = 2;
  // 严重程度
  StockAlertSeverity severity = 3;
  // 工厂 (可选，不填则适用所有工厂)
  string plant = 4;
  // 物料 (可选，不填则适用所有物料)
  string material = 5;
  // 阈值条件 (JSON格式)
  string threshold_conditions = 6;
  // 通知接收人列表
  repeated string recipients = 7;
  // 是否激活
  bool is_active = 8;
}

// 库存预警规则响应
message StockAlertRuleResponse {
  // 操作是否成功
  bool success = 1;
  // 规则ID
  string rule_id = 2;
  // 消息列表
  repeated enterprise.common.ApiMessage messages = 3;
}

// 查询库存预警请求
message ListStockAlertsRequest {
  // 工厂 (可选)
  string plant = 1;
  // 预警类型 (可选)
  StockAlertType alert_type = 2;
  // 严重程度 (可选)
  StockAlertSeverity severity = 3;
  // 是否只显示未确认的预警
  bool unacknowledged_only = 4;
  // 日期范围
  enterprise.common.DateRange date_range = 5;
  // 分页请求
  enterprise.common.PaginationRequest pagination = 6;
}

// 查询库存预警响应
message ListStockAlertsResponse {
  // 预警列表
  repeated StockAlert alerts = 1;
  // 分页响应
  enterprise.common.PaginationResponse pagination = 2;
}

// 库存预警
message StockAlert {
  // 预警ID
  string alert_id = 1;
  // 预警类型
  StockAlertType alert_type = 2;
  // 严重程度
  StockAlertSeverity severity = 3;
  // 物料编号
  string material = 4;
  // 物料描述
  string material_description = 5;
  // 工厂
  string plant = 6;
  // 存储地点
  string storage_location = 7;
  // 批次
  string batch = 8;
  // 预警标题
  string alert_title = 9;
  // 预警详情
  string alert_details = 10;
  // 当前值
  string current_value = 11;
  // 阈值
  string threshold_value = 12;
  // 预警时间
  google.protobuf.Timestamp alert_time = 13;
  // 是否已确认
  bool is_acknowledged = 14;
  // 确认人
  string acknowledged_by = 15;
  // 确认时间
  google.protobuf.Timestamp acknowledged_at = 16;
}

// 确认库存预警请求
message AcknowledgeStockAlertRequest {
  // 预警ID
  string alert_id = 1;
  // 确认说明
  string acknowledgement_notes = 2;
}

// 确认库存预警响应
message AcknowledgeStockAlertResponse {
  // 操作是否成功
  bool success = 1;
  // 消息列表
  repeated enterprise.common.ApiMessage messages = 2;
}

// --------------------------------------------------------------------------
// 库存成本计算消息 (Stock Cost Calculation Messages)
// --------------------------------------------------------------------------

// 计算库存成本请求
message CalculateStockCostRequest {
  // 工厂
  string plant = 1;
  // 存储地点 (可选)
  string storage_location = 2;
  // 物料编号 (可选)
  string material = 3;
  // 评估日期
  google.protobuf.Timestamp valuation_date = 4;
}

// 库存成本计算响应
message StockCostCalculationResponse {
  // 操作是否成功
  bool success = 1;
  // 成本计算结果列表
  repeated StockCostResult cost_results = 2;
  // 汇总信息
  StockCostSummary summary = 3;
  // 消息列表
  repeated enterprise.common.ApiMessage messages = 4;
}

// 库存成本结果
message StockCostResult {
  // 物料编号
  string material = 1;
  // 物料描述
  string material_description = 2;
  // 工厂
  string plant = 3;
  // 存储地点
  string storage_location = 4;
  // 库存数量
  string quantity = 5;
  // 单位
  string unit = 6;
  // 单价
  string unit_cost = 7;
  // 总成本
  string total_cost = 8;
  // 货币
  string currency = 9;
  // 价格类型 (标准价/移动平均价)
  string price_type = 10;
}

// 库存成本汇总
message StockCostSummary {
  // 总库存价值
  string total_stock_value = 1;
  // 货币
  string currency = 2;
  // 物料种类数
  int32 material_count = 3;
  // 按物料组汇总
  repeated MaterialGroupCostSummary material_group_summaries = 4;
}

// 物料组成本汇总
message MaterialGroupCostSummary {
  // 物料组
  string material_group = 1;
  // 物料组描述
  string material_group_description = 2;
  // 物料数量
  int32 material_count = 3;
  // 总价值
  string total_value = 4;
  // 百分比
  string percentage = 5;
}

// 获取物料成本明细请求
message GetMaterialCostBreakdownRequest {
  // 物料编号
  string material = 1;
  // 工厂
  string plant = 2;
  // 评估类型 (可选)
  string valuation_type = 3;
}

// 物料成本明细响应
message MaterialCostBreakdownResponse {
  // 物料编号
  string material = 1;
  // 工厂
  string plant = 2;
  // 总成本
  string total_cost = 3;
  // 货币
  string currency = 4;
  // 成本组成列表
  repeated CostComponent cost_components = 5;
}

// 成本组成
message CostComponent {
  // 成本组件名称 (如: 原材料、人工、制造费用)
  string component_name = 1;
  // 成本金额
  string cost_amount = 2;
  // 百分比
  string percentage = 3;
  // 成本要素
  string cost_element = 4;
}

// --------------------------------------------------------------------------
// 库存报表与导出消息 (Stock Reports & Export Messages)
// --------------------------------------------------------------------------

// 生成库存报表请求
message GenerateStockReportRequest {
  // 报表类型
  StockReportType report_type = 1;
  // 工厂
  string plant = 2;
  // 存储地点 (可选)
  string storage_location = 3;
  // 报表参数 (JSON格式，根据不同报表类型而定)
  string report_parameters = 4;
  // 报表日期
  google.protobuf.Timestamp report_date = 5;
  // 导出格式
  ExportFormat export_format = 6;
}

// 库存报表响应
message StockReportResponse {
  // 操作是否成功
  bool success = 1;
  // 报表ID
  string report_id = 2;
  // 报表文件内容 (Base64编码)
  bytes report_content = 3;
  // 文件名
  string file_name = 4;
  // MIME类型
  string mime_type = 5;
  // 消息列表
  repeated enterprise.common.ApiMessage messages = 6;
}

// 导出库存数据请求
message ExportStockDataRequest {
  // 工厂
  string plant = 1;
  // 存储地点 (可选)
  string storage_location = 2;
  // 物料编号 (可选)
  string material = 3;
  // 导出格式
  ExportFormat export_format = 4;
  // 是否包含批次信息
  bool include_batch_info = 5;
  // 是否包含序列号信息
  bool include_serial_info = 6;
}

// 导出库存数据响应
message ExportStockDataResponse {
  // 操作是否成功
  bool success = 1;
  // 导出文件内容 (Base64编码)
  bytes file_content = 2;
  // 文件名
  string file_name = 3;
  // MIME类型
  string mime_type = 4;
  // 导出的记录数
  int32 exported_count = 5;
  // 消息列表
  repeated enterprise.common.ApiMessage messages = 6;
}

// 生成库存汇总表请求
message GenerateStockSummaryReportRequest {
  // 工厂列表 (可选，不填则包含所有工厂)
  repeated string plants = 1;
  // 汇总维度 (PLANT: 按工厂, MATERIAL_GROUP: 按物料组, ABC: 按ABC分类)
  repeated string summary_dimensions = 2;
  // 报表日期
  google.protobuf.Timestamp report_date = 3;
  // 导出格式
  ExportFormat export_format = 4;
}

// 库存汇总表响应
message StockSummaryReportResponse {
  // 操作是否成功
  bool success = 1;
  // 汇总数据列表
  repeated StockSummaryData summary_data = 2;
  // 报表文件内容 (Base64编码)
  bytes report_content = 3;
  // 文件名
  string file_name = 4;
  // 消息列表
  repeated enterprise.common.ApiMessage messages = 5;
}

// 库存汇总数据
message StockSummaryData {
  // 汇总维度键 (工厂、物料组等)
  string dimension_key = 1;
  // 汇总维度值
  string dimension_value = 2;
  // 物料种类数
  int32 material_count = 3;
  // 总库存数量
  string total_quantity = 4;
  // 总库存价值
  string total_value = 5;
  // 货币
  string currency = 6;
}

// --------------------------------------------------------------------------
// 多工厂库存管理消息 (Multi-Plant Stock Management Messages)
// --------------------------------------------------------------------------

// 跨工厂库存查询请求
message GetCrossPlantStockRequest {
  // 物料编号
  string material = 1;
  // 工厂列表 (可选，不填则查询所有工厂)
  repeated string plants = 2;
  // 是否包含在途库存
  bool include_in_transit = 3;
}

// 跨工厂库存响应
message CrossPlantStockResponse {
  // 物料编号
  string material = 1;
  // 各工厂库存列表
  repeated PlantStockDetail plant_stocks = 2;
  // 汇总信息
  CrossPlantStockSummary summary = 3;
}

// 工厂库存详情
message PlantStockDetail {
  // 工厂
  string plant = 1;
  // 工厂名称
  string plant_name = 2;
  // 非限制使用库存
  string unrestricted_stock = 3;
  // 质检库存
  string quality_inspection_stock = 4;
  // 冻结库存
  string blocked_stock = 5;
  // 在途库存
  string in_transit_stock = 6;
  // 总库存
  string total_stock = 7;
  // 可用库存
  string available_stock = 8;
  // 单位
  string unit = 9;
}

// 跨工厂库存汇总
message CrossPlantStockSummary {
  // 总工厂数
  int32 total_plants = 1;
  // 全部非限制使用库存
  string total_unrestricted_stock = 2;
  // 全部质检库存
  string total_quality_inspection_stock = 3;
  // 全部冻结库存
  string total_blocked_stock = 4;
  // 全部在途库存
  string total_in_transit_stock = 5;
  // 总库存
  string grand_total_stock = 6;
  // 单位
  string unit = 7;
}

// 工厂间库存平衡分析请求
message AnalyzeInterPlantBalanceRequest {
  // 物料编号
  string material = 1;
  // 工厂列表
  repeated string plants = 2;
  // 分析期间
  enterprise.common.DateRange analysis_period = 3;
}

// 工厂间库存平衡分析响应
message InterPlantBalanceAnalysisResponse {
  // 操作是否成功
  bool success = 1;
  // 平衡分析结果列表
  repeated PlantBalanceAnalysis balance_analyses = 2;
  // 建议
  repeated BalancingRecommendation recommendations = 3;
  // 消息列表
  repeated enterprise.common.ApiMessage messages = 4;
}

// 工厂平衡分析
message PlantBalanceAnalysis {
  // 工厂
  string plant = 1;
  // 当前库存
  string current_stock = 2;
  // 平均需求
  string average_demand = 3;
  // 库存覆盖天数
  int32 days_of_coverage = 4;
  // 超储/缺货状态 (OVERSTOCK/UNDERSTOCK/BALANCED)
  string balance_status = 5;
  // 超储/缺货数量
  string imbalance_quantity = 6;
  // 单位
  string unit = 7;
}

// 平衡建议
message BalancingRecommendation {
  // 建议ID
  string recommendation_id = 1;
  // 从工厂
  string from_plant = 2;
  // 到工厂
  string to_plant = 3;
  // 建议转移数量
  string recommended_transfer_quantity = 4;
  // 单位
  string unit = 5;
  // 建议原因
  string reason = 6;
  // 预期效益
  string expected_benefit = 7;
}

// --------------------------------------------------------------------------
// 库存质量管理消息 (Stock Quality Management Messages)
// --------------------------------------------------------------------------

// 转入质检库存请求
message TransferToQualityInspectionRequest {
  // 物料编号
  string material = 1;
  // 工厂
  string plant = 2;
  // 存储地点
  string storage_location = 3;
  // 批次 (可选)
  string batch = 4;
  // 转入质检数量
  string quantity_to_qi = 5;
  // 单位
  string unit = 6;
  // 质检批号
  string inspection_lot_number = 7;
  // 转入原因
  string transfer_reason = 8;
}

// 质检转移响应
message QualityTransferResponse {
  // 操作是否成功
  bool success = 1;
  // 物料凭证引用
  enterprise.common.SystemDocumentReference material_document = 2;
  // 质检批号
  string inspection_lot_number = 3;
  // 消息列表
  repeated enterprise.common.ApiMessage messages = 4;
}

// 质检后库存处理请求
message ProcessQualityInspectionResultRequest {
  // 质检批号
  string inspection_lot_number = 1;
  // 质检决策
  QualityInspectionDecision inspection_decision = 2;
  // 物料编号
  string material = 3;
  // 工厂
  string plant = 4;
  // 存储地点
  string storage_location = 5;
  // 批次
  string batch = 6;
  // 合格数量
  string accepted_quantity = 7;
  // 不合格数量
  string rejected_quantity = 8;
  // 单位
  string unit = 9;
  // 处理说明
  string processing_notes = 10;
}

// 质检处理响应
message QualityProcessingResponse {
  // 操作是否成功
  bool success = 1;
  // 放行物料凭证 (接受时)
  enterprise.common.SystemDocumentReference release_document = 2;
  // 拒收物料凭证 (拒收时)
  enterprise.common.SystemDocumentReference rejection_document = 3;
  // 消息列表
  repeated enterprise.common.ApiMessage messages = 4;
}

// 查询质检库存请求
message ListQualityInspectionStockRequest {
  // 工厂
  string plant = 1;
  // 存储地点 (可选)
  string storage_location = 2;
  // 物料编号 (可选)
  string material = 3;
  // 分页请求
  enterprise.common.PaginationRequest pagination = 4;
}

// 质检库存响应
message QualityInspectionStockResponse {
  // 质检库存列表
  repeated QualityInspectionStockItem qi_stocks = 1;
  // 分页响应
  enterprise.common.PaginationResponse pagination = 2;
}

// 质检库存项目
message QualityInspectionStockItem {
  // 物料编号
  string material = 1;
  // 物料描述
  string material_description = 2;
  // 工厂
  string plant = 3;
  // 存储地点
  string storage_location = 4;
  // 批次
  string batch = 5;
  // 质检数量
  string qi_quantity = 6;
  // 单位
  string unit = 7;
  // 质检批号
  string inspection_lot_number = 8;
  // 转入质检日期
  google.protobuf.Timestamp qi_entry_date = 9;
  // 质检期限
  google.protobuf.Timestamp inspection_due_date = 10;
}

// --------------------------------------------------------------------------
// 库存差异处理消息 (Stock Variance Management Messages)
// --------------------------------------------------------------------------

// 创建库存差异报告请求
message CreateStockVarianceReportRequest {
  // 工厂
  string plant = 1;
  // 存储地点
  string storage_location = 2;
  // 差异期间
  enterprise.common.DateRange variance_period = 3;
  // 差异项目列表
  repeated StockVarianceItem variance_items = 4;
  // 差异原因
  string variance_reason = 5;
}

// 库存差异项目
message StockVarianceItem {
  // 物料编号
  string material = 1;
  // 批次 (可选)
  string batch = 2;
  // 系统库存
  string system_stock = 3;
  // 实际库存
  string actual_stock = 4;
  // 差异数量
  string variance_quantity = 5;
  // 单位
  string unit = 6;
  // 差异原因代码
  string variance_reason_code = 7;
  // 说明
  string notes = 8;
}

// 库存差异报告响应
message StockVarianceReportResponse {
  // 操作是否成功
  bool success = 1;
  // 差异报告号
  string variance_report_number = 2;
  // 消息列表
  repeated enterprise.common.ApiMessage messages = 3;
}

// 审批库存差异请求
message ApproveStockVarianceRequest {
  // 差异报告号
  string variance_report_number = 1;
  // 审批决策 (APPROVE/REJECT)
  string approval_decision = 2;
  // 审批意见
  string approval_comments = 3;
}

// 库存差异审批响应
message StockVarianceApprovalResponse {
  // 操作是否成功
  bool success = 1;
  // 消息列表
  repeated enterprise.common.ApiMessage messages = 2;
}

// 调整库存差异请求
message AdjustStockVarianceRequest {
  // 差异报告号
  string variance_report_number = 1;
  // 调整日期
  google.protobuf.Timestamp adjustment_date = 2;
}

// 库存差异调整响应
message StockVarianceAdjustmentResponse {
  // 操作是否成功
  bool success = 1;
  // 调整物料凭证
  enterprise.common.SystemDocumentReference adjustment_document = 2;
  // 消息列表
  repeated enterprise.common.ApiMessage messages = 3;
}

// --------------------------------------------------------------------------
// 库存运输管理消息 (Stock Transportation Management Messages)
// --------------------------------------------------------------------------

// 创建库存运输单请求
message CreateStockTransportationRequest {
  // 发出工厂
  string issuing_plant = 1;
  // 发出存储地点
  string issuing_storage_location = 2;
  // 接收工厂
  string receiving_plant = 3;
  // 接收存储地点
  string receiving_storage_location = 4;
  // 计划装运日期
  google.protobuf.Timestamp planned_shipment_date = 5;
  // 预计到达日期
  google.protobuf.Timestamp estimated_arrival_date = 6;
  // 运输方式 (例如: 陆运、空运、海运)
  string transportation_mode = 7;
  // 承运商
  string carrier = 8;
  // 运输项目列表
  repeated TransportationItem items = 9;
}

// 运输项目
message TransportationItem {
  // 物料编号
  string material = 1;
  // 批次 (可选)
  string batch = 2;
  // 运输数量
  string transportation_quantity = 3;
  // 单位
  string unit = 4;
}

// 库存运输响应
message StockTransportationResponse {
  // 操作是否成功
  bool success = 1;
  // 运输单号
  string transportation_number = 2;
  // 运输状态
  TransportationStatus status = 3;
  // 消息列表
  repeated enterprise.common.ApiMessage messages = 4;
}

// 确认库存装运请求
message ConfirmStockShipmentRequest {
  // 运输单号
  string transportation_number = 1;
  // 实际装运日期
  google.protobuf.Timestamp actual_shipment_date = 2;
  // 运输车辆/航班号
  string vehicle_or_flight_number = 3;
  // 运输单号 (承运商)
  string carrier_tracking_number = 4;
}

// 装运确认响应
message ShipmentConfirmationResponse {
  // 操作是否成功
  bool success = 1;
  // 发货物料凭证
  enterprise.common.SystemDocumentReference shipment_document = 2;
  // 运输状态
  TransportationStatus status = 3;
  // 消息列表
  repeated enterprise.common.ApiMessage messages = 4;
}

// 确认库存收货请求
message ConfirmStockReceiptRequest {
  // 运输单号
  string transportation_number = 1;
  // 实际收货日期
  google.protobuf.Timestamp actual_receipt_date = 2;
  // 收货数量列表
  repeated ReceiptQuantityItem receipt_items = 3;
}

// 收货数量项目
message ReceiptQuantityItem {
  // 物料编号
  string material = 1;
  // 批次
  string batch = 2;
  // 收货数量
  string received_quantity = 3;
  // 单位
  string unit = 4;
}

// 收货确认响应
message ReceiptConfirmationResponse {
  // 操作是否成功
  bool success = 1;
  // 收货物料凭证
  enterprise.common.SystemDocumentReference receipt_document = 2;
  // 运输状态
  TransportationStatus status = 3;
  // 消息列表
  repeated enterprise.common.ApiMessage messages = 4;
}

// 查询在途库存请求
message ListStockInTransitRequest {
  // 发出工厂 (可选)
  string issuing_plant = 1;
  // 接收工厂 (可选)
  string receiving_plant = 2;
  // 物料编号 (可选)
  string material = 3;
  // 运输状态 (可选)
  TransportationStatus status = 4;
  // 分页请求
  enterprise.common.PaginationRequest pagination = 5;
}

// 在途库存响应
message StockInTransitResponse {
  // 在途库存列表
  repeated StockInTransitItem in_transit_items = 1;
  // 分页响应
  enterprise.common.PaginationResponse pagination = 2;
}

// 在途库存项目
message StockInTransitItem {
  // 运输单号
  string transportation_number = 1;
  // 物料编号
  string material = 2;
  // 物料描述
  string material_description = 3;
  // 批次
  string batch = 4;
  // 运输数量
  string transportation_quantity = 5;
  // 单位
  string unit = 6;
  // 发出工厂
  string issuing_plant = 7;
  // 接收工厂
  string receiving_plant = 8;
  // 装运日期
  google.protobuf.Timestamp shipment_date = 9;
  // 预计到达日期
  google.protobuf.Timestamp estimated_arrival_date = 10;
  // 运输状态
  TransportationStatus status = 11;
  // 承运商
  string carrier = 12;
  // 运输跟踪号
  string carrier_tracking_number = 13;
}

// --------------------------------------------------------------------------
// 库存容器管理消息 (Stock Container Management Messages)
// --------------------------------------------------------------------------

// 创建库存容器请求
message CreateStockContainerRequest {
  // 容器类型
  ContainerType container_type = 1;
  // 容器编号 (如果为空，系统自动生成)
  string container_number = 2;
  // 工厂
  string plant = 3;
  // 存储地点
  string storage_location = 4;
  // 容器描述
  string container_description = 5;
  // 容器容量
  string container_capacity = 6;
  // 容量单位
  string capacity_unit = 7;
}

// 库存容器响应
message StockContainerResponse {
  // 操作是否成功
  bool success = 1;
  // 容器编号
  string container_number = 2;
  // 消息列表
  repeated enterprise.common.ApiMessage messages = 3;
}

// 容器装载请求
message LoadContainerRequest {
  // 容器编号
  string container_number = 1;
  // 装载项目列表
  repeated ContainerLoadItem load_items = 2;
  // 装载日期
  google.protobuf.Timestamp loading_date = 3;
}

// 容器装载项目
message ContainerLoadItem {
  // 物料编号
  string material = 1;
  // 批次 (可选)
  string batch = 2;
  // 序列号列表 (可选)
  repeated string serial_numbers = 3;
  // 装载数量
  string loaded_quantity = 4;
  // 单位
  string unit = 5;
}

// 容器装载响应
message ContainerLoadingResponse {
  // 操作是否成功
  bool success = 1;
  // 装载的总数量
  string total_loaded_quantity = 2;
  // 剩余容量
  string remaining_capacity = 3;
  // 消息列表
  repeated enterprise.common.ApiMessage messages = 4;
}

// 容器卸载请求
message UnloadContainerRequest {
  // 容器编号
  string container_number = 1;
  // 卸载项目列表 (如果为空，则卸载全部)
  repeated ContainerUnloadItem unload_items = 2;
  // 卸载日期
  google.protobuf.Timestamp unloading_date = 3;
}

// 容器卸载项目
message ContainerUnloadItem {
  // 物料编号
  string material = 1;
  // 批次
  string batch = 2;
  // 卸载数量
  string unloaded_quantity = 3;
  // 单位
  string unit = 4;
}

// 容器卸载响应
message ContainerUnloadingResponse {
  // 操作是否成功
  bool success = 1;
  // 卸载的总数量
  string total_unloaded_quantity = 2;
  // 消息列表
  repeated enterprise.common.ApiMessage messages = 3;
}

// 查询容器库存请求
message ListContainerStockRequest {
  // 工厂
  string plant = 1;
  // 存储地点 (可选)
  string storage_location = 2;
  // 容器类型 (可选)
  ContainerType container_type = 3;
  // 容器编号 (可选)
  string container_number = 4;
  // 分页请求
  enterprise.common.PaginationRequest pagination = 5;
}

// 容器库存响应
message ContainerStockResponse {
  // 容器库存列表
  repeated ContainerStockItem container_stocks = 1;
  // 分页响应
  enterprise.common.PaginationResponse pagination = 2;
}

// 容器库存项目
message ContainerStockItem {
  // 容器编号
  string container_number = 1;
  // 容器类型
  ContainerType container_type = 2;
  // 工厂
  string plant = 3;
  // 存储地点
  string storage_location = 4;
  // 容器中的物料列表
  repeated ContainerMaterialItem materials = 5;
  // 总装载量
  string total_loaded_quantity = 6;
  // 容器容量
  string container_capacity = 7;
  // 利用率百分比
  string utilization_percentage = 8;
}

// 容器中的物料项目
message ContainerMaterialItem {
  // 物料编号
  string material = 1;
  // 物料描述
  string material_description = 2;
  // 批次
  string batch = 3;
  // 数量
  string quantity = 4;
  // 单位
  string unit = 5;
}

// --------------------------------------------------------------------------
// 库存看板消息 (Stock Dashboard Messages)
// --------------------------------------------------------------------------

// 获取库存仪表板数据请求
message GetStockDashboardRequest {
  // 工厂列表 (可选)
  repeated string plants = 1;
  // 仪表板类型 (OVERVIEW: 总览, ALERTS: 预警, PERFORMANCE: 绩效)
  string dashboard_type = 2;
  // 时间范围
  enterprise.common.DateRange time_range = 3;
}

// 库存仪表板响应
message StockDashboardResponse {
  // 仪表板数据
  StockDashboardData dashboard_data = 1;
}

// 库存仪表板数据
message StockDashboardData {
  // 总库存价值
  string total_stock_value = 1;
  // 货币
  string currency = 2;
  // 物料种类数
  int32 total_material_count = 3;
  // 活跃库存项数
  int32 active_stock_items = 4;
  // 预警数量
  int32 alert_count = 5;
  // 关键预警数量
  int32 critical_alert_count = 6;
  // 库存周转率
  string inventory_turnover_ratio = 7;
  // 呆滞库存价值
  string slow_moving_stock_value = 8;
  // 超储库存价值
  string overstock_value = 9;
  // 缺货风险物料数
  int32 stockout_risk_count = 10;
  // 近期移动趋势 (JSON格式时间序列数据)
  string movement_trend_data = 11;
  // 按工厂分布
  repeated PlantStockDistribution plant_distributions = 12;
  // 按物料组分布
  repeated MaterialGroupDistribution material_group_distributions = 13;
}

// 工厂库存分布
message PlantStockDistribution {
  // 工厂
  string plant = 1;
  // 工厂名称
  string plant_name = 2;
  // 库存价值
  string stock_value = 3;
  // 百分比
  string percentage = 4;
}

// 物料组分布
message MaterialGroupDistribution {
  // 物料组
  string material_group = 1;
  // 物料组描述
  string material_group_description = 2;
  // 库存价值
  string stock_value = 3;
  // 百分比
  string percentage = 4;
}

// 获取库存KPI指标请求
message GetStockKPIsRequest {
  // 工厂列表 (可选)
  repeated string plants = 1;
  // KPI计算期间
  enterprise.common.DateRange calculation_period = 2;
}

// 库存KPI指标响应
message StockKPIsResponse {
  // KPI指标列表
  repeated StockKPI kpis = 1;
}

// 库存KPI指标
message StockKPI {
  // KPI名称
  string kpi_name = 1;
  // KPI值
  string kpi_value = 2;
  // 单位/格式
  string unit = 3;
  // 目标值
  string target_value = 4;
  // 与目标的偏差
  string deviation = 5;
  // 趋势 (UP/DOWN/STABLE)
  string trend = 6;
  // KPI描述
  string description = 7;
}

// --------------------------------------------------------------------------
// 库存追溯消息 (Stock Traceability Messages)
// --------------------------------------------------------------------------

// 端到端库存追溯请求
message TraceStockEndToEndRequest {
  // 物料编号
  string material = 1;
  // 批次 (可选)
  string batch = 2;
  // 序列号 (可选)
  string serial_number = 3;
  // 工厂
  string plant = 4;
  // 追溯深度
  int32 trace_depth = 5;
}

// 库存追溯响应
message StockTraceabilityResponse {
  // 操作是否成功
  bool success = 1;
  // 追溯树
  TraceabilityNode root_node = 2;
  // 消息列表
  repeated enterprise.common.ApiMessage messages = 3;
}

// 追溯节点
message TraceabilityNode {
  // 节点类型 (RECEIPT/ISSUE/PRODUCTION/TRANSFER)
  string node_type = 1;
  // 物料编号
  string material = 2;
  // 批次
  string batch = 3;
  // 序列号
  string serial_number = 4;
  // 数量
  string quantity = 5;
  // 单位
  string unit = 6;
  // 凭证号
  string document_number = 7;
  // 凭证日期
  google.protobuf.Timestamp document_date = 8;
  // 工厂
  string plant = 9;
  // 存储地点
  string storage_location = 10;
  // 供应商/客户
  string business_partner = 11;
  // 子节点列表 (来源或去向)
  repeated TraceabilityNode child_nodes = 12;
}

// 获取物料来源追溯请求
message TraceMaterialOriginRequest {
  // 物料编号
  string material = 1;
  // 批次
  string batch = 2;
  // 工厂
  string plant = 3;
  // 存储地点
  string storage_location = 4;
  // 追溯深度
  int32 trace_depth = 5;
}

// 物料来源追溯响应
message MaterialOriginTraceResponse {
  // 操作是否成功
  bool success = 1;
  // 来源追溯链
  repeated OriginTraceEntry origin_chain = 2;
  // 消息列表
  repeated enterprise.common.ApiMessage messages = 3;
}

// 来源追溯条目
message OriginTraceEntry {
  // 层级
  int32 level = 1;
  // 物料编号
  string material = 2;
  // 批次
  string batch = 3;
  // 数量
  string quantity = 4;
  // 单位
  string unit = 5;
  // 收货日期
  google.protobuf.Timestamp receipt_date = 6;
  // 供应商
  string vendor = 7;
  // 采购订单
  string purchase_order = 8;
  // 物料凭证
  string material_document = 9;
}

// 获取物料去向追溯请求
message TraceMaterialDestinationRequest {
  // 物料编号
  string material = 1;
  // 批次
  string batch = 2;
  // 工厂
  string plant = 3;
  // 存储地点
  string storage_location = 4;
  // 追溯深度
  int32 trace_depth = 5;
}

// 物料去向追溯响应
message MaterialDestinationTraceResponse {
  // 操作是否成功
  bool success = 1;
  // 去向追溯链
  repeated DestinationTraceEntry destination_chain = 2;
  // 消息列表
  repeated enterprise.common.ApiMessage messages = 3;
}

// 去向追溯条目
message DestinationTraceEntry {
  // 层级
  int32 level = 1;
  // 物料编号
  string material = 2;
  // 批次
  string batch = 3;
  // 数量
  string quantity = 4;
  // 单位
  string unit = 5;
  // 发货日期
  google.protobuf.Timestamp issue_date = 6;
  // 客户/接收方
  string recipient = 7;
  // 销售订单
  string sales_order = 8;
  // 物料凭证
  string material_document = 9;
  // 最终用途 (PRODUCTION/SALES/SCRAP/TRANSFER)
  string end_use = 10;
}

// --------------------------------------------------------------------------
// 库存预测消息 (Stock Forecasting Messages)
// --------------------------------------------------------------------------

// 预测库存需求请求
message ForecastStockRequirementRequest {
  // 物料编号
  string material = 1;
  // 工厂
  string plant = 2;
  // 预测期间 (月数)
  int32 forecast_months = 3;
  // 历史数据期间
  enterprise.common.DateRange historical_period = 4;
  // 预测方法 (MOVING_AVERAGE/EXPONENTIAL_SMOOTHING/LINEAR_REGRESSION)
  string forecast_method = 5;
}

// 库存预测响应
message StockForecastResponse {
  // 操作是否成功
  bool success = 1;
  // 预测结果列表
  repeated ForecastPeriodData forecast_data = 2;
  // 预测汇总
  ForecastSummary forecast_summary = 3;
  // 消息列表
  repeated enterprise.common.ApiMessage messages = 4;
}

// 预测期间数据
message ForecastPeriodData {
  // 期间 (年-月)
  string period = 1;
  // 预测需求量
  string forecasted_demand = 2;
  // 建议采购量
  string recommended_procurement = 3;
  // 预计期末库存
  string projected_ending_stock = 4;
  // 单位
  string unit = 5;
  // 置信区间下限
  string confidence_lower = 6;
  // 置信区间上限
  string confidence_upper = 7;
}

// 预测汇总
message ForecastSummary {
  // 预测方法
  string forecast_method = 1;
  // 预测准确度 (历史对比)
  string forecast_accuracy = 2;
  // 平均预测需求
  string average_forecasted_demand = 3;
  // 峰值需求
  string peak_demand = 4;
  // 低谷需求
  string trough_demand = 5;
  // 单位
  string unit = 6;
}

// 分析库存趋势请求
message AnalyzeStockTrendRequest {
  // 物料编号 (可选)
  string material = 1;
  // 工厂
  string plant = 2;
  // 存储地点 (可选)
  string storage_location = 3;
  // 分析期间
  enterprise.common.DateRange analysis_period = 4;
  // 趋势粒度 (DAILY/WEEKLY/MONTHLY)
  string trend_granularity = 5;
}

// 库存趋势分析响应
message StockTrendAnalysisResponse {
  // 操作是否成功
  bool success = 1;
  // 趋势数据列表
  repeated TrendDataPoint trend_data = 2;
  // 趋势分析结论
  TrendAnalysisConclusion conclusion = 3;
  // 消息列表
  repeated enterprise.common.ApiMessage messages = 4;
}

// 趋势数据点
message TrendDataPoint {
  // 时间点
  google.protobuf.Timestamp timestamp = 1;
  // 期间 (例如: 2024-01, Week 23)
  string period = 2;
  // 库存数量
  string stock_quantity = 3;
  // 库存价值
  string stock_value = 4;
  // 收货数量
  string receipt_quantity = 5;
  // 发货数量
  string issue_quantity = 6;
  // 单位
  string unit = 7;
  // 货币
  string currency = 8;
}

// 趋势分析结论
message TrendAnalysisConclusion {
  // 总体趋势 (INCREASING/DECREASING/STABLE/VOLATILE)
  string overall_trend = 1;
  // 趋势强度 (0-1)
  string trend_strength = 2;
  // 平均库存水平
  string average_stock_level = 3;
  // 库存波动率
  string volatility = 4;
  // 季节性因素 (是否存在)
  bool has_seasonality = 5;
  // 异常点数量
  int32 anomaly_count = 6;
}

// --------------------------------------------------------------------------
// 库存优化建议消息 (Stock Optimization Messages)
// --------------------------------------------------------------------------

// 获取库存优化建议请求
message GetStockOptimizationRequest {
  // 工厂
  string plant = 1;
  // 存储地点 (可选)
  string storage_location = 2;
  // 物料编号 (可选)
  string material = 3;
  // 优化目标 (MINIMIZE_COST/MAXIMIZE_SERVICE_LEVEL/BALANCE)
  string optimization_goal = 4;
  // 分析期间
  enterprise.common.DateRange analysis_period = 5;
}

// 库存优化响应
message StockOptimizationResponse {
  // 操作是否成功
  bool success = 1;
  // 优化建议列表
  repeated OptimizationRecommendation recommendations = 2;
  // 预期收益
  OptimizationBenefit expected_benefit = 3;
  // 消息列表
  repeated enterprise.common.ApiMessage messages = 4;
}

// 优化建议
message OptimizationRecommendation {
  // 建议ID
  string recommendation_id = 1;
  // 建议类型 (REDUCE_SAFETY_STOCK/INCREASE_ORDER_FREQUENCY/CONSOLIDATE_SUPPLIERS等)
  string recommendation_type = 2;
  // 物料编号
  string material = 3;
  // 物料描述
  string material_description = 4;
  // 工厂
  string plant = 5;
  // 当前值
  string current_value = 6;
  // 建议值
  string recommended_value = 7;
  // 建议原因
  string reason = 8;
  // 预期节省/改善
  string expected_improvement = 9;
  // 实施难度 (LOW/MEDIUM/HIGH)
  string implementation_difficulty = 10;
  // 优先级 (1-5)
  int32 priority = 11;
}

// 优化收益
message OptimizationBenefit {
  // 预期成本节省
  string expected_cost_savings = 1;
  // 货币
  string currency = 2;
  // 预期库存减少
  string expected_inventory_reduction = 3;
  // 服务水平改善
  string service_level_improvement = 4;
  // 投资回报周期 (月)
  int32 payback_period_months = 5;
}

// 分析超储库存请求
message AnalyzeOverstockRequest {
  // 工厂
  string plant = 1;
  // 存储地点 (可选)
  string storage_location = 2;
  // 物料编号 (可选)
  string material = 3;
  // 分析期间
  enterprise.common.DateRange analysis_period = 4;
  // 超储阈值 (库存/需求比，例如: 2.0表示库存是需求的2倍以上视为超储)
  string overstock_threshold = 5;
}

// 超储库存分析响应
message OverstockAnalysisResponse {
  // 操作是否成功
  bool success = 1;
  // 超储库存列表
  repeated OverstockItem overstock_items = 2;
  // 汇总信息
  OverstockSummary summary = 3;
  // 消息列表
  repeated enterprise.common.ApiMessage messages = 4;
}

// 超储库存项目
message OverstockItem {
  // 物料编号
  string material = 1;
  // 物料描述
  string material_description = 2;
  // 工厂
  string plant = 3;
  // 存储地点
  string storage_location = 4;
  // 当前库存
  string current_stock = 5;
  // 平均月需求
  string average_monthly_demand = 6;
  // 库存覆盖月数
  string months_of_coverage = 7;
  // 超储数量
  string overstock_quantity = 8;
  // 超储价值
  string overstock_value = 9;
  // 单位
  string unit = 10;
  // 货币
  string currency = 11;
  // 建议措施
  string recommended_action = 12;
}

// 超储库存汇总
message OverstockSummary {
  // 超储物料总数
  int32 total_overstock_items = 1;
  // 超储库存总价值
  string total_overstock_value = 2;
  // 货币
  string currency = 3;
  // 超储库存占总库存价值百分比
  string percentage_of_total_stock = 4;
  // 潜在成本节省
  string potential_cost_savings = 5;
}

// 分析缺货风险请求
message AnalyzeStockoutRiskRequest {
  // 工厂
  string plant = 1;
  // 存储地点 (可选)
  string storage_location = 2;
  // 物料编号 (可选)
  string material = 3;
  // 分析期间
  enterprise.common.DateRange analysis_period = 4;
  // 风险阈值 (库存覆盖天数，例如: 7表示库存少于7天视为有风险)
  int32 risk_threshold_days = 5;
}

// 缺货风险分析响应
message StockoutRiskAnalysisResponse {
  // 操作是否成功
  bool success = 1;
  // 风险物料列表
  repeated StockoutRiskItem risk_items = 2;
  // 汇总信息
  StockoutRiskSummary summary = 3;
  // 消息列表
  repeated enterprise.common.ApiMessage messages = 4;
}

// 缺货风险项目
message StockoutRiskItem {
  // 物料编号
  string material = 1;
  // 物料描述
  string material_description = 2;
  // 工厂
  string plant = 3;
  // 存储地点
  string storage_location = 4;
  // 当前库存
  string current_stock = 5;
  // 安全库存
  string safety_stock = 6;
  // 日均需求
  string average_daily_demand = 7;
  // 库存覆盖天数
  int32 days_of_coverage = 8;
  // 风险等级 (LOW/MEDIUM/HIGH/CRITICAL)
  string risk_level = 9;
  // 预计缺货日期
  google.protobuf.Timestamp estimated_stockout_date = 10;
  // 在途订单数量
  string on_order_quantity = 11;
  // 建议措施
  string recommended_action = 12;
  // 单位
  string unit = 13;
}

// 缺货风险汇总
message StockoutRiskSummary {
  // 高风险物料数
  int32 high_risk_count = 1;
  // 中风险物料数
  int32 medium_risk_count = 2;
  // 低风险物料数
  int32 low_risk_count = 3;
  // 关键物料缺货风险数
  int32 critical_material_at_risk = 4;
  // 潜在收入损失
  string potential_revenue_loss = 5;
  // 货币
  string currency = 6;
}
